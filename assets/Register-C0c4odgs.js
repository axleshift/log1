import{i as L,k as q,r,j as e,C as A}from"./index-B_xgiZND.js";import{C as B,a as u}from"./index.esm-CSCu4-FO.js";import{C as G,a as D}from"./CRow-7s3L4eiP.js";import{C as z,a as O}from"./CCardBody-CJNqt8f3.js";import{C as _}from"./CForm-Q4NE6lr7.js";import{C as R}from"./CAlert-D7AY2vid.js";import{C as o,a as l}from"./CInputGroupText-MCOOFdiC.js";import{c as J}from"./cil-user-Ddrdy7PS.js";import{C as n}from"./CFormInput-CxEswD9g.js";import{c as E}from"./cil-lock-locked-DmxpJbVL.js";import{C as M}from"./CFormSelect-DB8WT_qC.js";import{a as N}from"./CButton-Dmu7yp3G.js";import"./CCloseButton-Cv6f_OZH.js";const te=()=>{const I=L(),p=q(),[h,x]=r.useState(""),[j,C]=r.useState(""),[i,f]=r.useState(""),[g,S]=r.useState(""),[y,b]=r.useState("user"),[v,c]=r.useState(null),[w,d]=r.useState(null),[a,m]=r.useState(!1),U=()=>{x(""),C(""),f(""),S(""),b("user")},k=async s=>{if(s.preventDefault(),c(null),d(null),m(!0),i!==g){c("Passwords don't match"),m(!1);return}try{const t=await fetch("/api/v1/user/register",{method:"POST",headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("accessToken")},body:JSON.stringify({username:h,email:j,password:i,role:y})});if(!t.ok){const F=await t.json();throw new Error(F.message||"Registration failed")}const T=await t.json();p({type:"REGISTER_SUCCESS",payload:T}),U(),d("User registered successfully!"),setTimeout(()=>{d(null)},3e3)}catch(t){c(t.message),p({type:"REGISTER_FAILURE",payload:t.message})}finally{m(!1)}},P=()=>{I("/dashboard")};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(B,{children:e.jsx(G,{className:"justify-content-center",children:e.jsx(D,{md:9,lg:7,xl:6,children:e.jsx(z,{className:"mx-4",children:e.jsx(O,{className:"p-4",children:e.jsxs(_,{onSubmit:k,children:[e.jsx("h1",{children:"Register New User"}),v&&e.jsx(R,{color:"danger",children:v}),w&&e.jsx(R,{color:"success",children:w}),e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{children:e.jsx(u,{icon:J})}),e.jsx(n,{placeholder:"Username",autoComplete:"off",id:"Username",value:h,onChange:s=>x(s.target.value),required:!0,disabled:a})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{children:"@"}),e.jsx(n,{placeholder:"Email",autoComplete:"off",id:"Email",value:j,onChange:s=>C(s.target.value),required:!0,type:"email",disabled:a})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{children:e.jsx(u,{icon:E})}),e.jsx(n,{type:"password",placeholder:"Password",autoComplete:"off",id:"Password",value:i,onChange:s=>f(s.target.value),required:!0,disabled:a})]}),e.jsxs(o,{className:"mb-4",children:[e.jsx(l,{children:e.jsx(u,{icon:E})}),e.jsx(n,{type:"password",placeholder:"Repeat password",autoComplete:"off",id:"RepeatPassword",value:g,onChange:s=>S(s.target.value),required:!0,disabled:a})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{children:"Role"}),e.jsxs(M,{id:"Role",value:y,onChange:s=>b(s.target.value),disabled:a,children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"})]})]}),e.jsx(N,{color:"success",type:"submit",disabled:a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(A,{size:"sm"})," Loading..."]}):"Create"}),e.jsx(N,{color:"secondary",className:"ms-2",onClick:P,disabled:a,children:"Back"})]})})})})})})})};export{te as default};
