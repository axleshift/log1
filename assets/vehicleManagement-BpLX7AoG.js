import{r as s,j as e,C as v}from"./index-ROFYVZSB.js";import{a as k}from"./index-DW_MHI2K.js";import{F as V,f as E,a as z,b as G,c as $,d as H,C as d}from"./DefaultLayout-CSaaRxM-.js";import{a as C}from"./CButton-B6XfsDmw.js";import{C as R,a as A,b as q,c as P,d as B}from"./CModalTitle-RcsBXXdb.js";import{C as D}from"./CAlert-K7kYRrvA.js";import{C as Y}from"./CForm-DG9jDYNX.js";import{C as o}from"./CFormInput-GqhhVFAX.js";import{C as M}from"./CFormSelect-DD8o0WcZ.js";import{C as I}from"./index.esm-BM_BWR5J.js";import{C as Q,a as J}from"./CInputGroupText-MlH_-xN7.js";import{C as O,a as K,b as W,c as X}from"./CAccordionHeader-C2MQPAho.js";import{C as Z}from"./CCard-CY27pPNB.js";import{C as ee}from"./CCardBody-D_8Vsxmt.js";import"./CCloseButton-DZNfoUeS.js";import"./cil-user-Ddrdy7PS.js";const ae=()=>{const L=k.create({baseURL:"http://localhost:5057",withCredentials:!0}),[j,h]=s.useState(!1),[m,p]=s.useState(!1),[g,u]=s.useState(null),[b,x]=s.useState(!1),i={idNum:Math.floor(Math.random()*1e6).toString(),brand:"",model:"",year:"",regisNumber:"",type:"",capacity:"",fuelType:"",currentMileage:"",status:"available"},[l,t]=s.useState(i),N=[{label:"Van",value:"van"},{label:"Pickup Truck",value:"pickup"},{label:"Box Truck",value:"box"},{label:"Straight Truck",value:"straight"},{label:"Semi-Trailer Trucks",value:"semi"},{label:"Refrigerated Trucks",value:"refrigerated"},{label:"Tanker Trucks",value:"tanker"},{label:"Flatbed Trucks",value:"flatbed"}],w=[{label:"Diesel",value:"diesel"},{label:"Gasoline",value:"gasoline"}],S=async a=>{a.currentTarget.checkValidity()===!1&&(a.preDefault(),a.stopPropagation()),h(!0);try{const f=await L.post("/api/v1/vehicle",l);f.data.success?(alert("Vehicle added successfully"),t(i),x(!1),h(!1)):(u(f.data.message),x(!1))}catch(f){u(f.response.data.message),x(!1)}};return e.jsx(e.Fragment,{children:b?e.jsx(v,{color:"primary",size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(C,{color:"primary",variant:"outline",onClick:()=>p(!0),children:[e.jsx(V,{icon:E})," Add Vehicle"]}),e.jsxs(R,{visible:m,onClose:()=>p(!1),children:[e.jsx(A,{children:e.jsx(q,{children:"Add Vehicle"})}),g&&e.jsx(D,{color:"danger",className:"m-3",children:g}),e.jsx(P,{children:e.jsxs(Y,{noValidate:!0,validated:j,children:[e.jsx(o,{className:"mb-3",floatingLabel:"ID Number",placeholder:"ID Number",type:"text",id:"idNum",label:"ID Number",value:l.idNum,disabled:!0}),e.jsx(o,{className:"mb-3",floatingLabel:"Brand",placeholder:"Brand",type:"text",id:"brand",label:"Brand",autoComplete:"off",required:!0,value:l.brand,onChange:a=>t({...l,brand:a.target.value})}),e.jsx(o,{className:"mb-3",floatingLabel:"Model",placeholder:"Model",type:"text",id:"model",label:"Model",autoComplete:"off",required:!0,value:l.model,onChange:a=>t({...l,model:a.target.value})}),e.jsx(o,{type:"number",className:"mb-3",floatingLabel:"Year",placeholder:"Year",id:"year",autoComplete:"off",value:l.year,required:!0,min:"1990",max:new Date().getFullYear(),onChange:a=>{const c=a.target.value;t({...l,year:c})},onBlur:a=>{const c=parseInt(a.target.value);(c<1990||c>new Date().getFullYear()||isNaN(c))&&(alert("Please enter a year between 1990 and "+new Date().getFullYear()),t({...l,year:1990}))}}),e.jsx(o,{className:"mb-3",floatingLabel:"Registration Number",placeholder:"Registration Number",type:"text",id:"regisNumber",label:"Registration Number",autoComplete:"off",required:!0,value:l.regisNumber,onChange:a=>t({...l,regisNumber:a.target.value})}),e.jsx(M,{className:"mb-3",floatingLabel:"Vehicle Type",placeholder:"Vehicle Type",id:"type",value:l.type,required:!0,onChange:a=>t({...l,type:a.target.value}),options:[{label:"Select Vehicle Type",value:""},...N]}),e.jsx(o,{className:"mb-2",type:"number",floatingLabel:"Capacity",placeholder:"Capacity",id:"capacity",label:"Capacity",autoComplete:"off",required:!0,min:"0",value:l.capacity,onChange:a=>t({...l,capacity:a.target.value})}),e.jsx(M,{className:"mb-3",floatingLabel:"Fuel Type",placeholder:"Fuel Type",id:"fuelType",value:l.fuelType,required:!0,onChange:a=>t({...l,fuelType:a.target.value}),options:[{label:"Select Fuel Type",value:""},...w]}),e.jsx(o,{className:"mb-3",floatingLabel:"Current Mileage",placeholder:"Current Mileage",type:"number",id:"mileage",label:"Current Mileage",autoComplete:"off",required:!0,value:l.currentMileage,min:"0",onChange:a=>t({...l,currentMileage:a.target.value})})]})}),e.jsxs(B,{children:[e.jsx(C,{color:"secondary",variant:"outline",disabled:b,onClick:()=>{p(!1),t(i),h(!1),u(null)},children:b?e.jsx(v,{color:"secondary",size:"sm"}):"Cancel"}),e.jsx(C,{color:"primary",variant:"outline",disabled:b,onClick:S,children:b?e.jsx(v,{color:"primary",size:"sm"}):"Save"})]})]})]})})},le=n=>{const j=k.create({baseURL:"http://localhost:5057"}),[h,m]=s.useState(!1),p=async()=>{m(!0),(await j.delete(`/api/v1/vehicle/${n.vehicle._id}`)).status===200&&(alert("Vehicle deleted successfully"),m(!1))};return e.jsx(e.Fragment,{children:e.jsx(C,{color:"danger",disabled:h,onClick:p,children:h?e.jsx(v,{size:"sm"}):e.jsx(V,{icon:z})})})},re=n=>{const j=k.create({baseURL:"http://localhost:5057",withCredentials:!0}),[h,m]=s.useState(!1),[p,g]=s.useState(null),[u,b]=s.useState(!1),[x,i]=s.useState(!1),[l,t]=s.useState({idNum:n.vehicle.idNum,brand:n.vehicle.brand,model:n.vehicle.model,year:n.vehicle.year,regisNumber:n.vehicle.regisNumber,type:n.vehicle.type,capacity:n.vehicle.capacity,fuelType:n.vehicle.fuelType,currentMileage:n.vehicle.currentMileage}),N=[{label:"Van",value:"van"},{label:"Pickup Truck",value:"pickup"},{label:"Box Truck",value:"box"},{label:"Straight Truck",value:"straight"},{label:"Semi-Trailer Trucks",value:"semi"},{label:"Refrigerated Trucks",value:"refrigerated"},{label:"Tanker Trucks",value:"tanker"},{label:"Flatbed Trucks",value:"flatbed"}],w=[{label:"Diesel",value:"diesel"},{label:"Gasoline",value:"gasoline"}],S=async a=>{b(!0),a.currentTarget.checkValidity()===!1&&a.stopPropagation(),i(!0);try{const f=await j.put(`/api/v1/vehicle/${n.vehicle._id}`,l);m(!1),i(!1)}catch(f){console.error("Error updating driver:",f),g(f.response.data.message)}finally{b(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(C,{color:"primary",variant:"outline",disabled:u,onClick:()=>m(!0),className:"me-2",children:u?e.jsx(v,{size:"sm"}):e.jsx(V,{icon:G})}),e.jsxs(R,{visible:h,onClose:()=>m(!1),children:[e.jsx(A,{children:e.jsx(q,{children:"Add Vehicle"})}),p&&e.jsx(D,{color:"danger",className:"m-3",children:p}),e.jsx(P,{children:e.jsxs(Y,{noValidate:!0,validated:x,children:[e.jsx(o,{className:"mb-3",floatingLabel:"ID Number",placeholder:"ID Number",type:"text",id:"idNum",label:"ID Number",value:l.idNum,disabled:!0}),e.jsx(o,{className:"mb-3",floatingLabel:"Brand",placeholder:"Brand",type:"text",id:"brand",label:"Brand",required:!0,value:l.brand,onChange:a=>t({...l,brand:a.target.value})}),e.jsx(o,{className:"mb-3",floatingLabel:"Model",placeholder:"Model",type:"text",id:"model",label:"Model",required:!0,value:l.model,onChange:a=>t({...l,model:a.target.value})}),e.jsx(o,{type:"number",className:"mb-3",floatingLabel:"Year",placeholder:"Year",id:"year",value:l.year,required:!0,min:"1990",max:new Date().getFullYear(),onChange:a=>{const c=a.target.value;t({...l,year:c})},onBlur:a=>{const c=parseInt(a.target.value);(c<1990||c>new Date().getFullYear()||isNaN(c))&&(alert("Please enter a year between 1990 and "+new Date().getFullYear()),t({...l,year:1990}))}}),e.jsx(o,{className:"mb-3",floatingLabel:"Registration Number",placeholder:"Registration Number",type:"text",id:"regisNumber",label:"Registration Number",required:!0,value:l.regisNumber,onChange:a=>t({...l,regisNumber:a.target.value})}),e.jsx(M,{className:"mb-3",floatingLabel:"Vehicle Type",placeholder:"Vehicle Type",id:"type",value:l.type,required:!0,onChange:a=>t({...l,type:a.target.value}),options:[{label:"Select Vehicle Type",value:""},...N]}),e.jsx(o,{className:"mb-2",type:"number",floatingLabel:"Capacity",placeholder:"Capacity",id:"capacity",label:"Capacity",required:!0,min:"0",value:l.capacity,onChange:a=>t({...l,capacity:a.target.value})}),e.jsx(M,{className:"mb-3",floatingLabel:"Fuel Type",placeholder:"Fuel Type",id:"fuelType",label:"Fuel Type",value:l.fuelType,required:!0,onChange:a=>t({...l,fuelType:a.target.value}),options:[{label:"Select Fuel Type",value:""},...w]}),e.jsx(o,{className:"mb-3",floatingLabel:"Current Mileage",placeholder:"Current Mileage",type:"number",id:"mileage",label:"Current Mileage",required:!0,min:"0",value:l.currentMileage,onChange:a=>t({...l,currentMileage:a.target.value})})]})}),e.jsxs(B,{children:[e.jsx(C,{color:"secondary",variant:"outline",disabled:u,onClick:()=>{m(!1),g(null),t(n.vehicle),i(!1)},children:u?e.jsx(v,{size:"sm",color:"secondary"}):"Cancel"}),e.jsx(C,{color:"success",variant:"outline",disabled:u,onClick:S,children:u?e.jsx(v,{size:"sm",color:"success"}):"Save Changes"})]})]})]})},te=()=>{const[n,L]=s.useState([]),[j,h]=s.useState({}),[m,p]=s.useState(!0),[g,u]=s.useState([]),b=JSON.parse(sessionStorage.getItem("user")),x=["manager","admin"],[i,l]=s.useState(""),[t,N]=s.useState(null),S=k.create({baseURL:"http://localhost:5057",withCredentials:!0}),a=async()=>{const r=await S.get("/api/v1/vehicle");r.status===200&&(L(r.data.data),p(!1))},[c,f]=s.useState(!0),[se,ie]=s.useState(null);s.useEffect(()=>{(()=>{if(i==="")u(n);else{const T=n.filter(y=>y.idNum.toString().includes(i)||y.brand.toLowerCase().includes(i.toLowerCase())||y.model.toLowerCase().includes(i.toLowerCase())||y.year.toString().includes(i)||y.type.toLowerCase().includes(i.toLowerCase())||y.regisNumber.toLowerCase().includes(i.toLowerCase())||y.capacity.toString().includes(i)||F.find(_=>_.value===y.status).label.toLowerCase().includes(i.toLowerCase()));u(T),T.length===0?N("No vehicles found"):N()}})(),a()},[i,n]);const U=r=>{switch(r){case"available":return"green";case"in_use":return"red";case"maintenance":return"orange";case"inspection":return"yellow";default:return"black"}},F=[{value:"available",label:"Available"},{value:"in_use",label:"In Use"},{value:"maintenance",label:"Maintenance"},{value:"inactive",label:"Inactive"},{value:"inspection",label:"Inspection"}];return e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"mt-3",children:e.jsxs(Q,{className:"w-50 mb-3",children:[e.jsx(o,{type:"text",placeholder:"Search vehicles",id:"search",value:i,onChange:r=>l(r.target.value),className:"w-50 me-2 "}),e.jsx(J,{children:e.jsx(V,{icon:$})})]})}),g.length>0?e.jsx(O,{className:"m-2",children:g.map(r=>e.jsxs(K,{children:[e.jsx(W,{children:e.jsxs("p",{className:"w-100 m-1 ",children:["Registration Number:",e.jsx("strong",{className:"ms-2",children:r.regisNumber}),e.jsx(V,{icon:H,color:U(r.status),className:"m-2 float-end"}),e.jsx("small",{className:"m-2 float-end",children:F.find(T=>T.value===r.status).label})]})}),e.jsxs(X,{children:[e.jsxs(d,{children:["ID: ",r.idNum]}),e.jsxs(d,{children:["Brand: ",r.brand]}),e.jsxs(d,{children:["Model: ",r.model]}),e.jsxs(d,{children:["Year: ",r.year]}),e.jsxs(d,{children:["Type: ",r.type]}),e.jsxs(d,{children:["Capacity: ",r.capacity]}),e.jsxs(d,{children:["Status: ",F.find(T=>T.value===r.status).label]}),e.jsxs(d,{children:["Driver:"," ",r.assignedDriver?`${r.assignedDriver.driverName} - ${r.assignedDriver.licenseNumber}`:"Not assigned"]}),e.jsxs(d,{children:["Fuel Type: ",r.fuelType]}),e.jsxs(d,{children:["Current Mileage: ",r.currentMileage]}),e.jsxs(I,{className:"d-flex justify-content-end mt-3",children:[e.jsx(re,{vehicle:r}),x.includes(b.data.user.role)&&e.jsx(le,{vehicle:r})]})]})]},r._id))}):e.jsx(d,{className:"justify-content-center",children:"0 results found"}),t&&e.jsx(D,{color:"danger",className:"text-center justify-content-center",children:t})]})},Ne=()=>e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"text-center",children:"Vehicle Management"}),e.jsx(I,{className:"m-3",children:e.jsx(ae,{})}),e.jsxs(Z,{children:[e.jsx(d,{children:"Vehicle List"}),e.jsx(ee,{className:"md-3",children:e.jsx(te,{})})]})]});export{Ne as default};
