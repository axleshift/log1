import{r as a,_ as q,R as y,a as b,c as G,P as l,e as ue,w as me,j as e,C as Q}from"./index-B_xgiZND.js";import{a as $}from"./index-DW_MHI2K.js";import{u as he,e as fe,F as z,f as pe,a as xe,h as ge,i as je,C as Ce}from"./DefaultLayout-DJqhCF6w.js";import{C as ye,a as S}from"./CButton-Dmu7yp3G.js";import{C as se,a as ae,b as te,c as ne,d as re}from"./CModalTitle-DLCZrMTR.js";import{C as L}from"./CAlert-D7AY2vid.js";import{C as oe}from"./CForm-Q4NE6lr7.js";import{C as F}from"./CFormInput-CxEswD9g.js";import{C as Ne}from"./index.esm-CSCu4-FO.js";import{C as ve,a as be}from"./CInputGroupText-MCOOFdiC.js";import{C as we,a as Se}from"./CCardBody-CJNqt8f3.js";import{C as Le,a as Pe,b as ee,c as U,d as We,e as O}from"./CTable-CwqUD7dP.js";import{u as Ee}from"./CCloseButton-Cv6f_OZH.js";import{g as Te,e as ke}from"./getRTLPlacement-B5NYn3wd.js";import"./cil-user-Ddrdy7PS.js";var J=a.forwardRef(function(s,m){var i,r=s.children,h=s.align,n=s.className,d=s.size,u=q(s,["children","align","className","size"]);return y.createElement("nav",b({ref:m},u),y.createElement("ul",{className:G("pagination",(i={},i["justify-content-".concat(h)]=h,i["pagination-".concat(d)]=d,i),n)},r))});J.propTypes={align:l.oneOf(["start","center","end"]),children:l.node,className:l.string,size:l.oneOf(["sm","lg"])};J.displayName="CPagination";var R=a.forwardRef(function(s,m){var i=s.children,r=s.as,h=s.className,n=q(s,["children","as","className"]),d=r??(n.active?"span":"a");return y.createElement("li",b({className:G("page-item",{active:n.active,disabled:n.disabled},h)},n.active&&{"aria-current":"page"}),d==="a"?y.createElement(ye,b({className:"page-link",as:d},n,{ref:m}),i):y.createElement(d,{className:"page-link",ref:m},i))});R.propTypes={as:l.elementType,children:l.node,className:l.string};R.displayName="CPaginationItem";var A=a.forwardRef(function(s,m){var i=s.children,r=s.animation,h=r===void 0?!0:r,n=s.className,d=s.container,u=s.content,j=s.delay,f=j===void 0?0:j,o=s.fallbackPlacements,p=o===void 0?["top","right","bottom","left"]:o,c=s.offset,N=c===void 0?[0,6]:c,g=s.onHide,x=s.onShow,C=s.placement,P=C===void 0?"top":C,W=s.trigger,w=W===void 0?["hover","focus"]:W,E=s.visible,T=q(s,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","trigger","visible"]),t=a.useRef(null),v=a.useRef(null),_=Ee(m,t),I="tooltip".concat(a.useId()),B=a.useState(!1),M=B[0],K=B[1],X=a.useState(E),k=X[0],Y=X[1],V=he(),le=V.initPopper,ce=V.destroyPopper,ie=V.updatePopper,Z=typeof f=="number"?{show:f,hide:f}:f,de={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:p}},{name:"offset",options:{offset:N}}],placement:Te(P,v.current)};a.useEffect(function(){if(E){D();return}H()},[E]),a.useEffect(function(){if(M&&v.current&&t.current){le(v.current,t.current,de),setTimeout(function(){Y(!0)},Z.show);return}!M&&v.current&&t.current&&ce()},[M]),a.useEffect(function(){!k&&v.current&&t.current&&ke(function(){K(!1)},t.current)},[k]);var D=function(){K(!0),x&&x()},H=function(){setTimeout(function(){Y(!1),g&&g()},Z.hide)};return a.useEffect(function(){ie()},[u]),y.createElement(y.Fragment,null,y.cloneElement(i,b(b(b(b(b({},k&&{"aria-describedby":I}),{ref:v}),(w==="click"||w.includes("click"))&&{onClick:function(){return k?H():D()}}),(w==="focus"||w.includes("focus"))&&{onFocus:function(){return D()},onBlur:function(){return H()}}),(w==="hover"||w.includes("hover"))&&{onMouseEnter:function(){return D()},onMouseLeave:function(){return H()}})),y.createElement(fe,{container:d,portal:!0},M&&y.createElement("div",b({className:G("tooltip","bs-tooltip-auto",{fade:h,show:k},n),id:I,ref:_,role:"tooltip"},T),y.createElement("div",{className:"tooltip-arrow"}),y.createElement("div",{className:"tooltip-inner"},u))))});A.propTypes={animation:l.bool,children:l.node,container:l.any,content:l.oneOfType([l.string,l.node]),delay:l.oneOfType([l.number,l.shape({show:l.number.isRequired,hide:l.number.isRequired})]),fallbackPlacements:me,offset:l.any,onHide:l.func,onShow:l.func,placement:l.oneOf(["auto","top","right","bottom","left"]),trigger:ue,visible:l.bool};A.displayName="CTooltip";const Re="http://localhost:5057",Ae=$.create({baseURL:Re}),Fe=({onAddWarehouseLoc:s})=>{const[m,i]=a.useState(!1),[r,h]=a.useState(!1),[n,d]=a.useState(null),[u,j]=a.useState(null),[f,o]=a.useState({warehouseName:"",address:""}),p=N=>{const{id:g,value:x}=N.target;o(C=>({...C,[g]:x}))},c=async N=>{N.preventDefault();const g=sessionStorage.getItem("email");if(!g){d("User email not found. Please log in again.");return}h(!0);try{const x=await Ae.post("/api/v1/warehouseLoc/add",{...f,createdBy:g});x.status===201&&(j(x.data.message),s(x.data.data),setTimeout(()=>{j(null),i(!1)},2e3),o({warehouseName:"",address:""}))}catch(x){d(x.response.data.message),setTimeout(()=>{d(null)},2e3)}h(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(S,{color:"primary",variant:"outline",onClick:()=>i(!0),children:[r?e.jsx(Q,{color:"secondary",size:"sm"}):e.jsx(z,{icon:pe})," Add Warehouse Location"]}),e.jsxs(se,{visible:m,onClose:()=>i(!1),children:[e.jsx(ae,{closeButton:!0,children:e.jsx(te,{children:"Add Warehouse Location"})}),n&&e.jsx(L,{color:"danger",children:n}),u&&e.jsx(L,{color:"success",children:u}),e.jsx(ne,{children:e.jsxs(oe,{children:[e.jsx(F,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:p,value:f.warehouseName}),e.jsx(F,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:p,value:f.address})]})}),e.jsxs(re,{children:[e.jsx(S,{color:"secondary",variant:"outline",onClick:()=>i(!m),children:"Cancel"}),e.jsx(S,{color:"primary",variant:"outline",onClick:c,children:"Save"})]})]})]})},Ie="http://localhost:5057",Be=$.create({baseURL:Ie}),Me=({warehouseLoc:s,onDeleteWarehouseLoc:m})=>{const[i,r]=a.useState(!1),[h,n]=a.useState(null),d=async()=>{r(!0);try{const u=await Be.delete(`/api/v1/warehouseLoc/delete/${s._id}`);console.log(u.data),u.status===200&&(alert("Warehouse Location deleted successfully"),m(s._id),r(!1),n(null))}catch(u){n(u)}finally{r(!1)}};return h?e.jsxs(L,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",h.message]}):e.jsx(e.Fragment,{children:e.jsx(S,{color:"danger",variant:"outline",onClick:d,className:"me-2",children:i?e.jsx(Q,{size:"sm"}):e.jsx(z,{icon:xe})})})},De="http://localhost:5057",He=$.create({baseURL:De}),Ue=({warehouseLoc:s,onUpdateWarehouseLoc:m})=>{const[i,r]=a.useState(!1),[h,n]=a.useState(!1),[d,u]=a.useState(null),[j,f]=a.useState(null),[o,p]=a.useState({warehouseName:s.warehouseName,address:s.address}),c=g=>{const{id:x,value:C}=g.target;p(P=>({...P,[x]:C}))},N=async g=>{g.preventDefault();const x=sessionStorage.getItem("email");if(!x){u("User email not found. Please log in again.");return}n(!0);try{const C=await He.put(`/api/v1/warehouseLoc/update/${s._id}`,{...o,createdBy:x});C.status===200&&(f("Warehouse Location updated successfully"),m(C.data.data),setTimeout(()=>{f(null),r(!1)},2e3))}catch(C){u(C.response.data.message),setTimeout(()=>{u(null)},2e3)}n(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(S,{color:"primary",variant:"outline",onClick:()=>r(!0),className:"me-2",children:h?e.jsx(Q,{size:"sm"}):e.jsx(z,{icon:ge})}),e.jsxs(se,{visible:i,onClose:()=>r(!1),children:[e.jsx(ae,{closeButton:!0,children:e.jsx(te,{children:"Update Warehouse Location"})}),d&&e.jsx(L,{color:"danger",children:d}),j&&e.jsx(L,{color:"success",children:j}),e.jsx(ne,{children:e.jsxs(oe,{children:[e.jsx(F,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:c,value:o.warehouseName}),e.jsx(F,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:c,value:o.address})]})}),e.jsxs(re,{children:[e.jsx(S,{color:"secondary",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(S,{color:"primary",variant:"outline",onClick:N,children:"Save"})]})]})]})},Oe=({warehouseLoc:s,loading:m,error:i,onDeleteWarehouseLoc:r,onUpdateWarehouseLoc:h})=>{const[n,d]=a.useState(""),[u,j]=a.useState([]),[f,o]=a.useState(1),[p,c]=a.useState(null),N=10,g=JSON.parse(sessionStorage.getItem("user")),x=["manager","admin"],C="admin";if(a.useEffect(()=>{j(s)},[s]),a.useEffect(()=>{if(n==="")j(s);else{const t=s.filter(v=>{const _=v.warehouseName.toLowerCase().includes(n.toLowerCase()),I=v.address.toLowerCase().includes(n.toLowerCase()),B=x.includes(g.data.user.role)&&v.createdBy.toLowerCase().includes(n.toLowerCase());return _||I||B});j(t),o(1),t.length===0?c("No results found"):c(null)}},[n,s]),s.length===0)return e.jsx(L,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:"No Warehouse Location Found"});const P=t=>{d(t.target.value)},W=f*N,w=W-N,E=u.slice(w,W),T=Math.ceil(u.length/N);return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"m-3",children:e.jsxs(ve,{className:"w-50 mb-3",children:[e.jsx(F,{type:"text",id:"search",value:n,onChange:P,placeholder:"Search Warehouse Location..."}),e.jsx(be,{children:e.jsx(z,{icon:je})})]})}),e.jsxs(we,{children:[e.jsx(Ce,{children:"Warehouse Location List"}),e.jsxs(Se,{className:"md-3",children:[e.jsxs(Le,{bordered:!0,hover:!0,responsive:!0,className:"mx-auto ",children:[e.jsx(Pe,{className:"text-center  ",children:e.jsxs(ee,{children:[e.jsx(U,{className:"fixed-width bg-secondary",children:"Warehouse Name"}),e.jsx(U,{className:"fixed-width bg-secondary",children:"Address"}),C.includes(g.data.user.role)&&e.jsx(U,{className:"fixed-width bg-secondary",children:"Created By"}),e.jsx(U,{className:"fixed-width bg-secondary",children:"Actions"})]})}),e.jsx(We,{className:"text-center",children:E.map(t=>e.jsxs(ee,{children:[e.jsx(O,{className:"fixed-width",children:e.jsx(A,{content:t.warehouseName,children:e.jsx("span",{children:t.warehouseName})})}),e.jsx(O,{className:"fixed-width",children:e.jsx(A,{content:t.address,children:e.jsx("span",{children:t.address})})}),C.includes(g.data.user.role)&&e.jsx(O,{className:"fixed-width",color:"danger",children:e.jsx(A,{content:t.createdBy,children:e.jsx("span",{children:t.createdBy})})}),e.jsxs(O,{className:"fixed-width",children:[e.jsx(Ue,{warehouseLoc:t,onUpdateWarehouseLoc:h}),x.includes(g.data.user.role)&&e.jsx(Me,{warehouseLoc:t,onDeleteWarehouseLoc:r})]})]},t._id))})]}),p&&e.jsx(L,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:p}),e.jsxs(J,{align:"center",children:[e.jsx(R,{disabled:f===1,onClick:()=>o(t=>Math.max(t-1,1)),children:"Previous"}),[...Array(T).keys()].map(t=>e.jsx(R,{active:t+1===f,onClick:()=>o(t+1),children:t+1},t+1)),e.jsx(R,{disabled:f===T,onClick:()=>o(t=>Math.min(t+1,T)),children:"Next"})]})]})]})]})},$e="http://localhost:5057",ze=$.create({baseURL:$e}),rs=()=>{const[s,m]=a.useState([]),[i,r]=a.useState(!1),[h,n]=a.useState(null),d=async()=>{var o,p;r(!0);try{const c=await ze.get("/api/v1/warehouseLoc/locations");c.status===200?m(c.data.data):n(c.data.message)}catch(c){n(((p=(o=c.response)==null?void 0:o.data)==null?void 0:p.message)||c.message)}finally{r(!1)}};a.useEffect(()=>{d()},[]);const u=o=>{m(p=>[...p,o])},j=o=>{m(p=>p.filter(c=>c._id!==o))},f=o=>{m(p=>p.map(c=>c._id===o._id?o:c))};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Warehouse location"}),e.jsx(Fe,{onAddWarehouseLoc:u}),e.jsx(Oe,{warehouseLoc:s,loading:i,error:h,onDeleteWarehouseLoc:j,onUpdateWarehouseLoc:f})]})};export{rs as default};
