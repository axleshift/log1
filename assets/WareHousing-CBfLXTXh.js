import{A as Z,r as n,j as e,k as Y,m as $,B as ye,D as he}from"./index-BeKiQw6a.js";import{F as X,q as Ce,g as Se,e as oe,n as De,a as me}from"./index-DIG6Rwhb.js";import{C as F}from"./CAlert-C5w5tliL.js";import{a as V}from"./CButton-CzNR3q56.js";import{C as je,a as fe,b as ge,c as pe,d as ve}from"./CModalTitle-OJLBEPAs.js";import{C as Ne}from"./CForm-CCHDwsFR.js";import{C as we}from"./CFormSelect-DqlEUSnt.js";import{C as B}from"./CContainer-CyloyU6_.js";import{C as J}from"./CInputGroup-DmB5kmto.js";import{C as _}from"./CFormInput-ODb4_IM0.js";import{C as ce}from"./CInputGroupText-DWTRPT8x.js";import{C as Ie,a as Le,b as Pe,c as Ae}from"./CAccordionHeader-EpKe7whb.js";import{C as ee,a as se,b as z,c as S,d as re,e as D}from"./CTable-CUOd11qw.js";import{C as ie,a as H}from"./CPaginationItem-CxndWfYN.js";import{C as Ee}from"./CFormTextarea-DwjvXPiP.js";import{C as ne,a as Re}from"./DefaultLayout-JoM_S2aV.js";import{C as We,a as ke,b as ae,c as te}from"./CTabList-CxN-OE8e.js";import{C as xe}from"./CCard-CewVpMeC.js";import"./index.esm-zXrjU7C-.js";import"./1-0EBiHhkJ.js";import"./cil-user-Ddrdy7PS.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const qe=({warehousing:j,onDeleteItem:o})=>{const{showError:W,showSuccess:m}=Z(),[w,u]=n.useState(null),[I,L]=n.useState(!1),b=async()=>{L(!0);const g=await $.delete(`/api/v1/warehouse/delete/${j._id}`);g.data.success?(m(g.data.message),o(j._id),L(!1)):(L(!1),u(g.data.message),W(g.data.message))};return w?e.jsxs(F,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",w.message]}):e.jsx(e.Fragment,{children:e.jsx(V,{color:"danger",variant:"outline",onClick:b,className:"me-2",children:I?e.jsx(Y,{size:"sm"}):e.jsx(X,{icon:Ce})})})},Te=({warehousing:j,onUpdateItem:o})=>{const{showSuccess:W,showErrors:m}=Z(),[w,u]=n.useState(null),[I,L]=n.useState(!1),[b,g]=n.useState(null),[A,x]=n.useState(!1),[E,k]=n.useState([]),[h,t]=n.useState({warehouse:j.warehouse||"",warehouseLocDetails:{warehouseName:j.warehouseName||"",address:j.address||""},byReceived:""});n.useEffect(()=>{(async()=>{try{const r=await $.get("/api/v1/warehouseLoc/locations");k(r.data.data)}catch(r){u(r.response.data.message),m(r.response.data.message)}})()},[]);const p=y=>{const r=y.target.value,f=E.find(s=>s._id===r);t(s=>({...s,warehouse:r,warehouseLocDetails:{warehouseName:f?f.warehouseName:"",address:f?f.address:""}}))},q=async y=>{y.preventDefault();const f=JSON.parse(sessionStorage.getItem("user")).email;if(!f){u("User email not found. Please log in again.");return}const s=E.find(d=>d._id===h.warehouse);if(!s){u("Warehouse not found.");return}h.warehouseLocDetails={warehouseName:s.warehouseName,address:s.address},L(!0);try{const d=await $.patch(`/api/v1/warehouse/update/${j._id}`,{...h,byReceived:f});if(d.data.success){const c=d.data.data,O=E.find(a=>a._id===c.warehouse);c.warehouse=O,W(d.data.message),o(d.data.data),setTimeout(()=>{g(null),x(!1)},2e3)}}catch(d){u(d.response.data.message),m(d.response.data.message),setTimeout(()=>{u(null)},2e3)}L(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(V,{color:"primary",variant:"outline",className:"me-2",onClick:()=>x(!0),children:I?e.jsx(Y,{size:"sm"}):e.jsx(X,{icon:Se})}),e.jsxs(je,{visible:A,onClose:()=>x(!1),children:[e.jsx(fe,{children:e.jsx(ge,{children:"Recieved Items"})}),w&&e.jsx(F,{color:"danger",children:w}),b&&e.jsx(F,{color:"success",children:b}),e.jsx(pe,{children:e.jsx(Ne,{children:e.jsxs(we,{id:"warehouse",floatingLabel:"Warehouse",className:"mb-3",value:h.warehouse,onChange:p,required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),E.map(y=>e.jsxs("option",{value:y._id,children:[y.warehouseName," - ",y.address]},y._id))]})})}),e.jsxs(ve,{children:[e.jsx(V,{color:"secondary",variant:"outline",onClick:()=>x(!1),children:"Close"}),e.jsx(V,{color:"primary",variant:"outline",onClick:q,children:"Update Item"})]})]})]})},Fe=({warehousing:j,loading:o,error:W,onDeleteItem:m,onUpdateItem:w})=>{const[u,I]=n.useState([]),[L,b]=n.useState(null),[g,A]=n.useState(""),x=ye(),E=["manager","admin"],[k,h]=n.useState(1),[t]=n.useState(10),p=k*t,q=p-t,y=u.slice(q,p),r=Math.ceil(u.length/t);n.useEffect(()=>{try{if(g===""){I(j),b(null);return}const s=g.toLowerCase().trim(),d=j.filter(c=>{var O,a,N,P,i,l,v,C,R,M,K,T,G,U;try{return((O=c.poNumber)==null?void 0:O.toLowerCase().includes(s))||((N=(a=c.warehouseLocDetails)==null?void 0:a.warehouseName)==null?void 0:N.toLowerCase().includes(s))||((i=(P=c.warehouseLocDetails)==null?void 0:P.address)==null?void 0:i.toLowerCase().includes(s))||((v=(l=c.vendor)==null?void 0:l.businessName)==null?void 0:v.toLowerCase().includes(s))||((R=(C=c.vendor)==null?void 0:C.businessAddress)==null?void 0:R.toLowerCase().includes(s))||((K=(M=c.vendor)==null?void 0:M.contactNumber)==null?void 0:K.includes(s))||c.orderDate&&new Date(c.orderDate).toLocaleDateString().includes(s)||c.dateOfReceived&&new Date(c.receiveDate).toLocaleDateString().includes(s)||(((G=(T=c.byReceived)==null?void 0:T.toString().toLowerCase())==null?void 0:G.includes(s))??!1)||((U=c.details)==null?void 0:U.some(Q=>{var le,de,ue;return((le=Q.description)==null?void 0:le.toLowerCase().includes(s))||((de=Q.quantity)==null?void 0:de.toString().includes(s))||((ue=Q.unitPrice)==null?void 0:ue.toString().includes(s))}))}catch(Q){return console.error("Error filtering item:",Q),!1}});I(d),h(1),d.length===0?b("No data found"):b(null)}catch(s){console.error("Error in search effect:",s),b("Error occurred while searching")}},[g,j]);const f=s=>{A(s.target.value)};return o?e.jsx(Y,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):j.length===0?e.jsx(F,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mt-3",children:e.jsxs(J,{className:"w-50 mb-3",children:[e.jsx(_,{type:"text",placeholder:"Search by PO Number, Vendor, or Products...",value:g,id:"searchItem",onChange:f}),e.jsx(ce,{children:e.jsx(X,{icon:oe})})]})}),o?e.jsx(Y,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):j.length===0?e.jsx(F,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[L&&e.jsx(F,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:L}),e.jsx(Ie,{className:"m-2",children:y.map(s=>e.jsxs(Le,{children:[e.jsx(Pe,{children:e.jsxs("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[e.jsx("div",{children:e.jsxs("ul",{className:"list-unstyled",children:[e.jsxs("li",{children:["PO Number: ",e.jsx("strong",{children:s.poNumber})]}),e.jsxs("li",{children:["Warehuse Location: ",e.jsx("strong",{children:s.warehouse.warehouseName})]})]})}),e.jsxs("div",{className:"text-medium-emphasis",children:["Order Date: ",new Date(s.orderDate).toLocaleDateString()]})]})}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Vendor Information"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",s.vendor.businessName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",s.vendor.businessAddress]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"})," ",s.vendor.contactNumber]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Shipping Details"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Carrier:"})," ",s.carrier]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Receive Date:"})," ",new Date(s.receiveDate).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Products"}),e.jsxs(ee,{responsive:!0,small:!0,className:"mt-2",children:[e.jsx(se,{children:e.jsxs(z,{children:[e.jsx(S,{children:"Description"}),e.jsx(S,{children:"Quantity"}),e.jsx(S,{children:"Received By"}),e.jsx(S,{children:"Received Date"})]})}),e.jsx(re,{children:s.details.map((d,c)=>e.jsxs(z,{children:[e.jsx(D,{children:d.description}),e.jsx(D,{children:d.quantity}),e.jsx(D,{children:s.byReceived}),e.jsx(D,{children:s.dateOfReceived?new Date(s.dateOfReceived).toLocaleDateString():"N/A"})]},c))})]})]}),s.additionalNotes&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Additional Notes"}),e.jsx("div",{className:"ms-3",children:s.additionalNotes})]}),e.jsxs(B,{className:"d-flex justify-content-end mt-3",children:[e.jsx(Te,{warehousing:s,onUpdateItem:w}),E.includes(x)&&e.jsx(qe,{warehousing:s,onDeleteItem:m})]})]})]},s._id))}),u.length>0&&e.jsxs(B,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:["Showing ",q+1," to"," ",Math.min(p,u.length)," of"," ",u.length," entries"]}),e.jsxs(ie,{className:"mt-3",children:[e.jsx(H,{disabled:k===1,onClick:()=>h(s=>Math.max(s-1,1)),children:"Previous"}),Array.from({length:r},(s,d)=>d+1).map(s=>e.jsx(H,{active:s===k,onClick:()=>h(s),children:s},s)),e.jsx(H,{disabled:k===r,onClick:()=>h(s=>Math.min(s+1,r)),children:"Next"})]})]})]})]})},_e=({onAddItem:j,item:o={}})=>{var c,O,a,N,P;const{showSuccess:W,showError:m}=Z(),[w,u]=n.useState("Add Item"),[I,L]=n.useState(!1),[b,g]=n.useState(!1),[A,x]=n.useState(""),[E,k]=n.useState([]),h=new Date().toISOString().split("T")[0],[t,p]=n.useState({poNumber:o.poNumber||"",orderDate:o.orderDate||h,receiveDate:o.receiveDate||h,carrier:o.carrier||"",vendor:{businessName:((c=o==null?void 0:o.vendor)==null?void 0:c.businessName)||"",businessAddress:((O=o==null?void 0:o.vendor)==null?void 0:O.businessAddress)||"",contactNumber:((a=o==null?void 0:o.vendor)==null?void 0:a.contactNumber)||""},warehouse:o.warehouse||"",warehouseLocDetails:{warehouseName:((N=o==null?void 0:o.warehouseLocDetails)==null?void 0:N.warehouseName)||"",address:((P=o==null?void 0:o.warehouseLocDetails)==null?void 0:P.address)||""},details:o.details||[{productId:"",description:"",quantity:""}],procurementId:o.procurementId||"",rfqId:o.rfqId||null,vendorId:o.vendorId||"",additionalNotes:o.additionalNotes||"",byReceived:"",dateOfReceived:""});n.useEffect(()=>{console.log("Current formData:",t)},[t]);const q=i=>{const l=i.target.value,v=E.find(C=>C._id===l);p(C=>({...C,warehouse:l,warehouseLocDetails:{warehouseName:v?v.warehouseName:"",address:v?v.address:""}}))},y=(i,l,v)=>{p(C=>{const R=[...C.details];return R[i]={...R[i],[l]:v,...l==="quantity"||l==="unitPrice"?{subTotal:Number(l==="quantity"?v:R[i].quantity)*Number(l==="unitPrice"?v:R[i].unitPrice)}:{}},{...C,details:R}})},r=i=>{const{id:l,value:v}=i.target;if(l.includes(".")){const[C,R]=l.split(".");p(M=>({...M,[C]:{...M[C],[R]:v}}))}else p(C=>({...C,[l]:v}))},f=async i=>{try{return(await $.get(`/api/v1/warehouse/checkPoNumber/${i}`)).data.exists}catch(l){return console.error(l),!1}};n.useEffect(()=>{(async()=>{await f(o.poNumber)&&u("Already Added")})()},[o.poNumber]),n.useEffect(()=>{(async()=>{try{const l=await $.get("/api/v1/warehouseLoc/locations");k(l.data.data)}catch(l){x(l.response.data.message),m(l.response.data.message)}})()},[]);const s=()=>t.warehouse?!t.warehouseLocDetails.warehouseName||!t.warehouseLocDetails.address?(x("Warehouse location details are incomplete"),!1):!0:(x("Please select a warehouse"),!1),d=async i=>{var C,R,M,K;if(i.preventDefault(),!s())return;const v=JSON.parse(sessionStorage.getItem("user")).email;if(!v){x("User email not found. Please log in again.");return}if(!t.warehouse){x("Please select a warehouse");return}try{const T=E.find(Q=>Q._id===t.warehouse);if(!T){x("Selected warehouse not found");return}const G={...t,byReceived:v,dateOfReceived:new Date().toISOString().split("T")[0],warehouse:t.warehouse,warehouseLocDetails:{warehouseName:T.warehouseName,address:T.address}},U=await $.post("/api/v1/warehouse/addItem",G);U.data.success&&(j(U.data.data),g(!1),W("Item added successfully"),u("Already Added"))}catch(T){console.error("Error submitting form:",T),x(((R=(C=T.response)==null?void 0:C.data)==null?void 0:R.message)||"Error adding item"),m(((K=(M=T.response)==null?void 0:M.data)==null?void 0:K.message)||"Error adding item")}};return e.jsxs(e.Fragment,{children:[e.jsx(V,{color:"primary",variant:"outline",onClick:()=>g(!0),disabled:w==="Already Added",children:w==="Already Added"?e.jsx("span",{className:"me-1",children:"Already Added"}):e.jsx(X,{icon:De})}),e.jsxs(je,{visible:b,onClose:()=>g(!1),size:"lg",children:[e.jsx(fe,{children:e.jsx(ge,{children:"Add Receiving Item"})}),A&&e.jsx(F,{color:"danger",children:A}),I&&e.jsx(F,{color:"success",children:I}),e.jsx(pe,{children:e.jsxs(Ne,{children:[e.jsxs(J,{className:"mb-3",children:[e.jsx(_,{type:"text",id:"poNumber",floatingLabel:"PO Number",className:"mb-3",value:t.poNumber,onChange:r,required:!0,disabled:!0}),e.jsx(_,{type:"date",id:"orderDate",floatingLabel:"Order Date",className:"mb-3",value:t.orderDate.split("T")[0],onChange:r,required:!0,disabled:!0}),e.jsx(_,{type:"date",id:"receiveDate",floatingLabel:"Date to Receive",className:"mb-3",value:t.receiveDate.split("T")[0],onChange:r,required:!0,disabled:!0})]}),e.jsx(_,{type:"text",id:"vendor.businessName",floatingLabel:"Vendor Business Name",className:"mb-3",value:t.vendor.businessName,onChange:r,required:!0,disabled:!0}),e.jsx(J,{className:"mb-3",children:e.jsx(_,{type:"text",id:"vendor.businessAddress",floatingLabel:"Vendor Address",className:"mb-3",value:t.vendor.businessAddress,onChange:r,required:!0,disabled:!0})}),e.jsxs(J,{className:"mb-3",children:[e.jsx(_,{type:"text",id:"vendor.contactNumber",floatingLabel:"Vendor Contact Number",className:"mb-3",value:t.vendor.contactNumber,onChange:r,required:!0,disabled:!0}),e.jsx(_,{type:"text",id:"carrier",floatingLabel:"Carrier",className:"mb-3",value:t.carrier,onChange:r,required:!0,disabled:!0})]}),e.jsx(Ee,{id:"additionalNotes",floatingLabel:"Additional Notes",className:"mb-3",value:t.additionalNotes,onChange:r,rows:3,disabled:!0}),e.jsxs("div",{className:"mb-3",children:[e.jsx(ne,{children:"Product Details"}),e.jsxs(ee,{responsive:!0,children:[e.jsx(se,{children:e.jsxs(z,{children:[e.jsx(S,{children:"Description"}),e.jsx(S,{children:"Quantity"}),e.jsx(S,{children:"Unit Price "})]})}),e.jsx(re,{children:t.details.map((i,l)=>e.jsxs(z,{children:[e.jsx(D,{children:e.jsx(_,{type:"text",id:"description",value:i.description,onChange:v=>y(l,"description",v.target.value),placeholder:"Product description",disabled:!0})}),e.jsx(D,{children:e.jsx(_,{type:"number",id:"quantity",value:i.quantity,onChange:v=>y(l,"quantity",v.target.value),placeholder:"Qty",disabled:!0})}),e.jsx(D,{children:e.jsx(V,{color:"danger",size:"sm",onClick:()=>removeProductRow(l),disabled:t.details.length===1,children:"Remove"})})]},l))})]})]}),e.jsxs(we,{id:"warehouse",floatingLabel:"Warehouse",className:"mb-3",value:t.warehouse,onChange:q,required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),E.map(i=>e.jsxs("option",{value:i._id,children:[i.warehouseName," - ",i.address]},i._id))]})]})}),e.jsxs(ve,{children:[e.jsx(V,{color:"secondary",onClick:()=>g(!1),children:"Close"}),e.jsx(V,{color:"primary",onClick:d,children:"Save"})]})]})]})},Oe=({onAddItem:j})=>{const{showError:o,showSuccess:W}=Z(),[m,w]=n.useState([]),[u,I]=n.useState(1),[L,b]=n.useState(null),[g,A]=n.useState(!0),[x,E]=n.useState(""),[k,h]=n.useState([]),[t,p]=n.useState([]),q=10;n.useEffect(()=>{(async()=>{try{const N=await he.get("https://log2_backend.chysev.com/api/v1/purchaseOrder");console.log(N.data),N.status===200&&w(N.data)}catch(N){console.error("Error fetching data:",N)}})()},[]);const y=a=>{he.put(`https://log2_backend.chysev.com/api/v1/purchaseOrder/${a}`,{received:!0}).status===200&&fetchReicevingItems()};if(n.useEffect(()=>{(async()=>{var N,P;try{const i=await $.get("/api/v1/warehouseLoc/locations");i.data.data&&(p(i.data.data),W(i.data.message))}catch(i){b((N=i==null?void 0:i.response)==null?void 0:N.data.message),o(((P=i==null?void 0:i.response)==null?void 0:P.data.message)||"Error fetching warehouses")}})()},[]),n.useEffect(()=>{A(!1)},[]),n.useEffect(()=>{if(x===""){w(m);return}const a=x.toLowerCase().trim(),N=m.filter(P=>{var i,l,v,C,R,M,K,T,G;try{return((i=P.poNumber)==null?void 0:i.toLowerCase().includes(a))||((v=(l=P.vendor)==null?void 0:l.businessName)==null?void 0:v.toLowerCase().includes(a))||((R=(C=P.vendor)==null?void 0:C.businessAddress)==null?void 0:R.toLowerCase().includes(a))||((K=(M=P.vendor)==null?void 0:M.contactNumber)==null?void 0:K.toLowerCase().includes(a))||((T=P.carrier)==null?void 0:T.toLowerCase().includes(a))||P.orderDate&&new Date(P.orderDate).toLocaleDateString().includes(a)||P.receiveDate&&new Date(P.receiveDate).toLocaleDateString().includes(a)||((G=P.details)==null?void 0:G.some(U=>{var Q;return(Q=U.description)==null?void 0:Q.toLowerCase().includes(a)}))}catch(U){return console.error("Error filtering data:",U),!1}});w(N),I(1),b(N.length===0?"No results found":null)},[x]),g)return e.jsx(Y,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"});const r=u*q,f=r-q,s=m.slice(f,r),d=Math.ceil(m.length/q),c=a=>{E(a.target.value)};return m.length>0&&m.every(a=>a.received===!0)?e.jsx(F,{color:"success",className:"text-center mt-3 w-75 mx-auto",children:"All items have been received."}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mt-3",children:e.jsxs(J,{className:"w-50 mb-3",children:[e.jsx(_,{type:"text",placeholder:"Search by PO Number, Supplier, or Item Name",value:x,id:"searchInput",onChange:c}),e.jsx(ce,{children:e.jsx(X,{icon:oe})})]})}),e.jsxs(ee,{hover:!0,responsive:!0,children:[e.jsx(se,{children:e.jsxs(z,{children:[e.jsx(S,{children:"PO Number"}),e.jsx(S,{children:"Order Date"}),e.jsx(S,{children:"Date to Receive"}),e.jsx(S,{children:"Carrier"}),e.jsx(S,{children:"Warehouse"}),e.jsx(S,{children:"Vendor"}),e.jsx(S,{children:"Products"}),e.jsx(S,{children:"Receive"}),e.jsx(S,{children:"Actions"})]})}),e.jsx(re,{children:s.filter(a=>!a.received).map(a=>e.jsxs(z,{children:[e.jsx(D,{children:a.poNumber}),e.jsx(D,{children:new Date(a.orderDate).toLocaleDateString()}),e.jsx(D,{children:new Date(a.receiveDate).toLocaleDateString()}),e.jsx(D,{children:a.carrier}),e.jsx(D,{children:a.warehouse_id}),e.jsxs(D,{children:[e.jsx("div",{children:a.vendor.businessName}),e.jsx("small",{className:"text-medium-emphasis",children:a.vendor.contactNumber})]}),e.jsx(D,{children:a.details.map(N=>e.jsxs("div",{children:[N.description," ( pcs: ",N.quantity," x"," ",N.unitPrice.toFixed(2)," )"]},N.productId))}),e.jsx(D,{children:a.received?"Yes":"No"}),e.jsxs(D,{children:[e.jsx(_e,{item:a,onAddItem:j,mockDataReiceving}),e.jsx(V,{color:"primary",className:"mt-2",onClick:()=>y(a._id),children:"Complete"})]})]},a._id))})]}),m.filter(a=>!a.received).length>0&&e.jsxs(B,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(B,{children:["Showing ",f+1," to ",Math.min(r,m.length)," of"," ",m.length," entries"]}),e.jsxs(ie,{className:"mt-3",children:[e.jsx(H,{disabled:u===1,onClick:()=>I(a=>Math.max(a-1,1)),children:"Previous"}),[...Array(d).keys()].map(a=>e.jsx(H,{active:a+1===u,onClick:()=>I(a+1),children:a+1},a+1)),e.jsx(H,{disabled:u===d,onClick:()=>I(a=>Math.min(a+1,d)),children:"Next"})]})]}),L&&e.jsx(F,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:L})]})},Me=({items:j,loading:o,error:W})=>{const[m,w]=n.useState([]),[u,I]=n.useState(""),[L,b]=n.useState(null),g=10,[A,x]=n.useState(1),E=r=>{switch(r){case"Stocked":return"success";case"Out of Stock":return"danger";default:return"secondary"}};n.useEffect(()=>{w(j)},[j]),n.useEffect(()=>{if(u==="")w(j),b(null);else{const r=j.filter(f=>{const s=f.itemName.toLowerCase().includes(u.toLowerCase()),d=f.locations.some(c=>{const O=c.warehouse;return O.warehouseName.toLowerCase().includes(u.toLowerCase())||O.address.toLowerCase().includes(u.toLowerCase())});return s||d});w(r),x(1),r.length===0?b("No results found"):b(null)}},[u,j]);const k=r=>{I(r.target.value)},h=r=>{if(!r||!Array.isArray(r))return[];const f=new Map;return r.forEach(s=>{if(!(s!=null&&s.warehouse))return;const d=s.warehouse._id||"deleted";if(!f.has(d))f.set(d,{warehouse:{...s.warehouse,deleted:s.warehouse.deleted||!s.warehouse._id},quantity:s.quantity||0});else{const c=f.get(d);c.quantity+=s.quantity||0,f.set(d,c)}}),Array.from(f.values())};if(o)return e.jsx(Y,{color:"primary",className:"text-center mt-5 w-75 mx-auto justify-content-center"});if(W)return e.jsxs(F,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:["Error: ",W]});const t=A*g,p=t-g,q=m.slice(p,t),y=Math.ceil(m.length/g);return e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"m-3",children:e.jsxs(J,{className:"w-50 mb-3",children:[e.jsx(_,{type:"text",id:"search",value:u,onChange:k,placeholder:"Search by item name or warehouse..."}),e.jsx(ce,{children:e.jsx(X,{icon:oe})})]})}),e.jsxs("strong",{className:"m-3 align-self-start",children:["Total Items: ",q.length]}),L?e.jsx(F,{color:"warning",children:L}):e.jsxs(ee,{hover:!0,responsive:!0,striped:!0,className:"text-center",children:[e.jsx(se,{children:e.jsxs(z,{children:[e.jsx(S,{scope:"col",children:"Item Name"}),e.jsx(S,{scope:"col",children:"Total Quantity"}),e.jsx(S,{scope:"col",children:"Warehouse Locations"}),e.jsx(S,{scope:"col",children:"Status"})]})}),e.jsx(re,{children:q.map((r,f)=>e.jsxs(z,{children:[e.jsx(D,{children:r.itemName}),e.jsx(D,{children:e.jsx("strong",{children:r.quantity})}),e.jsx(D,{children:e.jsx(B,{className:"locations-list",children:h(r.locations).map((s,d)=>{const c=s.warehouse;return e.jsx(B,{className:"location-item",children:e.jsxs(B,{className:"location-details",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"warehouse-name",children:(c==null?void 0:c.warehouseName)||"Unknown Warehouse"}),e.jsx(me,{color:c!=null&&c.deleted?"danger":"success",className:"ms-2",children:c!=null&&c.deleted?"Deleted":"Active"})]}),e.jsx("span",{className:"warehouse-address",children:(c==null?void 0:c.address)||"No address available"}),e.jsxs("span",{className:"quantity-badge",children:["Qty: ",s.quantity]})]})},(c==null?void 0:c._id)||`deleted-${d}`)})})}),e.jsx(D,{children:e.jsx(me,{color:E(r.status||(r.quantity>0?"Stocked":"Out of Stock")),children:r.status||(r.quantity>0?"Stocked":"Out of Stock")})})]},r._id||f))})]}),m.length===0&&!L&&e.jsx(F,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No items found."}),e.jsxs(ie,{align:"center",children:[e.jsx(H,{disabled:A===1,onClick:()=>x(r=>Math.max(r-1,1)),children:"Previous"}),[...Array(y).keys()].map(r=>e.jsx(H,{active:r+1===A,onClick:()=>x(r+1),children:r+1},r+1)),e.jsx(H,{disabled:A===y,onClick:()=>x(r=>Math.min(r+1,y)),children:"Next"})]})]})},Qe=`
  .locations-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .location-item {
    display: flex;
    flex-direction: column;
    padding: 8px;
    background-color: #f8f9fa;
    border-radius: 4px;
    width: fit-content;

  }

  .location-details {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
  }

  .warehouse-name {
    font-weight: 500;
    color: #495057;
  }

  .warehouse-address {
    color: #6c757d;
    font-size: 0.9em;
    font-style: italic;
  }

  .quantity-badge {
    background-color: #e9ecef;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.85em;
    color: #495057;
  }

`,be=document.createElement("style");be.innerText=Qe;document.head.appendChild(be);const ds=()=>{const[j,o]=n.useState([]),[W,m]=n.useState([]),[w,u]=n.useState(!1),[I,L]=n.useState(null),[b,g]=n.useState(0);n.useEffect(()=>{(async()=>{u(!0);try{const t=await $.get("/api/v1/warehouse/items");o(t.data.data),m(t.data.data)}catch(t){L(t.message)}finally{u(!1)}})()},[b]);const A=()=>{g(h=>h+1)},x=h=>{o(t=>[...t,h]),m(t=>[...t,h]),A()},E=h=>{o(t=>t.filter(p=>p._id!==h)),m(t=>t.filter(p=>p._id!==h)),A()},k=h=>{o(t=>t.map(p=>p._id===h._id?h:p)),m(t=>t.map(p=>p._id===h._id?h:p)),A()};return e.jsx(e.Fragment,{children:e.jsxs(We,{activeItemKey:"Warehouse Items Details",children:[e.jsxs(ke,{variant:"tabs",children:[e.jsx(ae,{itemKey:"Warehouse Items Details",children:"Warehouse Items Details"}),e.jsx(ae,{itemKey:"For Reiceve",children:"For Reiceve"}),e.jsx(ae,{itemKey:"Items",children:"Items"})]}),e.jsxs(Re,{children:[e.jsx(te,{className:"p-3",itemKey:"Warehouse Items Details",children:e.jsx(Fe,{warehousing:j,loading:w,error:I,onDeleteItem:E,onUpdateItem:k})}),e.jsx(te,{className:"p-3",itemKey:"For Reiceve",children:e.jsxs(xe,{children:[e.jsx(ne,{children:"Item Reiceving"}),e.jsx(Oe,{onAddItem:x})]})}),e.jsx(te,{className:"p-3",itemKey:"Items",children:e.jsxs(xe,{children:[e.jsx(ne,{children:"Items"}),e.jsx(Me,{items:W,loading:w,error:I})]})})]})]})})};export{ds as default};
