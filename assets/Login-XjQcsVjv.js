import{r as a,l as k,j as e,m as T}from"./index-9q14rM7R.js";import{C as f}from"./index.esm-Yn3Ds21R.js";import{C as E}from"./CContainer-Bx_IidIf.js";import{a as h,C}from"./CRow-Bwl562f5.js";import{C as G}from"./CCardGroup-BGQ6SuUS.js";import{C as R}from"./CCard-B85_9HOU.js";import{C as q}from"./CCardBody-DFigFAK5.js";import{C as B}from"./CForm-CCEBrrPn.js";import{C as g}from"./CAlert-BY32Zm3C.js";import{C as j}from"./CInputGroup-VZBprtOO.js";import{C as y}from"./CInputGroupText-CtLay3vB.js";import{c as D}from"./cil-user-Ddrdy7PS.js";import{C as b}from"./CFormInput-CiLBdQhH.js";import{c as F}from"./cil-lock-locked-DmxpJbVL.js";import{a as U}from"./CButton-BT1rWau9.js";const $=()=>{const N={username:"",password:""},[o,S]=a.useState(N),[c,m]=a.useState(null),[l,d]=a.useState(!1),[u,n]=a.useState(""),v=k(),p=i=>{const{id:r,value:t}=i.target;S(s=>({...s,[r]:t}))},w=async i=>{var r,t;i.preventDefault(),d(!0),n("");try{const s=await T.post("api/v1/user/login",o);if(s.data.success){const{accessToken:I,refreshToken:x,user:L}=s.data;if(!x)throw new Error("Refresh token not received from server");sessionStorage.setItem("accessToken",I),sessionStorage.setItem("refreshToken",x),sessionStorage.setItem("user",JSON.stringify(L)),m(s.data.message),setTimeout(()=>{v("/dashboard"),m(null)},2e3)}}catch(s){n(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||s.message),setTimeout(()=>{n(null)},5e3)}finally{d(!1)}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(E,{children:e.jsx(h,{className:"justify-content-center",children:e.jsx(C,{xs:12,sm:10,md:8,lg:6,xl:4,children:e.jsx(G,{children:e.jsx(R,{className:"p-4",children:e.jsx(q,{children:e.jsxs(B,{onSubmit:w,children:[e.jsx("h1",{className:"text-center mb-3",children:"Login"}),e.jsx("p",{className:"text-body-secondary text-center mb-4",children:"Sign In to your account"}),c&&e.jsx(g,{color:"success",className:"text-success mb-3",children:c}),u&&e.jsx(g,{color:"danger",className:"text-danger mb-3",children:u}),e.jsxs(j,{className:"mb-3",children:[e.jsx(y,{children:e.jsx(f,{icon:D})}),e.jsx(b,{type:"text",placeholder:"Username",autoComplete:"off",id:"username",required:!0,value:o.username,onChange:p})]}),e.jsxs(j,{className:"mb-4",children:[e.jsx(y,{children:e.jsx(f,{icon:F})}),e.jsx(b,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",required:!0,value:o.password,onChange:p})]}),e.jsx(h,{className:"justify-content-center",children:e.jsx(C,{xs:12,sm:8,md:6,children:e.jsx(U,{color:"primary",className:"px-4 w-100",type:"submit",disabled:l,children:l?"Logging in...":"Login"})})})]})})})})})})})})};export{$ as default};
