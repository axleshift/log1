import{r as t,m as k,j as s,l as T}from"./index-BsAuDz7v.js";import{C as x}from"./index.esm-CMByg3QK.js";import{C as R}from"./CContainer-D4HQE-qk.js";import{C as h,a as f}from"./CRow-Brp6MKF9.js";import{C as E}from"./CCardGroup-BnozokXd.js";import{C as U}from"./CCard-BQgonU39.js";import{C as G}from"./CCardBody-D4BA6tNM.js";import{C as q,a as C}from"./CForm-DJmgfv4a.js";import{C as g,a as j}from"./CInputGroupText-scgwoFmL.js";import{c as A}from"./cil-user-Ddrdy7PS.js";import{C as y}from"./CFormInput-De0-5chn.js";import{c as B}from"./cil-lock-locked-DmxpJbVL.js";import{a as D}from"./CButton-1aJwC6WA.js";const F="http://localhost:5057",P=T.create({baseURL:F}),$=()=>{const b={username:"",password:""},[o,S]=t.useState(b),[c,v]=t.useState(null),[m,l]=t.useState(!1),[d,n]=t.useState(""),N=k(),u=i=>{const{id:r,value:a}=i.target;S(e=>({...e,[r]:a}))},w=async i=>{var r,a;i.preventDefault(),l(!0),n("");try{const e=await P.post("/api/v1/user/login",o);if(e.data.success){const{accessToken:I,refreshToken:p,user:L}=e.data;if(!p)throw new Error("Refresh token not received from server");sessionStorage.setItem("accessToken",I),sessionStorage.setItem("refreshToken",p),sessionStorage.setItem("user",JSON.stringify(L)),v(e.data.message),setTimeout(()=>{N("/dashboard")},2e3)}}catch(e){n(((a=(r=e.response)==null?void 0:r.data)==null?void 0:a.message)||e.message),setTimeout(()=>{n(null)},2e3)}finally{l(!1)}};return s.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:s.jsx(R,{children:s.jsx(h,{className:"justify-content-center",children:s.jsx(f,{md:4,sm:2,children:s.jsx(E,{children:s.jsx(U,{className:"p-4",children:s.jsx(G,{children:s.jsxs(q,{onSubmit:w,children:[c&&s.jsx(C,{color:"success",className:"text-success mb-3",children:c}),d&&s.jsx(C,{color:"danger",className:"text-danger mb-3",children:d}),s.jsx("h1",{children:"Login"}),s.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),s.jsxs(g,{className:"mb-3",children:[s.jsx(j,{children:s.jsx(x,{icon:A})}),s.jsx(y,{type:"text",placeholder:"Username",autoComplete:"off",id:"username",required:!0,value:o.username,onChange:u})]}),s.jsxs(g,{className:"mb-4",children:[s.jsx(j,{children:s.jsx(x,{icon:B})}),s.jsx(y,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",required:!0,value:o.password,onChange:u})]}),s.jsx(h,{children:s.jsx(f,{xs:6,children:s.jsx(D,{color:"primary",className:"px-4",type:"submit",disabled:m,children:m?"Logging in...":"Login"})})})]})})})})})})})})};export{$ as default};
