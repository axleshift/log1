import{r as c,A as fe,j as e,k as V,n as Z,l as ie,E as U,m as pe}from"./index-BlfM3l9C.js";import{F as G,k as oe,H as ve,m as Ne,a as Y}from"./index-BRFt-_Ew.js";import{C as $}from"./CAlert-YoK6qkKi.js";import{C as B}from"./CContainer-CZv4i3cM.js";import{C as ee}from"./CInputGroup-C7D8o7Hi.js";import{C as se}from"./CFormInput-B56y6u5w.js";import{C as re}from"./CInputGroupText-ynlpc-Xt.js";import{C as le,a as de,b as he,c as ue}from"./CAccordionHeader-3wW2-CxG.js";import{C as xe,a as me,b as z,c as b,d as je,e as S}from"./CTable-BQl-JIcF.js";import{C as te,a as P}from"./CPaginationItem-D2w97l8k.js";import{a as Ce}from"./CButton-DWcO4Axg.js";import{C as we,a as ye,b as J,c as X}from"./CTabList-BRZcU5pZ.js";import{a as be,C as ne}from"./DefaultLayout-CiReJI24.js";import{C as ce}from"./CCard-CUxn-fsT.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";import"./index.esm-BSCVESJC.js";import"./1-Cdgs0iE4.js";import"./cil-user-Ddrdy7PS.js";const Se=({warehousing:p,loading:v,error:L,onDeleteItem:u,onUpdateItem:_})=>{const[m,f]=c.useState([]),[E,j]=c.useState(null),[N,A]=c.useState("");fe();const[g,C]=c.useState(1),[W]=c.useState(10),[l,o]=c.useState([]),d=Math.ceil(m.length/W),D=m.filter(a=>a.received===!0),M=g*W,w=M-W,I=D.slice(w,M);c.useEffect(()=>{try{if(N===""){f(p),j(null);return}const a=N.toLowerCase().trim(),h=p.filter(s=>{var r,i,t,n,x,y,R,F,O;try{return((r=s.poNumber)==null?void 0:r.toLowerCase().includes(a))||((t=(i=s.vendor)==null?void 0:i.businessName)==null?void 0:t.toLowerCase().includes(a))||((x=(n=s.vendor)==null?void 0:n.businessAddress)==null?void 0:x.toLowerCase().includes(a))||((R=(y=s.vendor)==null?void 0:y.contactNumber)==null?void 0:R.includes(a))||s.orderDate&&new Date(s.orderDate).toLocaleDateString().includes(a)||s.dateOfReceived&&new Date(s.receiveDate).toLocaleDateString().includes(a)||((F=k(s.warehouseId))==null?void 0:F.toLowerCase().includes(a))||((O=s.details)==null?void 0:O.some(T=>{var Q,q,H;return((Q=T.description)==null?void 0:Q.toLowerCase().includes(a))||((q=T.quantity)==null?void 0:q.toString().includes(a))||((H=T.unitPrice)==null?void 0:H.toString().includes(a))}))}catch(T){return console.error("Error filtering item:",T),!1}});f(h),C(1),h.length===0?j("No data found"):j(null)}catch(a){console.error("Error in search effect:",a),j("Error occurred while searching")}},[N,p]),c.useEffect(()=>{(async()=>{var h;try{const s=await Z.get("/api/v1/warehouseLoc/locations");s.data.data&&o(s.data.data)}catch(s){j((h=s==null?void 0:s.response)==null?void 0:h.data.message)}})()},[]);const k=a=>{if(!l.length)return"Loading...";const h=l.find(s=>s._id===a);return h?h.warehouseName:"Unknown Warehouse"},K=a=>{A(a.target.value)};return v?e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):p.length===0?e.jsx($,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):L?e.jsxs($,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",L.message]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mt-3",children:e.jsxs(ee,{className:"w-50 mb-3",children:[e.jsx(se,{type:"text",placeholder:"Search by PO Number, Vendor, or Products...",value:N,id:"searchItem",onChange:K}),e.jsx(re,{children:e.jsx(G,{icon:oe})})]})}),v?e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):p.length===0?e.jsx($,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[E&&e.jsx($,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:E}),e.jsx(le,{className:"m-2",children:I.filter(a=>a.received).map(a=>e.jsxs(de,{children:[e.jsx(he,{children:e.jsxs("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[e.jsx("div",{children:e.jsxs("ul",{className:"list-unstyled",children:[e.jsxs("li",{children:["PO Number: ",e.jsx("strong",{children:a.poNumber})]}),e.jsxs("li",{children:["Warehuse Location:"," ",e.jsx("strong",{children:k(a.warehouse_id)})]})]})}),e.jsxs("div",{className:"text-medium-emphasis",children:["Order Date: ",new Date(a.orderDate).toLocaleDateString()]})]})}),e.jsxs(ue,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Vendor Information"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",a.vendor.businessName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",a.vendor.businessAddress]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"})," ",a.vendor.contactNumber]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Shipping Details"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Carrier:"})," ",a.carrier]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Expected Delivery Date:"})," ",new Date(a.receiveDate).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Products"}),e.jsxs(xe,{responsive:!0,small:!0,className:"mt-2",children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(b,{children:"Description"}),e.jsx(b,{children:"Quantity"})]})}),e.jsx(je,{children:a.details.map((h,s)=>e.jsxs(z,{children:[e.jsx(S,{children:h.description}),e.jsx(S,{children:h.quantity})]},s))})]})]}),a.additionalNotes&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Additional Notes"}),e.jsx("div",{className:"ms-3",children:a.additionalNotes})]})]})]},a._id))}),I.length>0&&e.jsxs(B,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:["Showing ",D.length>0?w+1:0," to"," ",Math.min(M,D.length)," of ",D.length," received entries"]}),e.jsxs(te,{className:"mt-3",children:[e.jsx(P,{disabled:g===1,onClick:()=>C(a=>Math.max(a-1,1)),children:"Previous"}),Array.from({length:d},(a,h)=>h+1).map(a=>e.jsx(P,{active:a===g,onClick:()=>C(a),children:a},a)),e.jsx(P,{disabled:g===d,onClick:()=>C(a=>Math.min(a+1,d)),children:"Next"})]})]})]})]})},De=({onAddItem:p})=>{const{showError:v,showSuccess:L}=ie(),[u,_]=c.useState([]),[m,f]=c.useState(1),[E,j]=c.useState(null),[N,A]=c.useState(!0),[g,C]=c.useState(""),[W,l]=c.useState([]),[o,d]=c.useState([]),D=10;c.useEffect(()=>{(async()=>{var i;try{const t=await U.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");t.status===200?_(t.data):j(t.data.message||"Error fetching data")}catch(t){console.error("Error fetching data:",t),j(((i=t==null?void 0:t.response)==null?void 0:i.data.message)||"Error fetching data")}})()},[]);const M=async r=>{var i,t;try{if((await U.put(`https://backend-log2.axleshift.com/api/v1/purchaseOrder/${r}`,{received:!0,receiveDate:new Date().toISOString()})).status===200){const x=await U.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");_(x.data),L("Item received successfully")}}catch(n){console.error("Error updating purchase order:",n),v(((t=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:t.message)||"Error updating purchase order")}};c.useEffect(()=>{(async()=>{var i,t;try{const n=await Z.get("/api/v1/warehouseLoc/locations");n.data.data&&(d(n.data.data),L(n.data.message))}catch(n){j((i=n==null?void 0:n.response)==null?void 0:i.data.message),v(((t=n==null?void 0:n.response)==null?void 0:t.data.message)||"Error fetching warehouses")}})()},[]);const w=r=>{if(!o.length)return"Loading...";const i=o.find(t=>t._id===r);return i?i.warehouseName:"Unknown Warehouse"};if(c.useEffect(()=>{A(!1)},[]),c.useEffect(()=>{if(g===""){_(u);return}const r=g.toLowerCase().trim(),i=u.filter(t=>{var n,x,y,R,F,O,T,Q,q;try{return((n=t.poNumber)==null?void 0:n.toLowerCase().includes(r))||((y=(x=t.vendor)==null?void 0:x.businessName)==null?void 0:y.toLowerCase().includes(r))||((F=(R=t.vendor)==null?void 0:R.businessAddress)==null?void 0:F.toLowerCase().includes(r))||((T=(O=t.vendor)==null?void 0:O.contactNumber)==null?void 0:T.toLowerCase().includes(r))||((Q=t.carrier)==null?void 0:Q.toLowerCase().includes(r))||t.orderDate&&new Date(t.orderDate).toLocaleDateString().includes(r)||t.receiveDate&&new Date(t.receiveDate).toLocaleDateString().includes(r)||((q=t.details)==null?void 0:q.some(H=>{var ae;return(ae=H.description)==null?void 0:ae.toLowerCase().includes(r)}))}catch(H){return console.error("Error filtering data:",H),!1}});_(i),f(1),j(i.length===0?"No results found":null)},[g]),N)return e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"});const I=m*D,k=I-D,K=u.slice(k,I),a=Math.ceil(u.length/D),h=r=>{C(r.target.value)};if(u.filter(r=>!r.received).length===0)return e.jsx($,{color:"danger",className:"text-center mt-3 w-75 mx-auto",children:"No items to receive."});const s=({icon:r})=>{const[i,t]=c.useState(!1);return e.jsx(G,{icon:r,bounce:i,onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mt-3",children:e.jsxs(ee,{className:"w-50 mb-3",children:[e.jsx(se,{type:"text",placeholder:"Search by PO Number, Supplier, or Item Name",value:g,id:"searchInput4",onChange:h}),e.jsx(re,{children:e.jsx(G,{icon:oe})})]})}),e.jsxs(xe,{hover:!0,responsive:!0,children:[e.jsx(me,{children:e.jsxs(z,{children:[e.jsx(b,{children:"PO Number"}),e.jsx(b,{children:"Order Date"}),e.jsx(b,{children:"Date to Receive"}),e.jsx(b,{children:"Carrier"}),e.jsx(b,{children:"Warehouse"}),e.jsx(b,{children:"Vendor"}),e.jsx(b,{children:"Products"}),e.jsx(b,{children:"Receive"}),e.jsx(b,{children:"Actions"})]})}),e.jsx(je,{children:K.filter(r=>!r.received).map((r,i)=>e.jsxs(z,{children:[e.jsx(S,{children:r.poNumber}),e.jsx(S,{children:new Date(r.orderDate).toLocaleDateString()}),e.jsx(S,{children:new Date(r.receiveDate).toLocaleDateString()}),e.jsx(S,{children:r.carrier}),e.jsx(S,{children:w(r.warehouse_id)}),e.jsxs(S,{children:[e.jsx("div",{children:r.vendor.businessName}),e.jsx("small",{className:"text-medium-emphasis",children:r.vendor.contactNumber})]}),e.jsx(S,{children:r.details.map((t,n)=>e.jsxs("div",{children:[" ",t.description," ( pcs: ",t.quantity," x"," ",t.unitPrice.toFixed(2)," )"]},`${r._id}-${t._id||n}`))}),e.jsx(S,{children:r.received?"Yes":"No"}),e.jsx(S,{children:e.jsxs(Ce,{color:"primary",className:"mt-2",onClick:()=>M(r._id),children:[e.jsx(s,{icon:ve})," Complete"]})})]},r._id||`item-${i}`))})]}),u.filter(r=>!r.received).length>0&&e.jsxs(B,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(B,{children:["Showing ",k+1," to ",Math.min(I,u.length)," of"," ",u.length," entries"]}),e.jsxs(te,{className:"mt-3",children:[e.jsx(P,{disabled:m===1,onClick:()=>f(r=>Math.max(r-1,1)),children:"Previous"}),[...Array(a).keys()].map(r=>e.jsx(P,{active:r+1===m,onClick:()=>f(r+1),children:r+1},r+1)),e.jsx(P,{disabled:m===a,onClick:()=>f(r=>Math.min(r+1,a)),children:"Next"})]})]}),E&&e.jsx($,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:E})]})},Ie=`
  .locations-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .location-item {
    display: flex;
    flex-direction: column;
    padding: 8px;
    background-color: #f8f9fa;
    border-radius: 4px;
    width: fit-content;

  }

  .location-details {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
  }

  .warehouse-name {
    font-weight: 500;
    color: #495057;
  }

  .warehouse-address {
    color: #6c757d;
    font-size: 0.9em;
    font-style: italic;
  }

  .quantity-badge {
    background-color: #e9ecef;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.85em;
    color: #495057;
  }

`,ge=document.createElement("style");ge.innerText=Ie;document.head.appendChild(ge);const Le=()=>{const{showError:p,showSuccess:v}=ie(),[L,u]=c.useState([]),[_,m]=c.useState(!0),[f,E]=c.useState(""),[j,N]=c.useState(null),[A,g]=c.useState(null),[C,W]=c.useState([]),[l,o]=c.useState(1),[d]=c.useState(10);pe();const D=async()=>{var s,r,i,t;m(!0);try{const n=await U.get("https://backend-log2.axleshift.com/api/v1/shipment");if(n.status===200){const x=n.data.shipments||[];u(x),N(null)}}catch(n){N(((r=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:r.message)||"Error fetching data"),p(((t=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:t.message)||"Error fetching data")}finally{m(!1)}};c.useEffect(()=>{D()},[]),c.useEffect(()=>{(async()=>{var r,i;try{const t=await Z.get("/api/v1/warehouseLoc/locations");t.data.data&&W(t.data.data)}catch(t){g((r=t==null?void 0:t.response)==null?void 0:r.data.message),p(((i=t==null?void 0:t.response)==null?void 0:i.data.message)||"Error fetching warehouses")}})()},[]);const M=s=>{if(!C.length)return"Loading...";const r=C.find(i=>i._id===s);return r?e.jsx(Y,{color:"success",children:r.warehouseName}):e.jsx(Y,{color:"danger",children:"Not Yet Assigned"})},w=Array.isArray(L)?L.filter(s=>{var i,t,n,x,y;const r=f.toLowerCase();return((i=s==null?void 0:s.tracking_id)==null?void 0:i.toLowerCase().includes(r))||((n=(t=s==null?void 0:s.shipper)==null?void 0:t.shipper_company_name)==null?void 0:n.toLowerCase().includes(r))||((x=s==null?void 0:s.dispatch)==null?void 0:x.toLowerCase().includes(r))||((y=s==null?void 0:s.warehouse_id)==null?void 0:y.toString().includes(r))}):[],I=l*d,k=I-d,K=w.slice(k,I),a=Math.ceil(w.length/d),h=s=>{switch(s==null?void 0:s.toLowerCase()){case"pending":return"warning";case"completed":return"success";case"cancelled":return"danger";default:return"info"}};return _?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"60vh"},children:e.jsx(V,{color:"primary"})}):e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs(ee,{className:"mb-2 mt-2",children:[e.jsx(se,{type:"text",id:"searchInput",placeholder:"Search by tracking ID, shipper, status, warehouse...",value:f,onChange:s=>E(s.target.value)}),e.jsx(re,{children:e.jsx(G,{icon:Ne})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"text-end",children:e.jsxs("span",{className:"text-muted",children:["Total Records:"," ",w.filter(s=>s.isInWarehouse&&s.dispatch!=="Completed").length]})})})]})}),w.length>0?e.jsxs(e.Fragment,{children:[e.jsx(le,{flush:!0,children:K.filter(s=>s.isInWarehouse&&s.dispatch!=="Completed").map(s=>{var r,i,t,n,x,y,R,F,O;return e.jsxs(de,{children:[e.jsx(he,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Tracking ID:"})," ",s.tracking_id]}),e.jsxs("div",{className:"d-flex gap-3 me-3",children:[M(s.warehouse_id),e.jsx(Y,{color:h(s.dispatch),children:s.dispatch||"N/A"})]})]})}),e.jsxs(ue,{children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"mb-3",children:"Shipper Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Company:"})," ",((r=s.shipper)==null?void 0:r.shipper_company_name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((i=s.shipper)==null?void 0:i.shipper_company_address)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",((t=s.shipper)==null?void 0:t.shipper_contact_name)||"N/A"]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"mb-3",children:"Consignee Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Company:"})," ",((n=s.consignee)==null?void 0:n.consignee_company_name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((x=s.consignee)==null?void 0:x.consignee_company_address)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",((y=s.consignee)==null?void 0:y.consignee_contact_name)||"N/A"]})]})]}),e.jsx("div",{className:"row mt-3",children:e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"mb-3",children:"Vehicle Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vehicle:"})," ",(R=s.vehicle)!=null&&R.name&&((F=s.vehicle)!=null&&F.plate_no)?`${s.vehicle.name} (${s.vehicle.plate_no})`:"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Driver:"})," ",((O=s.vehicle)==null?void 0:O.driver_name)||"N/A"]})]})})]})]},s.tracking_id||Math.random())})}),a>1&&e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-muted",children:["Showing ",k+1," to"," ",Math.min(I,w.filter(s=>s.isInWarehouse&&s.dispatch!=="Completed").length)," ","of"," ",w.filter(s=>s.isInWarehouse&&s.dispatch!=="Completed").length," ","entries"]})}),e.jsxs(te,{"aria-label":"Page navigation",children:[e.jsx(P,{"aria-label":"Previous",disabled:l===1,onClick:()=>o(l-1),children:e.jsx("span",{"aria-hidden":"true",children:"Previous"})}),[...Array(a)].map((s,r)=>e.jsx(P,{active:l===r+1,onClick:()=>o(r+1),children:r+1},r+1)),e.jsx(P,{"aria-label":"Next",disabled:l===a,onClick:()=>o(l+1),children:e.jsx("span",{"aria-hidden":"true",children:"Next"})})]})]})]}):e.jsx($,{color:"info",className:"text-center p-4",children:"No shipment records found"})]})},Ve=()=>{const[p,v]=c.useState([]),[L,u]=c.useState([]),[_,m]=c.useState(!1),[f,E]=c.useState(null),[j,N]=c.useState(0);c.useEffect(()=>{(async()=>{m(!0);try{const o=await U.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");o.status===200&&v(o.data)}catch(o){E(o.message)}finally{m(!1)}})()},[j]);const A=()=>{N(l=>l+1)},g=l=>{v(o=>[...o,l]),u(o=>[...o,l]),A()},C=l=>{v(o=>o.filter(d=>d._id!==l)),u(o=>o.filter(d=>d._id!==l)),A()},W=l=>{v(o=>o.map(d=>d._id===l._id?l:d)),u(o=>o.map(d=>d._id===l._id?l:d)),A()};return e.jsx(e.Fragment,{children:e.jsxs(we,{activeItemKey:"Warehouse Items Details",children:[e.jsxs(ye,{variant:"tabs",children:[e.jsx(J,{itemKey:"Warehouse Items Details",children:"Warehouse Items Details"}),e.jsx(J,{itemKey:"For Receiving",children:"For Receiving"}),e.jsx(J,{itemKey:"Shipment",children:"Warehouse Shipment Items"})]}),e.jsxs(be,{children:[e.jsx(X,{className:"p-3",itemKey:"Warehouse Items Details",children:e.jsx(Se,{warehousing:p,loading:_,error:f,onDeleteItem:C,onUpdateItem:W,onRefresh:A})}),e.jsx(X,{className:"p-3",itemKey:"For Receiving",children:e.jsxs(ce,{children:[e.jsx(ne,{children:"Item Reiceving"}),e.jsx(De,{onAddItem:g})]})}),e.jsx(X,{className:"p-3",itemKey:"Shipment",children:e.jsxs(ce,{children:[e.jsx(ne,{children:"Shipment"}),e.jsx(Le,{})]})})]})]})})};export{Ve as default};
