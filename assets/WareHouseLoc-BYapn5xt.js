import{r as s,_ as ue,a as L,R as T,c as me,P as d,e as fe,w as he,j as e,C as k}from"./index-BGH5WKgn.js";import{a as _}from"./index-DW_MHI2K.js";import{u as pe,e as xe,F as z,f as ge,a as je,i as Ce,j as be,C as ee}from"./DefaultLayout-D-YVYAE7.js";import{a as E}from"./CButton-Bwssm7-p.js";import{C as se,a as ae,b as te,c as oe,d as re}from"./CModalTitle-D48pPIQc.js";import{C as A}from"./CAlert-8_0YzkvJ.js";import{C as ne}from"./CForm-BZRjToy7.js";import{C as R}from"./CFormInput-BE5aKP1g.js";import{C as ye}from"./index.esm-CQ0Ql4Ln.js";import{C as ve,a as Ne}from"./CInputGroupText-DTBNZhpZ.js";import{C as we}from"./CCard--Vw0nMq9.js";import{C as Pe}from"./CCardBody-DbRd0EZb.js";import{C as Se,a as Le,b as Z,c as D,d as ke,e as H}from"./CTable-JQGXnSE7.js";import{u as We}from"./CCloseButton-C08nsniV.js";import{g as Te,e as Ee}from"./getRTLPlacement-CGij8Fwo.js";import{C as Ae,a as q}from"./CPaginationItem-CzA_t2Pv.js";import"./cil-user-Ddrdy7PS.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";var F=s.forwardRef(function(a,C){var y=a.children,u=a.animation,g=u===void 0?!0:u,t=a.className,m=a.container,f=a.content,h=a.delay,l=h===void 0?0:h,n=a.fallbackPlacements,i=n===void 0?["top","right","bottom","left"]:n,o=a.offset,v=o===void 0?[0,6]:o,b=a.onHide,w=a.onShow,p=a.placement,P=p===void 0?"top":p,x=a.popperConfig,j=a.trigger,c=j===void 0?["hover","focus"]:j,W=a.visible,r=ue(a,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","popperConfig","trigger","visible"]),N=s.useRef(null),S=s.useRef(null),O=We(C,N),V="tooltip".concat(s.useId()),G=s.useState(!1),B=G[0],Q=G[1],J=s.useState(W),I=J[0],K=J[1],$=pe(),le=$.initPopper,ie=$.destroyPopper,ce=$.updatePopper,X=typeof l=="number"?{show:l,hide:l}:l,Y={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:i}},{name:"offset",options:{offset:v}}],placement:Te(P,S.current)},de=L(L({},Y),typeof x=="function"?x(Y):x);s.useEffect(function(){if(W){M();return}U()},[W]),s.useEffect(function(){if(B&&S.current&&N.current){le(S.current,N.current,de),setTimeout(function(){K(!0)},X.show);return}!B&&S.current&&N.current&&ie()},[B]),s.useEffect(function(){!I&&S.current&&N.current&&Ee(function(){Q(!1)},N.current)},[I]);var M=function(){Q(!0),w&&w()},U=function(){setTimeout(function(){K(!1),b&&b()},X.hide)};return s.useEffect(function(){ce()},[f]),T.createElement(T.Fragment,null,T.cloneElement(y,L(L(L(L(L({},I&&{"aria-describedby":V}),{ref:S}),(c==="click"||c.includes("click"))&&{onClick:function(){return I?U():M()}}),(c==="focus"||c.includes("focus"))&&{onFocus:function(){return M()},onBlur:function(){return U()}}),(c==="hover"||c.includes("hover"))&&{onMouseEnter:function(){return M()},onMouseLeave:function(){return U()}})),T.createElement(xe,{container:m,portal:!0},B&&T.createElement("div",L({className:me("tooltip","bs-tooltip-auto",{fade:g,show:I},t),id:V,ref:O,role:"tooltip"},r),T.createElement("div",{className:"tooltip-arrow"}),T.createElement("div",{className:"tooltip-inner"},f))))});F.propTypes={animation:d.bool,children:d.node,container:d.any,content:d.oneOfType([d.string,d.node]),delay:d.oneOfType([d.number,d.shape({show:d.number.isRequired,hide:d.number.isRequired})]),fallbackPlacements:he,offset:d.any,onHide:d.func,onShow:d.func,placement:d.oneOf(["auto","top","right","bottom","left"]),popperConfig:d.oneOfType([d.func,d.object]),trigger:fe,visible:d.bool};F.displayName="CTooltip";const Ie="http://localhost:5057",Fe=_.create({baseURL:Ie}),Re=({onAddWarehouseLoc:a})=>{const[C,y]=s.useState(!1),[u,g]=s.useState(!1),[t,m]=s.useState(!1),[f,h]=s.useState(null),[l,n]=s.useState(null),i={warehouseName:"",address:""},[o,v]=s.useState(i),b=p=>{const{id:P,value:x}=p.target;v(j=>({...j,[P]:x}))},w=async p=>{const x=p.currentTarget.checkValidity();if(x||(p.preventDefault(),p.stopPropagation()),y(x),x){const j=sessionStorage.getItem("email");if(!j){h("User email not found. Please log in again.");return}m(!0);try{const c=await Fe.post("/api/v1/warehouseLoc/add",{...o,createdBy:j});c.status===201&&(n(c.data.message),a(c.data.data),setTimeout(()=>{n(null),v(i),g(!1),m(!1),h(null)},2e3),v({warehouseName:"",address:""}))}catch(c){h(c.response.data.message),setTimeout(()=>{h(null)},2e3)}m(!1)}};return e.jsx(e.Fragment,{children:t?e.jsx(k,{color:"primary",size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(E,{color:"primary",variant:"outline",disabled:t,onClick:()=>g(!0),children:[t?e.jsx(k,{color:"secondary",size:"sm"}):e.jsx(z,{icon:ge})," ","Add Warehouse Location"]}),e.jsxs(se,{visible:u,onClose:()=>g(!1),children:[e.jsx(ae,{closeButton:!0,children:e.jsx(te,{children:"Add Warehouse Location"})}),f&&e.jsx(A,{color:"danger",className:"m-3",children:f}),l&&e.jsx(A,{color:"success",className:"m-3",children:l}),e.jsx(oe,{children:e.jsxs(ne,{noValidate:!0,validated:C,children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:b,value:o.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name",feedbackValid:"Looks good!"}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:b,value:o.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address",feedbackValid:"Looks good!"})]})}),e.jsxs(re,{children:[e.jsx(E,{color:"secondary",variant:"outline",disabled:t,onClick:()=>{g(!1),v(i),g(!1),h(null),y(!1)},children:t?e.jsx(k,{color:"secondary",size:"sm"}):"Cancel"}),e.jsx(E,{color:"primary",variant:"outline",disabled:t,onClick:w,children:t?e.jsx(k,{color:"primary",size:"sm"}):"Add"})]})]})]})})},Ve="http://localhost:5057",Be=_.create({baseURL:Ve}),Me=({warehouseLoc:a,onDeleteWarehouseLoc:C})=>{const[y,u]=s.useState(!1),[g,t]=s.useState(null),m=async()=>{u(!0);try{const f=await Be.delete(`/api/v1/warehouseLoc/delete/${a._id}`);console.log(f.data),f.status===200&&(alert("Warehouse Location deleted successfully"),C(a._id),u(!1),t(null))}catch(f){t(f)}finally{u(!1)}};return g?e.jsxs(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",g.message]}):e.jsx(e.Fragment,{children:e.jsx(E,{color:"danger",disabled:y,variant:"outline",onClick:m,className:"me-2",children:y?e.jsx(k,{size:"sm"}):e.jsx(z,{icon:je})})})},Ue="http://localhost:5057",De=_.create({baseURL:Ue}),He=({warehouseLoc:a,onUpdateWarehouseLoc:C})=>{const[y,u]=s.useState(!1),[g,t]=s.useState(!1),[m,f]=s.useState(!1),[h,l]=s.useState(null),[n,i]=s.useState(null),[o,v]=s.useState({warehouseName:a.warehouseName,address:a.address}),b=p=>{const{id:P,value:x}=p.target;v(j=>({...j,[P]:x}))},w=async p=>{const x=p.currentTarget.checkValidity();x||(p.preventDefault(),p.stopPropagation()),t(x);const j=sessionStorage.getItem("email");if(!j){l("User email not found. Please log in again.");return}f(!0);try{const c=await De.put(`/api/v1/warehouseLoc/update/${a._id}`,{...o,createdBy:j});c.status===200&&(i("Warehouse Location updated successfully"),C(c.data.data),setTimeout(()=>{i(null),u(!1),l(null),t(!1)},2e3))}catch(c){l(c.response.data.message),setTimeout(()=>{l(null)},2e3)}f(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(E,{color:"primary",variant:"outline",disabled:m,onClick:()=>u(!0),className:"me-2",children:m?e.jsx(k,{size:"sm"}):e.jsx(z,{icon:Ce})}),e.jsxs(se,{visible:y,onClose:()=>u(!1),children:[e.jsx(ae,{closeButton:!0,children:e.jsx(te,{children:"Update Warehouse Location"})}),h&&e.jsx(A,{color:"danger",className:"m-3",children:h}),n&&e.jsx(A,{color:"success",className:"m-3",children:n}),e.jsx(oe,{children:e.jsxs(ne,{noValidate:!0,validated:g,children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:b,value:o.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name.",feedbackValid:"Looks good!"}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:b,value:o.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address.",feedbackValid:"Looks good!"})]})}),e.jsxs(re,{children:[e.jsx(E,{color:"secondary",variant:"outline",disabled:m,onClick:()=>{u(!1),l(null),t(!1)},children:m?e.jsx(k,{size:"sm",color:"secondary"}):"Cancel"}),e.jsx(E,{color:"primary",variant:"outline",disabled:m,onClick:w,children:m?e.jsx(k,{size:"sm",color:"success"}):"Update"})]})]})]})},_e=({warehouseLoc:a,loading:C,error:y,onDeleteWarehouseLoc:u,onUpdateWarehouseLoc:g})=>{const[t,m]=s.useState(""),[f,h]=s.useState([]),[l,n]=s.useState(1),[i,o]=s.useState(null),v=10,b=JSON.parse(sessionStorage.getItem("user")),w=["manager","admin"],p="admin";if(s.useEffect(()=>{h(a)},[a]),s.useEffect(()=>{if(t==="")h(a);else{const r=a.filter(N=>{const S=N.warehouseName.toLowerCase().includes(t.toLowerCase()),O=N.address.toLowerCase().includes(t.toLowerCase()),V=w.includes(b.data.user.role)&&N.createdBy.toLowerCase().includes(t.toLowerCase());return S||O||V});h(r),n(1),r.length===0?o("No results found"):o(null)}},[t,a]),a.length===0)return e.jsx(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:"No Warehouse Location Found"});const P=r=>{m(r.target.value)},x=l*v,j=x-v,c=f.slice(j,x),W=Math.ceil(f.length/v);return e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"m-3",children:e.jsxs(ve,{className:"w-50 mb-3",children:[e.jsx(R,{type:"text",id:"search",value:t,onChange:P,placeholder:"Search Warehouse Location..."}),e.jsx(Ne,{children:e.jsx(z,{icon:be})})]})}),e.jsxs(we,{children:[e.jsx(ee,{children:"Warehouse Location List"}),e.jsxs(Pe,{className:"md-3",children:[e.jsxs(Se,{bordered:!0,hover:!0,responsive:!0,className:"mx-auto ",children:[e.jsx(Le,{className:"text-center  ",children:e.jsxs(Z,{children:[e.jsx(D,{className:"fixed-width bg-secondary",children:"Warehouse Name"}),e.jsx(D,{className:"fixed-width bg-secondary",children:"Address"}),p.includes(b.data.user.role)&&e.jsx(D,{className:"fixed-width bg-secondary",children:"Created By"}),e.jsx(D,{className:"fixed-width bg-secondary",children:"Actions"})]})}),e.jsx(ke,{className:"text-center",children:c.map(r=>e.jsxs(Z,{children:[e.jsx(H,{className:"fixed-width",children:e.jsx(F,{content:r.warehouseName,children:e.jsx("span",{children:r.warehouseName})})}),e.jsx(H,{className:"fixed-width",children:e.jsx(F,{content:r.address,children:e.jsx("span",{children:r.address})})}),p.includes(b.data.user.role)&&e.jsx(H,{className:"fixed-width",color:"danger",children:e.jsx(F,{content:r.createdBy,children:e.jsx("span",{children:r.createdBy})})}),e.jsxs(H,{className:"fixed-width",children:[e.jsx(He,{warehouseLoc:r,onUpdateWarehouseLoc:g}),w.includes(b.data.user.role)&&e.jsx(Me,{warehouseLoc:r,onDeleteWarehouseLoc:u})]})]},r._id))})]}),i&&e.jsx(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:i}),e.jsxs(Ae,{align:"center",children:[e.jsx(q,{disabled:l===1,onClick:()=>n(r=>Math.max(r-1,1)),children:"Previous"}),[...Array(W).keys()].map(r=>e.jsx(q,{active:r+1===l,onClick:()=>n(r+1),children:r+1},r+1)),e.jsx(q,{disabled:l===W,onClick:()=>n(r=>Math.min(r+1,W)),children:"Next"})]})]})]})]})},ze="http://localhost:5057",Oe=_.create({baseURL:ze}),cs=()=>{const[a,C]=s.useState([]),[y,u]=s.useState(!1),[g,t]=s.useState(null),m=async()=>{var n,i;u(!0);try{const o=await Oe.get("/api/v1/warehouseLoc/locations");o.status===200?C(o.data.data):t(o.data.message)}catch(o){t(((i=(n=o.response)==null?void 0:n.data)==null?void 0:i.message)||o.message)}finally{u(!1)}};s.useEffect(()=>{m()},[]);const f=n=>{C(i=>[...i,n])},h=n=>{C(i=>i.filter(o=>o._id!==n))},l=n=>{C(i=>i.map(o=>o._id===n._id?n:o))};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{children:"Warehouse location"}),e.jsx(Re,{onAddWarehouseLoc:f}),e.jsx(_e,{warehouseLoc:a,loading:y,error:g,onDeleteWarehouseLoc:h,onUpdateWarehouseLoc:l})]})};export{cs as default};
