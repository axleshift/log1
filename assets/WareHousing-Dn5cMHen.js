import{A as ne,r as o,j as e,k as G,m as z,B as we}from"./index-DwEpwQkd.js";import{F as J,q as ye,g as Ce,e as oe,n as Se,a as he}from"./index-CBysYF3q.js";import{C as W}from"./CAlert-BYJTChjp.js";import{a as Q}from"./CButton-1cEyYVdP.js";import{C as xe,a as fe,b as je,c as pe,d as ge}from"./CModalTitle-Crd8ywd8.js";import{C as be}from"./CForm-CKo8nSZ2.js";import{C as Ne}from"./CFormSelect-D9Q-6F_i.js";import{C as V}from"./CContainer-tjMg1ou8.js";import{C as $}from"./CInputGroup-BBuIvPgV.js";import{C as R}from"./CFormInput-BDpZDJla.js";import{C as ce}from"./CInputGroupText-BfhxnWZA.js";import{C as De,a as Ie,b as Le,c as Pe}from"./CAccordionHeader-BhTj2zYa.js";import{C as Y,a as ee,b as U,c as y,d as se,e as C}from"./CTable-CIXwa7nA.js";import{C as de,a as M}from"./CPaginationItem-BHsjAp5g.js";import{C as Te}from"./CFormTextarea-Bb9Xkq1H.js";import{C as te,a as Ae}from"./DefaultLayout-CqzLKksW.js";import{C as qe,a as Ee,b as re,c as ae}from"./CTabList-BlrsBJD6.js";import{C as me}from"./CCard-AiIHjJ6O.js";import"./index.esm-D5Uk_8wB.js";import"./1-GYI0lUoc.js";import"./cil-user-Ddrdy7PS.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const ke=({warehousing:x,onDeleteItem:n})=>{const{showError:T,showSuccess:g}=ne(),[b,i]=o.useState(null),[L,D]=o.useState(!1),S=async()=>{D(!0);const h=await z.delete(`/api/v1/warehouse/delete/${x._id}`);h.data.success?(g(h.data.message),n(x._id),D(!1)):(D(!1),i(h.data.message),T(h.data.message))};return b?e.jsxs(W,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",b.message]}):e.jsx(e.Fragment,{children:e.jsx(Q,{color:"danger",variant:"outline",onClick:S,className:"me-2",children:L?e.jsx(G,{size:"sm"}):e.jsx(J,{icon:ye})})})},Re=({warehousing:x,onUpdateItem:n})=>{const{showSuccess:T,showErrors:g}=ne(),[b,i]=o.useState(null),[L,D]=o.useState(!1),[S,h]=o.useState(null),[I,N]=o.useState(!1),[A,k]=o.useState([]),[l,t]=o.useState({warehouse:x.warehouse||"",warehouseLocDetails:{warehouseName:x.warehouseName||"",address:x.address||""},byReceived:""});o.useEffect(()=>{(async()=>{try{const a=await z.get("/api/v1/warehouseLoc/locations");k(a.data.data)}catch(a){i(a.response.data.message),g(a.response.data.message)}})()},[]);const m=v=>{const a=v.target.value,j=A.find(s=>s._id===a);t(s=>({...s,warehouse:a,warehouseLocDetails:{warehouseName:j?j.warehouseName:"",address:j?j.address:""}}))},O=async v=>{v.preventDefault();const j=JSON.parse(sessionStorage.getItem("user")).email;if(!j){i("User email not found. Please log in again.");return}const s=A.find(d=>d._id===l.warehouse);if(!s){i("Warehouse not found.");return}l.warehouseLocDetails={warehouseName:s.warehouseName,address:s.address},D(!0);try{const d=await z.patch(`/api/v1/warehouse/update/${x._id}`,{...l,byReceived:j});if(d.data.success){const r=d.data.data,q=A.find(f=>f._id===r.warehouse);r.warehouse=q,T(d.data.message),n(d.data.data),setTimeout(()=>{h(null),N(!1)},2e3)}}catch(d){i(d.response.data.message),g(d.response.data.message),setTimeout(()=>{i(null)},2e3)}D(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{color:"primary",variant:"outline",className:"me-2",onClick:()=>N(!0),children:L?e.jsx(G,{size:"sm"}):e.jsx(J,{icon:Ce})}),e.jsxs(xe,{visible:I,onClose:()=>N(!1),children:[e.jsx(fe,{children:e.jsx(je,{children:"Recieved Items"})}),b&&e.jsx(W,{color:"danger",children:b}),S&&e.jsx(W,{color:"success",children:S}),e.jsx(pe,{children:e.jsx(be,{children:e.jsxs(Ne,{id:"warehouse",floatingLabel:"Warehouse",className:"mb-3",value:l.warehouse,onChange:m,required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),A.map(v=>e.jsxs("option",{value:v._id,children:[v.warehouseName," - ",v.address]},v._id))]})})}),e.jsxs(ge,{children:[e.jsx(Q,{color:"secondary",variant:"outline",onClick:()=>N(!1),children:"Close"}),e.jsx(Q,{color:"primary",variant:"outline",onClick:O,children:"Update Item"})]})]})]})},We=({warehousing:x,loading:n,error:T,onDeleteItem:g,onUpdateItem:b})=>{const[i,L]=o.useState([]),[D,S]=o.useState(null),[h,I]=o.useState(""),N=we(),A=["manager","admin"],[k,l]=o.useState(1),[t]=o.useState(10),m=k*t,O=m-t,v=i.slice(O,m),a=Math.ceil(i.length/t);o.useEffect(()=>{try{if(h===""){L(x),S(null);return}const s=h.toLowerCase().trim(),d=x.filter(r=>{var q,f,_,Z,u,c,p,w,P,F,B,E,H,X;try{return((q=r.poNumber)==null?void 0:q.toLowerCase().includes(s))||((_=(f=r.warehouseLocDetails)==null?void 0:f.warehouseName)==null?void 0:_.toLowerCase().includes(s))||((u=(Z=r.warehouseLocDetails)==null?void 0:Z.address)==null?void 0:u.toLowerCase().includes(s))||((p=(c=r.vendor)==null?void 0:c.businessName)==null?void 0:p.toLowerCase().includes(s))||((P=(w=r.vendor)==null?void 0:w.businessAddress)==null?void 0:P.toLowerCase().includes(s))||((B=(F=r.vendor)==null?void 0:F.contactNumber)==null?void 0:B.includes(s))||r.orderDate&&new Date(r.orderDate).toLocaleDateString().includes(s)||r.dateOfReceived&&new Date(r.receiveDate).toLocaleDateString().includes(s)||(((H=(E=r.byReceived)==null?void 0:E.toString().toLowerCase())==null?void 0:H.includes(s))??!1)||((X=r.details)==null?void 0:X.some(K=>{var ie,le,ue;return((ie=K.description)==null?void 0:ie.toLowerCase().includes(s))||((le=K.quantity)==null?void 0:le.toString().includes(s))||((ue=K.unitPrice)==null?void 0:ue.toString().includes(s))}))}catch(K){return console.error("Error filtering item:",K),!1}});L(d),l(1),d.length===0?S("No data found"):S(null)}catch(s){console.error("Error in search effect:",s),S("Error occurred while searching")}},[h,x]);const j=s=>{I(s.target.value)};return n?e.jsx(G,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):x.length===0?e.jsx(W,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mt-3",children:e.jsxs($,{className:"w-50 mb-3",children:[e.jsx(R,{type:"text",placeholder:"Search by PO Number, Vendor, or Products...",value:h,id:"searchItem",onChange:j}),e.jsx(ce,{children:e.jsx(J,{icon:oe})})]})}),n?e.jsx(G,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):x.length===0?e.jsx(W,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[D&&e.jsx(W,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:D}),e.jsx(De,{className:"m-2",children:v.map(s=>e.jsxs(Ie,{children:[e.jsx(Le,{children:e.jsxs("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[e.jsx("div",{children:e.jsxs("ul",{className:"list-unstyled",children:[e.jsxs("li",{children:["PO Number: ",e.jsx("strong",{children:s.poNumber})]}),e.jsxs("li",{children:["Warehuse Location: ",e.jsx("strong",{children:s.warehouse.warehouseName})]})]})}),e.jsxs("div",{className:"text-medium-emphasis",children:["Order Date: ",new Date(s.orderDate).toLocaleDateString()]})]})}),e.jsxs(Pe,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Vendor Information"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",s.vendor.businessName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",s.vendor.businessAddress]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"})," ",s.vendor.contactNumber]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Shipping Details"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Carrier:"})," ",s.carrier]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Receive Date:"})," ",new Date(s.receiveDate).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Products"}),e.jsxs(Y,{responsive:!0,small:!0,className:"mt-2",children:[e.jsx(ee,{children:e.jsxs(U,{children:[e.jsx(y,{children:"Description"}),e.jsx(y,{children:"Quantity"}),e.jsx(y,{children:"Received By"}),e.jsx(y,{children:"Received Date"})]})}),e.jsx(se,{children:s.details.map((d,r)=>e.jsxs(U,{children:[e.jsx(C,{children:d.description}),e.jsx(C,{children:d.quantity}),e.jsx(C,{children:s.byReceived}),e.jsx(C,{children:s.dateOfReceived?new Date(s.dateOfReceived).toLocaleDateString():"N/A"})]},r))})]})]}),s.additionalNotes&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Additional Notes"}),e.jsx("div",{className:"ms-3",children:s.additionalNotes})]}),e.jsxs(V,{className:"d-flex justify-content-end mt-3",children:[e.jsx(Re,{warehousing:s,onUpdateItem:b}),A.includes(N)&&e.jsx(ke,{warehousing:s,onDeleteItem:g})]})]})]},s._id))}),i.length>0&&e.jsxs(V,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:["Showing ",O+1," to"," ",Math.min(m,i.length)," of"," ",i.length," entries"]}),e.jsxs(de,{className:"mt-3",children:[e.jsx(M,{disabled:k===1,onClick:()=>l(s=>Math.max(s-1,1)),children:"Previous"}),Array.from({length:a},(s,d)=>d+1).map(s=>e.jsx(M,{active:s===k,onClick:()=>l(s),children:s},s)),e.jsx(M,{disabled:k===a,onClick:()=>l(s=>Math.min(s+1,a)),children:"Next"})]})]})]})]})},Fe=({onAddItem:x,item:n={}})=>{var r,q,f,_,Z;const{showSuccess:T,showError:g}=ne(),[b,i]=o.useState("Add Item"),[L,D]=o.useState(!1),[S,h]=o.useState(!1),[I,N]=o.useState(""),[A,k]=o.useState([]),l=new Date().toISOString().split("T")[0],[t,m]=o.useState({poNumber:n.poNumber||"",orderDate:n.orderDate||l,receiveDate:n.receiveDate||l,carrier:n.carrier||"",vendor:{businessName:((r=n==null?void 0:n.vendor)==null?void 0:r.businessName)||"",businessAddress:((q=n==null?void 0:n.vendor)==null?void 0:q.businessAddress)||"",contactNumber:((f=n==null?void 0:n.vendor)==null?void 0:f.contactNumber)||""},warehouse:n.warehouse||"",warehouseLocDetails:{warehouseName:((_=n==null?void 0:n.warehouseLocDetails)==null?void 0:_.warehouseName)||"",address:((Z=n==null?void 0:n.warehouseLocDetails)==null?void 0:Z.address)||""},details:n.details||[{productId:"",description:"",quantity:""}],procurementId:n.procurementId||"",rfqId:n.rfqId||null,vendorId:n.vendorId||"",additionalNotes:n.additionalNotes||"",byReceived:"",dateOfReceived:""});o.useEffect(()=>{console.log("Current formData:",t)},[t]);const O=u=>{const c=u.target.value,p=A.find(w=>w._id===c);m(w=>({...w,warehouse:c,warehouseLocDetails:{warehouseName:p?p.warehouseName:"",address:p?p.address:""}}))},v=(u,c,p)=>{m(w=>{const P=[...w.details];return P[u]={...P[u],[c]:p,...c==="quantity"||c==="unitPrice"?{subTotal:Number(c==="quantity"?p:P[u].quantity)*Number(c==="unitPrice"?p:P[u].unitPrice)}:{}},{...w,details:P}})},a=u=>{const{id:c,value:p}=u.target;if(c.includes(".")){const[w,P]=c.split(".");m(F=>({...F,[w]:{...F[w],[P]:p}}))}else m(w=>({...w,[c]:p}))},j=async u=>{try{return(await z.get(`/api/v1/warehouse/checkPoNumber/${u}`)).data.exists}catch(c){return console.error(c),!1}};o.useEffect(()=>{(async()=>{await j(n.poNumber)&&i("Already Added")})()},[n.poNumber]),o.useEffect(()=>{(async()=>{try{const c=await z.get("/api/v1/warehouseLoc/locations");k(c.data.data)}catch(c){N(c.response.data.message),g(c.response.data.message)}})()},[]);const s=()=>t.warehouse?!t.warehouseLocDetails.warehouseName||!t.warehouseLocDetails.address?(N("Warehouse location details are incomplete"),!1):!0:(N("Please select a warehouse"),!1),d=async u=>{var w,P,F,B;if(u.preventDefault(),!s())return;const p=JSON.parse(sessionStorage.getItem("user")).email;if(!p){N("User email not found. Please log in again.");return}if(!t.warehouse){N("Please select a warehouse");return}try{const E=A.find(K=>K._id===t.warehouse);if(!E){N("Selected warehouse not found");return}const H={...t,byReceived:p,dateOfReceived:new Date().toISOString().split("T")[0],warehouse:t.warehouse,warehouseLocDetails:{warehouseName:E.warehouseName,address:E.address}},X=await z.post("/api/v1/warehouse/addItem",H);X.data.success&&(x(X.data.data),h(!1),T("Item added successfully"),i("Already Added"))}catch(E){console.error("Error submitting form:",E),N(((P=(w=E.response)==null?void 0:w.data)==null?void 0:P.message)||"Error adding item"),g(((B=(F=E.response)==null?void 0:F.data)==null?void 0:B.message)||"Error adding item")}};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{color:"primary",variant:"outline",onClick:()=>h(!0),disabled:b==="Already Added",children:b==="Already Added"?e.jsx("span",{className:"me-1",children:"Already Added"}):e.jsx(J,{icon:Se})}),e.jsxs(xe,{visible:S,onClose:()=>h(!1),size:"lg",children:[e.jsx(fe,{children:e.jsx(je,{children:"Add Receiving Item"})}),I&&e.jsx(W,{color:"danger",children:I}),L&&e.jsx(W,{color:"success",children:L}),e.jsx(pe,{children:e.jsxs(be,{children:[e.jsxs($,{className:"mb-3",children:[e.jsx(R,{type:"text",id:"poNumber",floatingLabel:"PO Number",className:"mb-3",value:t.poNumber,onChange:a,required:!0,disabled:!0}),e.jsx(R,{type:"date",id:"orderDate",floatingLabel:"Order Date",className:"mb-3",value:t.orderDate.split("T")[0],onChange:a,required:!0,disabled:!0}),e.jsx(R,{type:"date",id:"receiveDate",floatingLabel:"Date to Receive",className:"mb-3",value:t.receiveDate.split("T")[0],onChange:a,required:!0,disabled:!0})]}),e.jsx(R,{type:"text",id:"vendor.businessName",floatingLabel:"Vendor Business Name",className:"mb-3",value:t.vendor.businessName,onChange:a,required:!0,disabled:!0}),e.jsx($,{className:"mb-3",children:e.jsx(R,{type:"text",id:"vendor.businessAddress",floatingLabel:"Vendor Address",className:"mb-3",value:t.vendor.businessAddress,onChange:a,required:!0,disabled:!0})}),e.jsxs($,{className:"mb-3",children:[e.jsx(R,{type:"text",id:"vendor.contactNumber",floatingLabel:"Vendor Contact Number",className:"mb-3",value:t.vendor.contactNumber,onChange:a,required:!0,disabled:!0}),e.jsx(R,{type:"text",id:"carrier",floatingLabel:"Carrier",className:"mb-3",value:t.carrier,onChange:a,required:!0,disabled:!0})]}),e.jsx(Te,{id:"additionalNotes",floatingLabel:"Additional Notes",className:"mb-3",value:t.additionalNotes,onChange:a,rows:3,disabled:!0}),e.jsxs("div",{className:"mb-3",children:[e.jsx(te,{children:"Product Details"}),e.jsxs(Y,{responsive:!0,children:[e.jsx(ee,{children:e.jsxs(U,{children:[e.jsx(y,{children:"Description"}),e.jsx(y,{children:"Quantity"}),e.jsx(y,{children:"Unit Price "})]})}),e.jsx(se,{children:t.details.map((u,c)=>e.jsxs(U,{children:[e.jsx(C,{children:e.jsx(R,{type:"text",id:"description",value:u.description,onChange:p=>v(c,"description",p.target.value),placeholder:"Product description",disabled:!0})}),e.jsx(C,{children:e.jsx(R,{type:"number",id:"quantity",value:u.quantity,onChange:p=>v(c,"quantity",p.target.value),placeholder:"Qty",disabled:!0})}),e.jsx(C,{children:e.jsx(Q,{color:"danger",size:"sm",onClick:()=>removeProductRow(c),disabled:t.details.length===1,children:"Remove"})})]},c))})]})]}),e.jsxs(Ne,{id:"warehouse",floatingLabel:"Warehouse",className:"mb-3",value:t.warehouse,onChange:O,required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),A.map(u=>e.jsxs("option",{value:u._id,children:[u.warehouseName," - ",u.address]},u._id))]})]})}),e.jsxs(ge,{children:[e.jsx(Q,{color:"secondary",onClick:()=>h(!1),children:"Close"}),e.jsx(Q,{color:"primary",onClick:d,children:"Save"})]})]})]})},Oe=({onAddItem:x})=>{const[n,T]=o.useState([]),[g,b]=o.useState(1),[i,L]=o.useState(null),[D,S]=o.useState(!0),[h,I]=o.useState(""),[N,A]=o.useState([]),[k,l]=o.useState(!1),t=10,[m,O]=o.useState([{_id:"605c72ef1532071b7f1a2c3d",poNumber:"PO12345",orderDate:"2025-03-01T00:00:00.000Z",receiveDate:"2025-03-05T00:00:00.000Z",carrier:"UPS",vendor:{businessName:"Vendor ABC",businessAddress:"123 Vendor St, Vendor City, VC",contactNumber:"123-456-7890"},shipTo:"605c72ef1532071b7f1a2c3e",details:[{productId:"605c72ef1532071b7f1a2c3f",description:"Product 1",quantity:10,unitPrice:50,subTotal:500},{productId:"605c72ef1532071b7f1a2c40",description:"Product 2",quantity:5,unitPrice:25,subTotal:125}],procurementId:"605c72ef1532071b7f1a2c41",rfqId:null,vendorId:"605c72ef1532071b7f1a2c42",additionalNotes:"Urgent delivery needed.",createdAt:"2025-03-01T00:00:00.000Z",updatedAt:"2025-03-01T00:00:00.000Z"},{_id:"605c72ef1532071b7f1a2c44",poNumber:"PO12346",orderDate:"2025-03-02T00:00:00.000Z",receiveDate:"2025-03-06T00:00:00.000Z",carrier:"FedEx",vendor:{businessName:"Vendor XYZ",businessAddress:"456 Vendor Rd, Vendor Town, VT",contactNumber:"987-654-3210"},shipTo:"605c72ef1532071b7f1a2c45",details:[{productId:"605c72ef1532071b7f1a2c46",description:"Product 3",quantity:20,unitPrice:30,subTotal:600},{productId:"605c72ef1532071b7f1a2c47",description:"Product 4",quantity:15,unitPrice:40,subTotal:600}],procurementId:"605c72ef1532071b7f1a2c48",rfqId:"605c72ef1532071b7f1a2c49",vendorId:"605c72ef1532071b7f1a2c4a",additionalNotes:"Handle with care.",createdAt:"2025-03-02T00:00:00.000Z",updatedAt:"2025-03-02T00:00:00.000Z"},{_id:"605c72ef1532071b7f1a2c4b",poNumber:"PO12347",orderDate:"2025-03-03T00:00:00.000Z",receiveDate:"2025-03-07T00:00:00.000Z",carrier:"DHL",vendor:{businessName:"Vendor LMN",businessAddress:"789 Vendor Blvd, Vendorville, VV",contactNumber:"555-123-4567"},shipTo:"605c72ef1532071b7f1a2c4c",details:[{productId:"605c72ef1532071b7f1a2c4d",description:"Product 5",quantity:25,unitPrice:10,subTotal:250},{productId:"605c72ef1532071b7f1a2c4e",description:"Product 6",quantity:10,unitPrice:15,subTotal:150}],procurementId:"605c72ef1532071b7f1a2c4f",rfqId:"605c72ef1532071b7f1a2c50",vendorId:"605c72ef1532071b7f1a2c51",additionalNotes:"Includes free shipping.",createdAt:"2025-03-03T00:00:00.000Z",updatedAt:"2025-03-03T00:00:00.000Z"}]);if(o.useEffect(()=>{T(m),S(!1)},[]),o.useEffect(()=>{if(h===""){T(m);return}const r=h.toLowerCase().trim(),q=m.filter(f=>{var _,Z,u,c,p,w,P,F,B;try{return((_=f.poNumber)==null?void 0:_.toLowerCase().includes(r))||((u=(Z=f.vendor)==null?void 0:Z.businessName)==null?void 0:u.toLowerCase().includes(r))||((p=(c=f.vendor)==null?void 0:c.businessAddress)==null?void 0:p.toLowerCase().includes(r))||((P=(w=f.vendor)==null?void 0:w.contactNumber)==null?void 0:P.toLowerCase().includes(r))||((F=f.carrier)==null?void 0:F.toLowerCase().includes(r))||f.orderDate&&new Date(f.orderDate).toLocaleDateString().includes(r)||f.receiveDate&&new Date(f.receiveDate).toLocaleDateString().includes(r)||((B=f.details)==null?void 0:B.some(E=>{var H;return(H=E.description)==null?void 0:H.toLowerCase().includes(r)}))}catch(E){return console.error("Error filtering data:",E),!1}});T(q),b(1),L(q.length===0?"No results found":null)},[h]),D)return e.jsx(G,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"});const v=g*t,a=v-t,j=n.slice(a,v),s=Math.ceil(n.length/t),d=r=>{I(r.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mt-3",children:e.jsxs($,{className:"w-50 mb-3",children:[e.jsx(R,{type:"text",placeholder:"Search by PO Number, Supplier, or Item Name",value:h,id:"searchInput",onChange:d}),e.jsx(ce,{children:e.jsx(J,{icon:oe})})]})}),e.jsxs(Y,{hover:!0,responsive:!0,children:[e.jsx(ee,{children:e.jsxs(U,{children:[e.jsx(y,{children:"PO Number"}),e.jsx(y,{children:"Order Date"}),e.jsx(y,{children:"Date to Receive"}),e.jsx(y,{children:"Carrier"}),e.jsx(y,{children:"Vendor"}),e.jsx(y,{children:"Products"}),e.jsx(y,{children:"Total Amount"}),e.jsx(y,{children:"Notes"}),e.jsx(y,{children:"Actions"})]})}),e.jsx(se,{children:j.map(r=>{const q=r.details.reduce((f,_)=>f+_.subTotal,0);return e.jsxs(U,{children:[e.jsx(C,{children:r.poNumber}),e.jsx(C,{children:new Date(r.orderDate).toLocaleDateString()}),e.jsx(C,{children:new Date(r.receiveDate).toLocaleDateString()}),e.jsx(C,{children:r.carrier}),e.jsxs(C,{children:[e.jsx("div",{children:r.vendor.businessName}),e.jsx("small",{className:"text-medium-emphasis",children:r.vendor.contactNumber})]}),e.jsx(C,{children:r.details.map(f=>e.jsxs("div",{children:[f.description," ( pcs: ",f.quantity," x ",f.unitPrice.toFixed(2)," ",")"]},f.productId))}),e.jsx(C,{children:q.toFixed(2)}),e.jsx(C,{children:r.additionalNotes}),e.jsx(C,{children:e.jsx(Fe,{item:r,onAddItem:x,mockDataReiceving:m})})]},r._id)})})]}),n.length>0&&e.jsxs(V,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(V,{children:["Showing ",a+1," to ",Math.min(v,n.length)," of"," ",n.length," entries"]}),e.jsxs(de,{className:"mt-3",children:[e.jsx(M,{disabled:g===1,onClick:()=>b(r=>Math.max(r-1,1)),children:"Previous"}),[...Array(s).keys()].map(r=>e.jsx(M,{active:r+1===g,onClick:()=>b(r+1),children:r+1},r+1)),e.jsx(M,{disabled:g===s,onClick:()=>b(r=>Math.min(r+1,s)),children:"Next"})]})]}),i&&e.jsx(W,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:i})]})},_e=({items:x,loading:n,error:T})=>{const[g,b]=o.useState([]),[i,L]=o.useState(""),[D,S]=o.useState(null),h=10,[I,N]=o.useState(1),A=a=>{switch(a){case"Stocked":return"success";case"Out of Stock":return"danger";default:return"secondary"}};o.useEffect(()=>{b(x)},[x]),o.useEffect(()=>{if(i==="")b(x),S(null);else{const a=x.filter(j=>{const s=j.itemName.toLowerCase().includes(i.toLowerCase()),d=j.locations.some(r=>{const q=r.warehouse;return q.warehouseName.toLowerCase().includes(i.toLowerCase())||q.address.toLowerCase().includes(i.toLowerCase())});return s||d});b(a),N(1),a.length===0?S("No results found"):S(null)}},[i,x]);const k=a=>{L(a.target.value)},l=a=>{if(!a||!Array.isArray(a))return[];const j=new Map;return a.forEach(s=>{if(!(s!=null&&s.warehouse))return;const d=s.warehouse._id||"deleted";if(!j.has(d))j.set(d,{warehouse:{...s.warehouse,deleted:s.warehouse.deleted||!s.warehouse._id},quantity:s.quantity||0});else{const r=j.get(d);r.quantity+=s.quantity||0,j.set(d,r)}}),Array.from(j.values())};if(n)return e.jsx(G,{color:"primary",className:"text-center mt-5 w-75 mx-auto justify-content-center"});if(T)return e.jsxs(W,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:["Error: ",T]});const t=I*h,m=t-h,O=g.slice(m,t),v=Math.ceil(g.length/h);return e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"m-3",children:e.jsxs($,{className:"w-50 mb-3",children:[e.jsx(R,{type:"text",id:"search",value:i,onChange:k,placeholder:"Search by item name or warehouse..."}),e.jsx(ce,{children:e.jsx(J,{icon:oe})})]})}),e.jsxs("strong",{className:"m-3 align-self-start",children:["Total Items: ",O.length]}),D?e.jsx(W,{color:"warning",children:D}):e.jsxs(Y,{hover:!0,responsive:!0,striped:!0,className:"text-center",children:[e.jsx(ee,{children:e.jsxs(U,{children:[e.jsx(y,{scope:"col",children:"Item Name"}),e.jsx(y,{scope:"col",children:"Total Quantity"}),e.jsx(y,{scope:"col",children:"Warehouse Locations"}),e.jsx(y,{scope:"col",children:"Status"})]})}),e.jsx(se,{children:O.map((a,j)=>e.jsxs(U,{children:[e.jsx(C,{children:a.itemName}),e.jsx(C,{children:e.jsx("strong",{children:a.quantity})}),e.jsx(C,{children:e.jsx(V,{className:"locations-list",children:l(a.locations).map((s,d)=>{const r=s.warehouse;return e.jsx(V,{className:"location-item",children:e.jsxs(V,{className:"location-details",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"warehouse-name",children:(r==null?void 0:r.warehouseName)||"Unknown Warehouse"}),e.jsx(he,{color:r!=null&&r.deleted?"danger":"success",className:"ms-2",children:r!=null&&r.deleted?"Deleted":"Active"})]}),e.jsx("span",{className:"warehouse-address",children:(r==null?void 0:r.address)||"No address available"}),e.jsxs("span",{className:"quantity-badge",children:["Qty: ",s.quantity]})]})},(r==null?void 0:r._id)||`deleted-${d}`)})})}),e.jsx(C,{children:e.jsx(he,{color:A(a.status||(a.quantity>0?"Stocked":"Out of Stock")),children:a.status||(a.quantity>0?"Stocked":"Out of Stock")})})]},a._id||j))})]}),g.length===0&&!D&&e.jsx(W,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No items found."}),e.jsxs(de,{align:"center",children:[e.jsx(M,{disabled:I===1,onClick:()=>N(a=>Math.max(a-1,1)),children:"Previous"}),[...Array(v).keys()].map(a=>e.jsx(M,{active:a+1===I,onClick:()=>N(a+1),children:a+1},a+1)),e.jsx(M,{disabled:I===v,onClick:()=>N(a=>Math.min(a+1,v)),children:"Next"})]})]})},Ve=`
  .locations-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .location-item {
    display: flex;
    flex-direction: column;
    padding: 8px;
    background-color: #f8f9fa;
    border-radius: 4px;
    width: fit-content;

  }

  .location-details {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
  }

  .warehouse-name {
    font-weight: 500;
    color: #495057;
  }

  .warehouse-address {
    color: #6c757d;
    font-size: 0.9em;
    font-style: italic;
  }

  .quantity-badge {
    background-color: #e9ecef;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.85em;
    color: #495057;
  }

`,ve=document.createElement("style");ve.innerText=Ve;document.head.appendChild(ve);const is=()=>{const[x,n]=o.useState([]),[T,g]=o.useState([]),[b,i]=o.useState(!1),[L,D]=o.useState(null),[S,h]=o.useState(0);o.useEffect(()=>{(async()=>{i(!0);try{const t=await z.get("/api/v1/warehouse/items");n(t.data.data),g(t.data.data)}catch(t){D(t.message)}finally{i(!1)}})()},[S]);const I=()=>{h(l=>l+1)},N=l=>{n(t=>[...t,l]),g(t=>[...t,l]),I()},A=l=>{n(t=>t.filter(m=>m._id!==l)),g(t=>t.filter(m=>m._id!==l)),I()},k=l=>{n(t=>t.map(m=>m._id===l._id?l:m)),g(t=>t.map(m=>m._id===l._id?l:m)),I()};return e.jsx(e.Fragment,{children:e.jsxs(qe,{activeItemKey:"Warehouse Items Details",children:[e.jsxs(Ee,{variant:"tabs",children:[e.jsx(re,{itemKey:"Warehouse Items Details",children:"Warehouse Items Details"}),e.jsx(re,{itemKey:"For Reiceve",children:"For Reiceve"}),e.jsx(re,{itemKey:"Items",children:"Items"})]}),e.jsxs(Ae,{children:[e.jsx(ae,{className:"p-3",itemKey:"Warehouse Items Details",children:e.jsx(We,{warehousing:x,loading:b,error:L,onDeleteItem:A,onUpdateItem:k})}),e.jsx(ae,{className:"p-3",itemKey:"For Reiceve",children:e.jsxs(me,{children:[e.jsx(te,{children:"Item Reicevig"}),e.jsx(Oe,{onAddItem:N})]})}),e.jsx(ae,{className:"p-3",itemKey:"Items",children:e.jsxs(me,{children:[e.jsx(te,{children:"Items"}),e.jsx(_e,{items:T,loading:b,error:L})]})})]})]})})};export{is as default};
