import{r as s,_ as q,R as N,a as A,c as G,P as n,b as O,i as _,k as D,j as e,C as z}from"./index-BCHpP1Uc.js";import{C as M,a as T}from"./index.esm-28M6jHFB.js";import{C as J}from"./CRow-EK1qN6Yo.js";import{C as V}from"./CCol-t2wevxBS.js";import{C as H,a as K}from"./CCardBody-BHc6PLGJ.js";import{C as Q}from"./CForm-DNuXigBn.js";import{u as W,T as X,C as Y}from"./CCloseButton-pGLEioBo.js";import{C as x,a as j}from"./CInputGroupText-BHH8LoGu.js";import{c as Z}from"./cil-user-Ddrdy7PS.js";import{C as S}from"./CFormInput-DbViDoz2.js";import{c as k}from"./cil-lock-locked-DmxpJbVL.js";import{C as $}from"./CFormSelect-K8UhKfMF.js";import{a as P}from"./CButton-TP2x1vuU.js";var E=s.forwardRef(function(t,g){var b=t.children,v=t.className,c=t.color,d=c===void 0?"primary":c,o=t.dismissible,y=t.variant,m=t.visible,i=m===void 0?!0:m,R=t.onClose,w=q(t,["children","className","color","dismissible","variant","visible","onClose"]),u=s.useRef(null),p=W(g,u),h=s.useState(i),f=h[0],a=h[1];return s.useEffect(function(){a(i)},[i]),N.createElement(X,{in:f,mountOnEnter:!0,nodeRef:u,onExit:R,timeout:150,unmountOnExit:!0},function(C){return N.createElement("div",A({className:G("alert",y==="solid"?"bg-".concat(d," text-white"):"alert-".concat(d),{"alert-dismissible fade":o,show:C==="entered"},v),role:"alert"},w,{ref:p}),b,o&&N.createElement(Y,{onClick:function(){return a(!1)}}))})});E.propTypes={children:n.node,className:n.string,color:O.isRequired,dismissible:n.bool,onClose:n.func,variant:n.string,visible:n.bool};E.displayName="CAlert";const pe=()=>{const t=_(),g=D(),[b,v]=s.useState(""),[c,d]=s.useState(""),[o,y]=s.useState(""),[m,i]=s.useState(""),[R,w]=s.useState("user"),[u,p]=s.useState(null),[h,f]=s.useState(null),[a,C]=s.useState(!1),I=()=>{v(""),d(""),y(""),i(""),w("user")},U=async r=>{if(r.preventDefault(),p(null),f(null),C(!0),o!==m){p("Passwords don't match"),C(!1);return}try{const l=await fetch("/api/user/register",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("accessToken")},body:JSON.stringify({username:b,email:c,password:o,role:R})});if(!l.ok){const L=await l.json();throw new Error(L.message||"Registration failed")}const B=await l.json();g({type:"REGISTER_SUCCESS",payload:B}),I(),f("User registered successfully!"),setTimeout(()=>{f(null)},3e3)}catch(l){p(l.message),g({type:"REGISTER_FAILURE",payload:l.message})}finally{C(!1)}},F=()=>{t("/dashboard")};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(M,{children:e.jsx(J,{className:"justify-content-center",children:e.jsx(V,{md:9,lg:7,xl:6,children:e.jsx(H,{className:"mx-4",children:e.jsx(K,{className:"p-4",children:e.jsxs(Q,{onSubmit:U,children:[e.jsx("h1",{children:"Register New User"}),u&&e.jsx(E,{color:"danger",children:u}),h&&e.jsx(E,{color:"success",children:h}),e.jsxs(x,{className:"mb-3",children:[e.jsx(j,{children:e.jsx(T,{icon:Z})}),e.jsx(S,{placeholder:"Username",autoComplete:"off",id:"Username",value:b,onChange:r=>v(r.target.value),required:!0,disabled:a})]}),e.jsxs(x,{className:"mb-3",children:[e.jsx(j,{children:"@"}),e.jsx(S,{placeholder:"Email",autoComplete:"off",id:"Email",value:c,onChange:r=>d(r.target.value),required:!0,type:"email",disabled:a})]}),e.jsxs(x,{className:"mb-3",children:[e.jsx(j,{children:e.jsx(T,{icon:k})}),e.jsx(S,{type:"password",placeholder:"Password",autoComplete:"off",id:"Password",value:o,onChange:r=>y(r.target.value),required:!0,disabled:a})]}),e.jsxs(x,{className:"mb-4",children:[e.jsx(j,{children:e.jsx(T,{icon:k})}),e.jsx(S,{type:"password",placeholder:"Repeat password",autoComplete:"off",id:"RepeatPassword",value:m,onChange:r=>i(r.target.value),required:!0,disabled:a})]}),e.jsxs(x,{className:"mb-3",children:[e.jsx(j,{children:"Role"}),e.jsxs($,{id:"Role",value:R,onChange:r=>w(r.target.value),disabled:a,children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"Manager",children:"Manager"})]})]}),e.jsx(P,{color:"success",type:"submit",disabled:a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"sm"})," Loading..."]}):"Create"}),e.jsx(P,{color:"secondary",className:"ms-2",onClick:F,disabled:a,children:"Back"})]})})})})})})})};export{pe as default};
