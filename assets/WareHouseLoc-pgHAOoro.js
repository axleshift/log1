import{r as a,_ as pe,u as xe,a as k,R as E,C as ge,c as je,P as x,d as Ce,G as ve,A as Q,j as e,k as L,m as _,D as ye}from"./index-CsaWF22A.js";import{F as z,n as be,q as Ne,g as we,e as Se}from"./index-oifflGhE.js";import{a as W}from"./CButton-jZS8B7LC.js";import{C as re,a as oe,b as ne,c as ie}from"./CModalHeader-BCqumWiI.js";import{C as le}from"./CModalTitle-CrBiNCMR.js";import{C as A}from"./CAlert-CEAvw_eV.js";import{C as ce}from"./CForm--7dvZFGO.js";import{C as I}from"./CFormInput-WRvYazAq.js";import{C as G}from"./CContainer-g_QGneNE.js";import{C as Le}from"./CInputGroup-D7o4YuZm.js";import{C as Pe}from"./CInputGroupText-BxQ2OS6Y.js";import{C as ke}from"./CCard-SDzmPDsF.js";import{e as se,u as Te,C as de}from"./DefaultLayout-WAIa-Lmb.js";import{C as Ee}from"./CCardBody-CQLa3avo.js";import{C as We,a as Ae,b as ae,c as H,d as Fe,e as O}from"./CTable-7kqoBi0o.js";import{g as Re}from"./getTransitionDurationFromElement-Cpu4p4hx.js";import{C as Ie,a as J}from"./CPaginationItem-BPqgRXWL.js";import"./index.esm-DfJjOvAU.js";import"./1-LCO57Jwg.js";import"./cil-user-Ddrdy7PS.js";var te=function(s){typeof s=="function"&&s()},Ve=function(s){s.dispatchEvent(new Event("transitionend"))},Be=function(s,l,v){if(v===void 0&&(v=!0),!v){te(s);return}var j=5,g=Re(l)+j,n=!1,f=function(r){var c=r.target;c===l&&(n=!0,l.removeEventListener("transitionend",f),te(s))};l.addEventListener("transitionend",f),setTimeout(function(){n||Ve(l)},g)},De=function(s,l){switch(s){case"right":return se(l)?"left":"right";case"left":return se(l)?"right":"left";default:return s}},R=a.forwardRef(function(s,l){var v=s.children,j=s.animation,g=j===void 0?!0:j,n=s.className,f=s.container,r=s.content,c=s.delay,d=c===void 0?0:c,o=s.fallbackPlacements,u=o===void 0?["top","right","bottom","left"]:o,m=s.offset,b=m===void 0?[0,6]:m,C=s.onHide,N=s.onShow,w=s.placement,T=w===void 0?"top":w,h=s.popperConfig,S=s.trigger,p=S===void 0?["hover","focus"]:S,y=s.visible,t=pe(s,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","popperConfig","trigger","visible"]),i=a.useRef(null),P=a.useRef(null),U=xe(l,i),V="tooltip".concat(a.useId()),$=a.useState(!1),B=$[0],K=$[1],X=a.useState(y),F=X[0],Y=X[1],q=Te(),ue=q.initPopper,me=q.destroyPopper,fe=q.updatePopper,Z=typeof d=="number"?{show:d,hide:d}:d,ee={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:u}},{name:"offset",options:{offset:b}}],placement:De(T,P.current)},he=k(k({},ee),typeof h=="function"?h(ee):h);a.useEffect(function(){if(y){D();return}M()},[y]),a.useEffect(function(){if(B&&P.current&&i.current){ue(P.current,i.current,he),setTimeout(function(){Y(!0)},Z.show);return}!B&&P.current&&i.current&&me()},[B]),a.useEffect(function(){!F&&P.current&&i.current&&Be(function(){K(!1)},i.current)},[F]);var D=function(){K(!0),N&&N()},M=function(){setTimeout(function(){Y(!1),C&&C()},Z.hide)};return a.useEffect(function(){fe()},[r]),E.createElement(E.Fragment,null,E.cloneElement(v,k(k(k(k(k({},F&&{"aria-describedby":V}),{ref:P}),(p==="click"||p.includes("click"))&&{onClick:function(){return F?M():D()}}),(p==="focus"||p.includes("focus"))&&{onFocus:function(){return D()},onBlur:function(){return M()}}),(p==="hover"||p.includes("hover"))&&{onMouseEnter:function(){return D()},onMouseLeave:function(){return M()}})),E.createElement(ge,{container:f,portal:!0},B&&E.createElement("div",k({className:je("tooltip","bs-tooltip-auto",{fade:g,show:F},n),id:V,ref:U,role:"tooltip"},t),E.createElement("div",{className:"tooltip-arrow"}),E.createElement("div",{className:"tooltip-inner"},r))))});R.propTypes={animation:x.bool,children:x.node,container:x.any,content:x.oneOfType([x.string,x.node]),delay:x.oneOfType([x.number,x.shape({show:x.number.isRequired,hide:x.number.isRequired})]),fallbackPlacements:ve,offset:x.any,onHide:x.func,onShow:x.func,placement:x.oneOf(["auto","top","right","bottom","left"]),popperConfig:x.oneOfType([x.func,x.object]),trigger:Ce,visible:x.bool};R.displayName="CTooltip";const Me=({onAddWarehouseLoc:s})=>{const{showSuccess:l,showError:v}=Q(),[j,g]=a.useState(!1),[n,f]=a.useState(!1),[r,c]=a.useState(!1),[d,o]=a.useState(null),[u,m]=a.useState(null),b={warehouseName:"",address:""},[C,N]=a.useState(b),w=h=>{const{id:S,value:p}=h.target;N(y=>({...y,[S]:p}))},T=async h=>{const p=h.currentTarget.checkValidity();if(p||(h.preventDefault(),h.stopPropagation()),g(p),p){const t=JSON.parse(sessionStorage.getItem("user")).email;if(!t){o("User email not found. Please log in again.");return}c(!0);try{const i=await _.post("api/v1/warehouseLoc/add",{...C,createdBy:t});i.data.success&&(l(i.data.message),s(i.data.data),setTimeout(()=>{c(!1),f(!1),o(null),N(b),g(!1)},2e3))}catch(i){o(i.response.data.message),v(i.response.data.message),setTimeout(()=>{o(null)},2e3)}c(!1)}};return e.jsx(e.Fragment,{children:r?e.jsx(L,{color:"primary",size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(W,{color:"primary",variant:"outline",disabled:r,onClick:()=>f(!0),children:[r?e.jsx(L,{color:"secondary",size:"sm"}):e.jsx(z,{icon:be})," ","Add Warehouse Location"]}),e.jsxs(re,{visible:n,onClose:()=>f(!1),children:[e.jsx(oe,{closeButton:!0,children:e.jsx(le,{children:"Add Warehouse Location"})}),d&&e.jsx(A,{color:"danger",className:"m-3",children:d}),u&&e.jsx(A,{color:"success",className:"m-3",children:u}),e.jsx(ne,{children:e.jsxs(ce,{noValidate:!0,validated:j,children:[e.jsx(I,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:w,value:C.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name",feedbackValid:"Looks good!"}),e.jsx(I,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:w,value:C.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address",feedbackValid:"Looks good!"})]})}),e.jsxs(ie,{children:[e.jsx(W,{color:"secondary",variant:"outline",disabled:r,onClick:()=>{f(!1),N(b),f(!1),o(null),g(!1)},children:r?e.jsx(L,{color:"secondary",size:"sm"}):"Cancel"}),e.jsx(W,{color:"primary",variant:"outline",disabled:r,onClick:T,children:r?e.jsx(L,{color:"primary",size:"sm"}):"Add"})]})]})]})})},He=({warehouseLoc:s,onDeleteWarehouseLoc:l})=>{const{showSuccess:v,showError:j}=Q(),[g,n]=a.useState(!1),[f,r]=a.useState(null),c=async()=>{n(!0);try{const d=await _.patch(`api/v1/warehouseLoc/delete/${s._id}`);d.data.success&&(v(d.data.message),l(s._id),n(!1),r(null))}catch(d){r(d),j(d.message)}finally{n(!1)}};return f?e.jsxs(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",f.message]}):e.jsx(e.Fragment,{children:e.jsxs(W,{color:"danger",disabled:g,variant:"outline",onClick:c,className:"me-2",children:[g?e.jsx(L,{size:"sm"}):e.jsx(z,{icon:Ne})," Delete"]})})},Oe=({warehouseLoc:s,onUpdateWarehouseLoc:l})=>{const{showSuccess:v,showErrors:j}=Q(),[g,n]=a.useState(!1),[f,r]=a.useState(!1),[c,d]=a.useState(!1),[o,u]=a.useState(null),[m,b]=a.useState(null),[C,N]=a.useState({warehouseName:s.warehouseName,address:s.address}),w=h=>{const{id:S,value:p}=h.target;N(y=>({...y,[S]:p}))},T=async h=>{const p=h.currentTarget.checkValidity();p||(h.preventDefault(),h.stopPropagation()),r(p);const t=JSON.parse(sessionStorage.getItem("user")).email;if(!t){u("User email not found. Please log in again.");return}d(!0);try{const i=await _.put(`api/v1/warehouseLoc/update/${s._id}`,{...C,createdBy:t});i.data.success&&(v(i.data.message),l(i.data.data),setTimeout(()=>{b(null),n(!1),u(null),r(!1)},2e3))}catch(i){u(i.response.data.message),j(i.response.data.message),setTimeout(()=>{u(null)},2e3)}d(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(W,{color:"primary",variant:"outline",disabled:c,onClick:()=>n(!0),className:"me-2",children:[c?e.jsx(L,{size:"sm"}):e.jsx(z,{icon:we})," Update"]}),e.jsxs(re,{visible:g,onClose:()=>n(!1),children:[e.jsx(oe,{closeButton:!0,children:e.jsx(le,{children:"Update Warehouse Location"})}),o&&e.jsx(A,{color:"danger",className:"m-3",children:o}),m&&e.jsx(A,{color:"success",className:"m-3",children:m}),e.jsx(ne,{children:e.jsxs(ce,{noValidate:!0,validated:f,children:[e.jsx(I,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:w,value:C.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name.",feedbackValid:"Looks good!"}),e.jsx(I,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:w,value:C.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address.",feedbackValid:"Looks good!"})]})}),e.jsxs(ie,{children:[e.jsx(W,{color:"secondary",variant:"outline",disabled:c,onClick:()=>{n(!1),u(null),r(!1)},children:c?e.jsx(L,{size:"sm",color:"secondary"}):"Cancel"}),e.jsx(W,{color:"primary",variant:"outline",disabled:c,onClick:T,children:c?e.jsx(L,{size:"sm",color:"success"}):"Update"})]})]})]})},_e=({warehouseLoc:s,loading:l,error:v,onDeleteWarehouseLoc:j,onUpdateWarehouseLoc:g})=>{const[n,f]=a.useState(""),[r,c]=a.useState([]),[d,o]=a.useState(1),[u,m]=a.useState(null),b=10,C=ye(),N=["manager","admin"],w="admin";if(a.useEffect(()=>{c(s)},[s]),a.useEffect(()=>{if(n==="")c(s);else{const t=s.filter(i=>{const P=i.warehouseName.toLowerCase().includes(n.toLowerCase()),U=i.address.toLowerCase().includes(n.toLowerCase()),V=N.includes(C)&&i.createdBy.toLowerCase().includes(n.toLowerCase());return P||U||V});c(t),o(1),t.length===0?m("No results found"):m(null)}},[n,s]),s.length===0)return e.jsx(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:"No Warehouse Location Found"});const T=t=>{f(t.target.value)},h=d*b,S=h-b,p=r.slice(S,h),y=Math.ceil(r.length/b);return l?e.jsx(L,{color:"primary",className:"text-center mt-5 w-75 mx-auto",children:"Loading Warehouse Location..."}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"m-3",children:e.jsxs(Le,{className:"w-50 mb-3",children:[e.jsx(I,{type:"text",id:"search",value:n,onChange:T,placeholder:"Search Warehouse Location..."}),e.jsx(Pe,{children:e.jsx(z,{icon:Se})})]})}),e.jsxs(ke,{children:[e.jsx(de,{children:"Warehouse Location List"}),e.jsxs(Ee,{className:"md-3",children:[e.jsxs(We,{bordered:!0,hover:!0,responsive:!0,className:"mx-auto ",children:[e.jsx(Ae,{className:"text-center",children:e.jsxs(ae,{children:[e.jsx(H,{className:"fixed-width bg-secondary",children:"Warehouse Name"}),e.jsx(H,{className:"fixed-width bg-secondary",children:"Address"}),w.includes(C)&&e.jsx(H,{className:"fixed-width bg-secondary",children:"Created By"}),e.jsx(H,{className:"fixed-width bg-secondary",children:"Actions"})]})}),e.jsx(Fe,{className:"text-center",children:p.map(t=>e.jsxs(ae,{children:[e.jsx(O,{className:"fixed-width",children:e.jsx(R,{content:t.warehouseName,children:e.jsx("span",{children:t.warehouseName})})}),e.jsx(O,{className:"fixed-width",children:e.jsx(R,{content:t.address,children:e.jsx("span",{children:t.address})})}),w.includes(C)&&e.jsx(O,{className:"fixed-width",color:"danger",children:e.jsx(R,{content:t.createdBy,children:e.jsx("span",{children:t.createdBy})})}),e.jsxs(O,{className:"fixed-width",children:[e.jsx(Oe,{warehouseLoc:t,onUpdateWarehouseLoc:g}),N.includes(C)&&e.jsx(He,{warehouseLoc:t,onDeleteWarehouseLoc:j})]})]},t._id))})]}),r.length>0&&e.jsxs(G,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(G,{children:["Showing ",S+1," to"," ",Math.min(h,r.length)," of"," ",r.length," entries"]}),e.jsxs(Ie,{className:"mt-3",children:[e.jsx(J,{disabled:d===1,onClick:()=>o(t=>Math.max(t-1,1)),children:"Previous"}),[...Array(y).keys()].map(t=>e.jsx(J,{active:t+1===d,onClick:()=>o(t+1),children:t+1},t+1)),e.jsx(J,{disabled:d===y,onClick:()=>o(t=>Math.min(t+1,y)),children:"Next"})]})]}),u&&e.jsx(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:u})]})]})]})};sessionStorage.getItem("accessToken");const cs=()=>{const[s,l]=a.useState([]),[v,j]=a.useState(!1),[g,n]=a.useState(null),f=async()=>{var o,u;j(!0);try{const m=await _.get("api/v1/warehouseLoc/locations");m.status===200?l(m.data.data):n(m.data.message)}catch(m){n(((u=(o=m.response)==null?void 0:o.data)==null?void 0:u.message)||m.message)}finally{j(!1)}};a.useEffect(()=>{f()},[]);const r=o=>{l(u=>[...u,o])},c=o=>{l(u=>u.filter(m=>m._id!==o))},d=o=>{l(u=>u.map(m=>m._id===o._id?o:m))};return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:"Warehouse location"}),e.jsx(Me,{onAddWarehouseLoc:r}),e.jsx(_e,{warehouseLoc:s,loading:v,error:g,onDeleteWarehouseLoc:c,onUpdateWarehouseLoc:d})]})};export{cs as default};
