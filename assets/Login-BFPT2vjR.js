import{r as a,m as k,j as e,l as T}from"./index-D6RVllqY.js";import{C as h}from"./index.esm-D1MU6lFq.js";import{C as R}from"./CContainer-us5YcjQn.js";import{C as f,a as C}from"./CRow-vGlwBAWH.js";import{C as E}from"./CCardGroup-BKRdEKU8.js";import{C as U}from"./CCard-DlMmv81Z.js";import{C as G}from"./CCardBody-9PrU6oJT.js";import{C as q}from"./CForm-DnSw-G5B.js";import{C as g}from"./CAlert-e_P2qP_P.js";import{C as j}from"./CInputGroup-BQXuajcI.js";import{C as y}from"./CInputGroupText-CBbZTKj3.js";import{c as A}from"./cil-user-Ddrdy7PS.js";import{C as b}from"./CFormInput-rqSm4o1p.js";import{c as B}from"./cil-lock-locked-DmxpJbVL.js";import{a as D}from"./CButton-awDWJzLb.js";const F="http://localhost:5057/",P=T.create({baseURL:F}),se=()=>{const N={username:"",password:""},[o,S]=a.useState(N),[i,m]=a.useState(null),[l,d]=a.useState(!1),[u,n]=a.useState(""),v=k(),p=c=>{const{id:r,value:t}=c.target;S(s=>({...s,[r]:t}))},w=async c=>{var r,t;c.preventDefault(),d(!0),n("");try{const s=await P.post("api/v1/user/login",o);if(s.data.success){const{accessToken:I,refreshToken:x,user:L}=s.data;if(!x)throw new Error("Refresh token not received from server");sessionStorage.setItem("accessToken",I),sessionStorage.setItem("refreshToken",x),sessionStorage.setItem("user",JSON.stringify(L)),m(s.data.message),setTimeout(()=>{v("/dashboard"),m(null)},2e3)}}catch(s){n(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||s.message),setTimeout(()=>{n(null)},5e3)}finally{d(!1)}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(R,{children:e.jsx(f,{className:"justify-content-center",children:e.jsx(C,{xs:12,sm:10,md:8,lg:6,xl:4,children:e.jsx(E,{children:e.jsx(U,{className:"p-4",children:e.jsx(G,{children:e.jsxs(q,{onSubmit:w,children:[e.jsx("h1",{className:"text-center mb-3",children:"Login"}),e.jsx("p",{className:"text-body-secondary text-center mb-4",children:"Sign In to your account"}),i&&e.jsx(g,{color:"success",className:"text-success mb-3",children:i}),u&&e.jsx(g,{color:"danger",className:"text-danger mb-3",children:u}),e.jsxs(j,{className:"mb-3",children:[e.jsx(y,{children:e.jsx(h,{icon:A})}),e.jsx(b,{type:"text",placeholder:"Username",autoComplete:"off",id:"username",required:!0,value:o.username,onChange:p})]}),e.jsxs(j,{className:"mb-4",children:[e.jsx(y,{children:e.jsx(h,{icon:B})}),e.jsx(b,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",required:!0,value:o.password,onChange:p})]}),e.jsx(f,{className:"justify-content-center",children:e.jsx(C,{xs:12,sm:8,md:6,children:e.jsx(D,{color:"primary",className:"px-4 w-100",type:"submit",disabled:l,children:l?"Logging in...":"Login"})})})]})})})})})})})})};export{se as default};
