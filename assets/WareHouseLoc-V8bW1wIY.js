import{r as s,_ as pe,a as L,R as W,c as xe,P as c,d as ge,A as Ce,j as e,C as T,i as D}from"./index-jiNyKwsp.js";import{C as je,F as H,i as be,j as ye,h as ve,g as Ne}from"./index-DFyN7MmU.js";import{a as A}from"./CButton-BYhtaUES.js";import{C as oe,a as re,b as ne,c as ie,d as le}from"./CModalTitle-CoYR5CZO.js";import{a as E,C as ce}from"./CForm-DqhKtZxf.js";import{C as R}from"./CFormInput-Aogae6Re.js";import{C as Se}from"./CContainer-DTmQoVhq.js";import{C as ke,a as we}from"./CInputGroupText-vwwZNSfW.js";import{C as Pe}from"./CCard-DdcUPz_T.js";import{u as Le,C as de}from"./DefaultLayout-Cmm6rABs.js";import{C as Te}from"./CCardBody-DHnVSZdn.js";import{C as We,a as Ae,b as Z,c as M,d as Ee,e as U}from"./CTable-ChCIrykH.js";import{u as Ie}from"./CCloseButton-BXXgN7mW.js";import{g as Fe,e as Re}from"./getRTLPlacement-DQvcvtcn.js";import{C as Be,a as q}from"./CPaginationItem-D6lPLeSz.js";import"./index.esm-CbrbfJev.js";import"./cil-user-Ddrdy7PS.js";import"./CImage-BSkrlDg4.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";var F=s.forwardRef(function(a,j){var y=a.children,d=a.animation,x=d===void 0?!0:d,t=a.className,u=a.container,g=a.content,f=a.delay,i=f===void 0?0:f,n=a.fallbackPlacements,l=n===void 0?["top","right","bottom","left"]:n,o=a.offset,v=o===void 0?[0,6]:o,b=a.onHide,k=a.onShow,h=a.placement,w=h===void 0?"top":h,p=a.popperConfig,N=a.trigger,C=N===void 0?["hover","focus"]:N,m=a.visible,r=pe(a,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","popperConfig","trigger","visible"]),S=s.useRef(null),P=s.useRef(null),O=Ie(j,S),B="tooltip".concat(s.useId()),J=s.useState(!1),V=J[0],G=J[1],Q=s.useState(m),I=Q[0],K=Q[1],_=Le(),ue=_.initPopper,me=_.destroyPopper,fe=_.updatePopper,X=typeof i=="number"?{show:i,hide:i}:i,Y={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:l}},{name:"offset",options:{offset:v}}],placement:Fe(w,P.current)},he=L(L({},Y),typeof p=="function"?p(Y):p);s.useEffect(function(){if(m){$();return}z()},[m]),s.useEffect(function(){if(V&&P.current&&S.current){ue(P.current,S.current,he),setTimeout(function(){K(!0)},X.show);return}!V&&P.current&&S.current&&me()},[V]),s.useEffect(function(){!I&&P.current&&S.current&&Re(function(){G(!1)},S.current)},[I]);var $=function(){G(!0),k&&k()},z=function(){setTimeout(function(){K(!1),b&&b()},X.hide)};return s.useEffect(function(){fe()},[g]),W.createElement(W.Fragment,null,W.cloneElement(y,L(L(L(L(L({},I&&{"aria-describedby":B}),{ref:P}),(C==="click"||C.includes("click"))&&{onClick:function(){return I?z():$()}}),(C==="focus"||C.includes("focus"))&&{onFocus:function(){return $()},onBlur:function(){return z()}}),(C==="hover"||C.includes("hover"))&&{onMouseEnter:function(){return $()},onMouseLeave:function(){return z()}})),W.createElement(je,{container:u,portal:!0},V&&W.createElement("div",L({className:xe("tooltip","bs-tooltip-auto",{fade:x,show:I},t),id:B,ref:O,role:"tooltip"},r),W.createElement("div",{className:"tooltip-arrow"}),W.createElement("div",{className:"tooltip-inner"},g))))});F.propTypes={animation:c.bool,children:c.node,container:c.any,content:c.oneOfType([c.string,c.node]),delay:c.oneOfType([c.number,c.shape({show:c.number.isRequired,hide:c.number.isRequired})]),fallbackPlacements:Ce,offset:c.any,onHide:c.func,onShow:c.func,placement:c.oneOf(["auto","top","right","bottom","left"]),popperConfig:c.oneOfType([c.func,c.object]),trigger:ge,visible:c.bool};F.displayName="CTooltip";const ee=sessionStorage.getItem("accessToken"),Ve="http://localhost:5057",$e=D.create({baseURL:Ve,withCredentials:!0,headers:{"Content-Type":"application/json",...ee&&{Authorization:`Bearer ${ee}`}}}),ze=({onAddWarehouseLoc:a})=>{const[j,y]=s.useState(!1),[d,x]=s.useState(!1),[t,u]=s.useState(!1),[g,f]=s.useState(null),[i,n]=s.useState(null),l={warehouseName:"",address:""},[o,v]=s.useState(l),b=h=>{const{id:w,value:p}=h.target;v(N=>({...N,[w]:p}))},k=async h=>{const p=h.currentTarget.checkValidity();if(p||(h.preventDefault(),h.stopPropagation()),y(p),p){const C=JSON.parse(sessionStorage.getItem("user")).email;if(!C){f("User email not found. Please log in again.");return}u(!0);try{const m=await $e.post("/api/v1/warehouseLoc/add",{...o,createdBy:C});m.status===201&&(n(m.data.message),a(m.data.data),setTimeout(()=>{n(null),v(l),x(!1),u(!1),f(null)},2e3),v({warehouseName:"",address:""}))}catch(m){f(m.response.data.message),setTimeout(()=>{f(null)},2e3)}u(!1)}};return e.jsx(e.Fragment,{children:t?e.jsx(T,{color:"primary",size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{color:"primary",variant:"outline",disabled:t,onClick:()=>x(!0),children:[t?e.jsx(T,{color:"secondary",size:"sm"}):e.jsx(H,{icon:be})," ","Add Warehouse Location"]}),e.jsxs(oe,{visible:d,onClose:()=>x(!1),children:[e.jsx(re,{closeButton:!0,children:e.jsx(ne,{children:"Add Warehouse Location"})}),g&&e.jsx(E,{color:"danger",className:"m-3",children:g}),i&&e.jsx(E,{color:"success",className:"m-3",children:i}),e.jsx(ie,{children:e.jsxs(ce,{noValidate:!0,validated:j,children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:b,value:o.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name",feedbackValid:"Looks good!"}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:b,value:o.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address",feedbackValid:"Looks good!"})]})}),e.jsxs(le,{children:[e.jsx(A,{color:"secondary",variant:"outline",disabled:t,onClick:()=>{x(!1),v(l),x(!1),f(null),y(!1)},children:t?e.jsx(T,{color:"secondary",size:"sm"}):"Cancel"}),e.jsx(A,{color:"primary",variant:"outline",disabled:t,onClick:k,children:t?e.jsx(T,{color:"primary",size:"sm"}):"Add"})]})]})]})})},se=sessionStorage.getItem("accessToken"),Me="http://localhost:5057",Ue=D.create({baseURL:Me,withCredentials:!0,headers:{"Content-Type":"application/json",...se&&{Authorization:`Bearer ${se}`}}}),De=({warehouseLoc:a,onDeleteWarehouseLoc:j})=>{const[y,d]=s.useState(!1),[x,t]=s.useState(null),u=async()=>{d(!0);try{(await Ue.delete(`/api/v1/warehouseLoc/delete/${a._id}`)).status===200&&(alert("Warehouse Location deleted successfully"),j(a._id),d(!1),t(null))}catch(g){t(g)}finally{d(!1)}};return x?e.jsxs(E,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",x.message]}):e.jsx(e.Fragment,{children:e.jsx(A,{color:"danger",disabled:y,variant:"outline",onClick:u,className:"me-2",children:y?e.jsx(T,{size:"sm"}):e.jsx(H,{icon:ye})})})},ae=sessionStorage.getItem("accessToken"),He="http://localhost:5057",Oe=D.create({baseURL:He,withCredentials:!0,headers:{"Content-Type":"application/json",...ae&&{Authorization:`Bearer ${ae}`}}}),_e=({warehouseLoc:a,onUpdateWarehouseLoc:j})=>{const[y,d]=s.useState(!1),[x,t]=s.useState(!1),[u,g]=s.useState(!1),[f,i]=s.useState(null),[n,l]=s.useState(null),[o,v]=s.useState({warehouseName:a.warehouseName,address:a.address}),b=h=>{const{id:w,value:p}=h.target;v(N=>({...N,[w]:p}))},k=async h=>{const p=h.currentTarget.checkValidity();p||(h.preventDefault(),h.stopPropagation()),t(p);const C=JSON.parse(sessionStorage.getItem("user")).email;if(!C){i("User email not found. Please log in again.");return}g(!0);try{const m=await Oe.put(`/api/v1/warehouseLoc/update/${a._id}`,{...o,createdBy:C});m.status===200&&(l("Warehouse Location updated successfully"),j(m.data.data),setTimeout(()=>{l(null),d(!1),i(null),t(!1)},2e3))}catch(m){i(m.response.data.message),setTimeout(()=>{i(null)},2e3)}g(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(A,{color:"primary",variant:"outline",disabled:u,onClick:()=>d(!0),className:"me-2",children:u?e.jsx(T,{size:"sm"}):e.jsx(H,{icon:ve})}),e.jsxs(oe,{visible:y,onClose:()=>d(!1),children:[e.jsx(re,{closeButton:!0,children:e.jsx(ne,{children:"Update Warehouse Location"})}),f&&e.jsx(E,{color:"danger",className:"m-3",children:f}),n&&e.jsx(E,{color:"success",className:"m-3",children:n}),e.jsx(ie,{children:e.jsxs(ce,{noValidate:!0,validated:x,children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:b,value:o.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name.",feedbackValid:"Looks good!"}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:b,value:o.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address.",feedbackValid:"Looks good!"})]})}),e.jsxs(le,{children:[e.jsx(A,{color:"secondary",variant:"outline",disabled:u,onClick:()=>{d(!1),i(null),t(!1)},children:u?e.jsx(T,{size:"sm",color:"secondary"}):"Cancel"}),e.jsx(A,{color:"primary",variant:"outline",disabled:u,onClick:k,children:u?e.jsx(T,{size:"sm",color:"success"}):"Update"})]})]})]})},qe=({warehouseLoc:a,loading:j,error:y,onDeleteWarehouseLoc:d,onUpdateWarehouseLoc:x})=>{const[t,u]=s.useState(""),[g,f]=s.useState([]),[i,n]=s.useState(1),[l,o]=s.useState(null),v=10,b=JSON.parse(sessionStorage.getItem("user")),k=["manager","admin"],h="admin";if(s.useEffect(()=>{f(a)},[a]),s.useEffect(()=>{if(t==="")f(a);else{const r=a.filter(S=>{const P=S.warehouseName.toLowerCase().includes(t.toLowerCase()),O=S.address.toLowerCase().includes(t.toLowerCase()),B=k.includes(b.role)&&S.createdBy.toLowerCase().includes(t.toLowerCase());return P||O||B});f(r),n(1),r.length===0?o("No results found"):o(null)}},[t,a]),a.length===0)return e.jsx(E,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:"No Warehouse Location Found"});const w=r=>{u(r.target.value)},p=i*v,N=p-v,C=g.slice(N,p),m=Math.ceil(g.length/v);return e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"m-3",children:e.jsxs(ke,{className:"w-50 mb-3",children:[e.jsx(R,{type:"text",id:"search",value:t,onChange:w,placeholder:"Search Warehouse Location..."}),e.jsx(we,{children:e.jsx(H,{icon:Ne})})]})}),e.jsxs(Pe,{children:[e.jsx(de,{children:"Warehouse Location List"}),e.jsxs(Te,{className:"md-3",children:[e.jsxs(We,{bordered:!0,hover:!0,responsive:!0,className:"mx-auto ",children:[e.jsx(Ae,{className:"text-center  ",children:e.jsxs(Z,{children:[e.jsx(M,{className:"fixed-width bg-secondary",children:"Warehouse Name"}),e.jsx(M,{className:"fixed-width bg-secondary",children:"Address"}),h.includes(b.role)&&e.jsx(M,{className:"fixed-width bg-secondary",children:"Created By"}),e.jsx(M,{className:"fixed-width bg-secondary",children:"Actions"})]})}),e.jsx(Ee,{className:"text-center",children:C.map(r=>e.jsxs(Z,{children:[e.jsx(U,{className:"fixed-width",children:e.jsx(F,{content:r.warehouseName,children:e.jsx("span",{children:r.warehouseName})})}),e.jsx(U,{className:"fixed-width",children:e.jsx(F,{content:r.address,children:e.jsx("span",{children:r.address})})}),h.includes(b.role)&&e.jsx(U,{className:"fixed-width",color:"danger",children:e.jsx(F,{content:r.createdBy,children:e.jsx("span",{children:r.createdBy})})}),e.jsxs(U,{className:"fixed-width",children:[e.jsx(_e,{warehouseLoc:r,onUpdateWarehouseLoc:x}),k.includes(b.role)&&e.jsx(De,{warehouseLoc:r,onDeleteWarehouseLoc:d})]})]},r._id))})]}),l&&e.jsx(E,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:l}),e.jsxs(Be,{align:"center",children:[e.jsx(q,{disabled:i===1,onClick:()=>n(r=>Math.max(r-1,1)),children:"Previous"}),[...Array(m).keys()].map(r=>e.jsx(q,{active:r+1===i,onClick:()=>n(r+1),children:r+1},r+1)),e.jsx(q,{disabled:i===m,onClick:()=>n(r=>Math.min(r+1,m)),children:"Next"})]})]})]})]})},te=sessionStorage.getItem("accessToken"),Je="http://localhost:5057",Ge=D.create({baseURL:Je,withCredentials:!0,headers:{"Content-Type":"application/json",...te&&{Authorization:`Bearer ${te}`}}}),hs=()=>{const[a,j]=s.useState([]),[y,d]=s.useState(!1),[x,t]=s.useState(null),u=async()=>{var n,l;d(!0);try{const o=await Ge.get("/api/v1/warehouseLoc/locations");o.status===200?j(o.data.data):t(o.data.message)}catch(o){t(((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||o.message)}finally{d(!1)}};s.useEffect(()=>{u()},[]);const g=n=>{j(l=>[...l,n])},f=n=>{j(l=>l.filter(o=>o._id!==n))},i=n=>{j(l=>l.map(o=>o._id===n._id?n:o))};return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:"Warehouse location"}),e.jsx(ze,{onAddWarehouseLoc:g}),e.jsx(qe,{warehouseLoc:a,loading:y,error:x,onDeleteWarehouseLoc:f,onUpdateWarehouseLoc:i})]})};export{hs as default};
