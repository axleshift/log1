import{r as a,m as k,j as s,l as T}from"./index-ArzCe3um.js";import{C as x}from"./index.esm-Cqmjbxa9.js";import{C as R}from"./CContainer-Bx98185S.js";import{C as h,a as f}from"./CRow-BPzQKtNy.js";import{C as E}from"./CCardGroup-in7gHJpR.js";import{C as U}from"./CCard-D_DPJuc0.js";import{C as G}from"./CCardBody-C-gv0bZa.js";import{C as q}from"./CForm-obpLIGSd.js";import{C}from"./CAlert-CXP_QGUc.js";import{C as g,a as j}from"./CInputGroupText-BHaX8qfa.js";import{c as A}from"./cil-user-Ddrdy7PS.js";import{C as y}from"./CFormInput-BQwvlYjn.js";import{c as B}from"./cil-lock-locked-DmxpJbVL.js";import{a as D}from"./CButton-D2mPBrms.js";const F="http://localhost:5057",P=T.create({baseURL:F}),ss=()=>{const b={username:"",password:""},[o,S]=a.useState(b),[c,v]=a.useState(null),[m,l]=a.useState(!1),[d,n]=a.useState(""),N=k(),u=i=>{const{id:r,value:t}=i.target;S(e=>({...e,[r]:t}))},w=async i=>{var r,t;i.preventDefault(),l(!0),n("");try{const e=await P.post("/api/v1/user/login",o);if(e.data.success){const{accessToken:I,refreshToken:p,user:L}=e.data;if(!p)throw new Error("Refresh token not received from server");sessionStorage.setItem("accessToken",I),sessionStorage.setItem("refreshToken",p),sessionStorage.setItem("user",JSON.stringify(L)),v(e.data.message),setTimeout(()=>{N("/dashboard")},2e3)}}catch(e){n(((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||e.message),setTimeout(()=>{n(null)},2e3)}finally{l(!1)}};return s.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:s.jsx(R,{children:s.jsx(h,{className:"justify-content-center",children:s.jsx(f,{md:4,sm:2,children:s.jsx(E,{children:s.jsx(U,{className:"p-4",children:s.jsx(G,{children:s.jsxs(q,{onSubmit:w,children:[c&&s.jsx(C,{color:"success",className:"text-success mb-3",children:c}),d&&s.jsx(C,{color:"danger",className:"text-danger mb-3",children:d}),s.jsx("h1",{children:"Login"}),s.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),s.jsxs(g,{className:"mb-3",children:[s.jsx(j,{children:s.jsx(x,{icon:A})}),s.jsx(y,{type:"text",placeholder:"Username",autoComplete:"off",id:"username",required:!0,value:o.username,onChange:u})]}),s.jsxs(g,{className:"mb-4",children:[s.jsx(j,{children:s.jsx(x,{icon:B})}),s.jsx(y,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",required:!0,value:o.password,onChange:u})]}),s.jsx(h,{children:s.jsx(f,{xs:6,children:s.jsx(D,{color:"primary",className:"px-4",type:"submit",disabled:m,children:m?"Logging in...":"Login"})})})]})})})})})})})})};export{ss as default};
