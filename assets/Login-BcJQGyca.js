import{r as t,m as k,j as e,l as T}from"./index-BtUXW-If.js";import{C as x}from"./index.esm-DfRJOaYQ.js";import{C as R}from"./CContainer-DOQQPoxN.js";import{C as h,a as f}from"./CRow-DKq8_mDK.js";import{C as E}from"./CCardGroup-Bv7ECfA9.js";import{C as U}from"./CCard-DlVexfoB.js";import{C as G}from"./CCardBody-CgBeGBlS.js";import{C as q}from"./CForm-DQYnxTCZ.js";import{C}from"./CAlert-ZL6-HQgq.js";import{C as g,a as j}from"./CInputGroupText-BN_aqD_6.js";import{c as A}from"./cil-user-Ddrdy7PS.js";import{C as y}from"./CFormInput-BxGS14l3.js";import{c as B}from"./cil-lock-locked-DmxpJbVL.js";import{a as D}from"./CButton-aUOpubdj.js";const F="https://backend-log1.axleshift.com/",P=T.create({baseURL:F}),ee=()=>{const b={username:"",password:""},[o,S]=t.useState(b),[c,v]=t.useState(null),[m,l]=t.useState(!1),[d,n]=t.useState(""),N=k(),u=i=>{const{id:r,value:a}=i.target;S(s=>({...s,[r]:a}))},w=async i=>{var r,a;i.preventDefault(),l(!0),n("");try{const s=await P.post("/api/v1/user/login",o);if(s.data.success){const{accessToken:I,refreshToken:p,user:L}=s.data;if(!p)throw new Error("Refresh token not received from server");sessionStorage.setItem("accessToken",I),sessionStorage.setItem("refreshToken",p),sessionStorage.setItem("user",JSON.stringify(L)),v(s.data.message),setTimeout(()=>{N("/dashboard")},2e3)}}catch(s){n(((a=(r=s.response)==null?void 0:r.data)==null?void 0:a.message)||s.message),setTimeout(()=>{n(null)},2e3)}finally{l(!1)}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(R,{children:e.jsx(h,{className:"justify-content-center",children:e.jsx(f,{md:4,sm:2,children:e.jsx(E,{children:e.jsx(U,{className:"p-4",children:e.jsx(G,{children:e.jsxs(q,{onSubmit:w,children:[c&&e.jsx(C,{color:"success",className:"text-success mb-3",children:c}),d&&e.jsx(C,{color:"danger",className:"text-danger mb-3",children:d}),e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(g,{className:"mb-3",children:[e.jsx(j,{children:e.jsx(x,{icon:A})}),e.jsx(y,{type:"text",placeholder:"Username",autoComplete:"off",id:"username",required:!0,value:o.username,onChange:u})]}),e.jsxs(g,{className:"mb-4",children:[e.jsx(j,{children:e.jsx(x,{icon:B})}),e.jsx(y,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",required:!0,value:o.password,onChange:u})]}),e.jsx(h,{children:e.jsx(f,{xs:6,children:e.jsx(D,{color:"primary",className:"px-4",type:"submit",disabled:m,children:m?"Logging in...":"Login"})})})]})})})})})})})})};export{ee as default};
