import{r as i,j as e,C as M}from"./index-B_xgiZND.js";import{F as W,f as Q,a as T,h as O,i as B,d as J,C as N}from"./DefaultLayout-DJqhCF6w.js";import{a as D}from"./index-DW_MHI2K.js";import{a as q}from"./CButton-Dmu7yp3G.js";import{C as _,a as z,b as E,c as G,d as U}from"./CModalTitle-DLCZrMTR.js";import{C as S}from"./CAlert-D7AY2vid.js";import{C as P}from"./CForm-Q4NE6lr7.js";import{a as w,C as k}from"./CRow-7s3L4eiP.js";import{C as c}from"./CFormInput-CxEswD9g.js";import{C as H}from"./CFormSelect-DB8WT_qC.js";import{C as F}from"./index.esm-CSCu4-FO.js";import{C as K,a as X}from"./CInputGroupText-MCOOFdiC.js";import{C as Y,a as Z,b as ee,c as ae}from"./CAccordionHeader-KeT69GvL.js";import{C as te,a as se}from"./CCardBody-CJNqt8f3.js";import"./CCloseButton-Cv6f_OZH.js";import"./cil-user-Ddrdy7PS.js";const re="http://localhost:5057",$=D.create({baseURL:re}),le=({onAddItem:o})=>{const[p,j]=i.useState(!1),[g,C]=i.useState(!1),[f,x]=i.useState(""),b=[{label:"General Merchandise",value:"generalMerchandise"},{label:"Perishables",value:"perishables"},{label:"Hazardous Materials",value:"hazardousMaterials"},{label:"High-Value Goods",value:"highValueGoods"},{label:"Oversized/Heavy Goods",value:"oversizedHeavy"}],[L,u]=i.useState([]),d=new Date().toISOString().split("T")[0],[r,v]=i.useState({name:"",from:"",itemName:"",quantity:"",weight:"",length:"",width:"",height:"",dateArrival:d,category:""}),s=m=>{const{id:l,value:a}=m.target;v(n=>{if(["length","width","height"].includes(l)){const t=a===""?"":Math.max(1,Number(a));return{...n,[l]:t}}return{...n,[l]:a}})};i.useEffect(()=>{(async()=>{try{const l=await $.get("/api/v1/warehouseLoc/locations");u(l.data.data)}catch(l){x(l.response.data.message)}})()},[]);const A=async m=>{var a,n;m.preventDefault();const l=sessionStorage.getItem("email");if(!l){x("User email not found. Please log in again.");return}try{const t=await $.post("/api/v1/warehouse/addItem",{...r,byReceived:l});if(t.status===201){const h=t.data.data,y=L.find(I=>I._id===h.warehouse);h.warehouse=y,j(t.data.message),o(t.data.data),v({name:"",from:"",itemName:"",quantity:"",weight:"",length:"",width:"",height:"",dateArrival:d,category:"",warehouse:""})}else x(t.data.message||"An unexpected error occurred")}catch(t){x(((n=(a=t.response)==null?void 0:a.data)==null?void 0:n.message)||t.message)}};return e.jsxs(e.Fragment,{children:[e.jsxs(q,{color:"primary",variant:"outline",onClick:()=>C(!0),children:[e.jsx(W,{icon:Q})," Recieved Items"]}),e.jsxs(_,{visible:g,onClose:()=>C(!1),children:[e.jsx(z,{children:e.jsx(E,{children:"Recieved Items"})}),f&&e.jsx(S,{color:"danger",children:f}),p&&e.jsx(S,{color:"success",children:p}),e.jsx(G,{children:e.jsx(P,{children:e.jsxs(w,{className:"mb-3",children:[e.jsx(c,{type:"text",placeholder:"Name / Company Name",className:"mb-3",floatingLabel:"Name / Company Name",id:"name",onChange:s,value:r.name,required:!0,autoComplete:"off"}),e.jsx(c,{type:"text",placeholder:"From",className:"mb-3",floatingLabel:"From",id:"from",onChange:s,value:r.from,required:!0}),e.jsx(c,{type:"text",placeholder:"Item Name",className:"mb-3",floatingLabel:"Item Name",id:"itemName",onChange:s,value:r.itemName,required:!0}),e.jsx(c,{type:"number",placeholder:"Quantity",className:"mb-3",floatingLabel:"Quantity",id:"quantity",onChange:s,value:r.quantity,required:!0}),e.jsx(c,{type:"number",placeholder:"Weight",className:"mb-3",floatingLabel:"Weight",id:"weight",onChange:s,value:r.weight,required:!0}),e.jsxs(k,{className:"justify-content-center",children:[e.jsx(w,{xs:"auto",children:e.jsx(c,{type:"number",placeholder:"Length",className:"mb-3",floatingLabel:"Length",id:"length",min:1,onChange:s,value:r.length,required:!0})}),e.jsx(w,{xs:"auto",children:e.jsx(c,{type:"number",placeholder:"Width",className:"mb-3",floatingLabel:"Width",id:"width",min:1,onChange:s,value:r.width,required:!0})}),e.jsx(w,{xs:"auto",children:e.jsx(c,{type:"number",placeholder:"Height",className:"mb-3 w-5",floatingLabel:"Height",id:"height",min:1,onChange:s,value:r.height,required:!0})}),e.jsx(w,{xs:"auto",children:e.jsx(c,{type:"text",placeholder:"Dimension",className:"mb-3",floatingLabel:"Dimension",id:"dimension",value:`${r.length}x${r.width}x${r.height} cm`,disabled:!0,required:!0})})]}),e.jsx(c,{type:"date",placeholder:"Date of Arrival",className:"mb-3",floatingLabel:"Date of Arrival",id:"dateArrival",onChange:s,value:r.dateArrival,min:d,required:!0,disabled:!0}),e.jsxs(H,{placeholder:"Category",className:"mb-3",floatingLabel:"Category",id:"category",onChange:s,value:r.category,required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),b.map(m=>e.jsx("option",{value:m.value,children:m.label},m.value))]}),e.jsxs(H,{placeholder:"Warehouse",className:"mb-3",floatingLabel:"Warehouse",id:"warehouse",onChange:s,value:r.warehouse,required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),L.map(m=>e.jsx("option",{value:m._id,children:m.warehouseName},m._id))]})]})})}),e.jsxs(U,{children:[e.jsx(q,{color:"secondary",variant:"outline",onClick:()=>C(!1),children:"Close"}),e.jsx(q,{color:"primary",variant:"outline",onClick:A,children:"Add Item"})]})]})]})},ne="http://localhost:5057",oe=D.create({baseURL:ne}),ie=({warehousing:o,onDeleteItem:p})=>{const[j,g]=i.useState(null),[C,f]=i.useState(!1),x=async()=>{f(!0);const b=await oe.delete(`/api/v1/warehouse/delete/${o._id}`);b.status===200?(alert("Item deleted successfully"),p(o._id),f(!1),g(null)):(f(!1),g(b.data.message))};return j?e.jsxs(S,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",j.message]}):e.jsx(e.Fragment,{children:e.jsx(q,{color:"danger",variant:"outline",onClick:x,className:"me-2",children:C?e.jsx(M,{size:"sm"}):e.jsx(W,{icon:T})})})},ce="http://localhost:5057",R=D.create({baseURL:ce}),de=({warehousing:o,onUpdateItem:p})=>{const[j,g]=i.useState(null),[C,f]=i.useState(!1),[x,b]=i.useState(null),[L,u]=i.useState(!1),[d,r]=i.useState([]),v=new Date().toISOString().split("T")[0],[s,A]=i.useState({name:o.name,from:o.from,itemName:o.itemName,quantity:o.quantity,weight:o.weight,length:o.length,width:o.width,height:o.height,dateArrival:v,category:o.category,warehouse:o.warehouse}),m=[{label:"General Merchandise",value:"generalMerchandise"},{label:"Perishables",value:"perishables"},{label:"Hazardous Materials",value:"hazardousMaterials"},{label:"High-Value Goods",value:"highValueGoods"},{label:"Oversized/Heavy Goods",value:"oversizedHeavy"}];i.useEffect(()=>{(async()=>{try{const t=await R.get("/api/v1/warehouseLoc/locations");r(t.data.data)}catch(t){g(t.response.data.message)}})()},[]);const l=n=>{const{id:t,value:h}=n.target;A(y=>{if(["length","width","height"].includes(t)){const I=h===""?"":Math.max(1,Number(h));return{...y,[t]:I}}return{...y,[t]:h}})},a=async n=>{n.preventDefault();const t=sessionStorage.getItem("email");if(!t){g("User email not found. Please log in again.");return}f(!0);try{const h=await R.put(`/api/v1/warehouse/update/${o._id}`,{...s,byReceived:t});if(h.status===200){const y=h.data.data,I=d.find(V=>V._id===y.warehouse);y.warehouse=I,b(h.data.message),p(h.data.data),setTimeout(()=>{b(null),u(!1)},2e3)}}catch(h){g(h.response.data.message),setTimeout(()=>{g(null)},2e3)}f(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{color:"primary",variant:"outline",className:"me-2",onClick:()=>u(!0),children:C?e.jsx(M,{size:"sm"}):e.jsx(W,{icon:O})}),e.jsxs(_,{visible:L,onClose:()=>u(!1),children:[e.jsx(z,{children:e.jsx(E,{children:"Recieved Items"})}),j&&e.jsx(S,{color:"danger",children:j}),x&&e.jsx(S,{color:"success",children:x}),e.jsx(G,{children:e.jsxs(P,{children:[e.jsx(c,{type:"text",placeholder:"Name / Company Name",className:"mb-3",floatingLabel:"Name / Company Name",id:"name",onChange:l,value:s.name,autoComplete:"off",required:!0}),e.jsx(c,{type:"text",placeholder:"From",className:"mb-3",floatingLabel:"From",id:"from",onChange:l,value:s.from,required:!0}),e.jsx(c,{type:"text",placeholder:"Item Name",className:"mb-3",floatingLabel:"Item Name",id:"itemName",onChange:l,value:s.itemName,required:!0}),e.jsx(c,{type:"number",placeholder:"Quantity",className:"mb-3",floatingLabel:"Quantity",id:"quantity",onChange:l,value:s.quantity,required:!0}),e.jsx(c,{type:"number",placeholder:"Weight",className:"mb-3",floatingLabel:"Weight",id:"weight",onChange:l,value:s.weight,required:!0}),e.jsxs(k,{className:"justify-content-center",children:[e.jsx(w,{xs:"auto",children:e.jsx(c,{type:"number",placeholder:"Length",className:"mb-3",floatingLabel:"Length",id:"length",min:1,onChange:l,value:s.length,required:!0})}),e.jsx(w,{xs:"auto",children:e.jsx(c,{type:"number",placeholder:"Width",className:"mb-3",floatingLabel:"Width",id:"width",min:1,onChange:l,value:s.width,required:!0})}),e.jsx(w,{xs:"auto",children:e.jsx(c,{type:"number",placeholder:"Height",className:"mb-3 w-5",floatingLabel:"Height",id:"height",min:1,onChange:l,value:s.height,required:!0})}),e.jsx(w,{xs:"auto",children:e.jsx(c,{type:"text",placeholder:"Dimension",className:"mb-3",floatingLabel:"Dimension",id:"dimension",value:`${s.length}x${s.width}x${s.height} cm`,disabled:!0,required:!0})})]}),e.jsx(c,{type:"date",placeholder:"Date of Arrival",className:"mb-3",floatingLabel:"Date of Arrival",id:"dateArrival",onChange:l,value:s.dateArrival,min:v,required:!0,disabled:!0}),e.jsxs(H,{placeholder:"Category",className:"mb-3",floatingLabel:"Category",id:"category",onChange:l,value:s.category,required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),m.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),e.jsxs(H,{placeholder:"Warehouse",className:"mb-3",floatingLabel:"Warehouse",id:"warehouse",onChange:l,value:s.warehouse._id,required:!0,children:[e.jsx("option",{value:null,children:"Select Warehouse"}),d.map(n=>e.jsx("option",{value:n._id,children:n.warehouseName},n._id))]})]})}),e.jsxs(U,{children:[e.jsx(q,{color:"secondary",variant:"outline",onClick:()=>u(!1),children:"Close"}),e.jsx(q,{color:"primary",variant:"outline",onClick:a,children:"Update Item"})]})]})]})},ue="http://localhost:5057";D.create({baseURL:ue});const me=({warehousing:o,loading:p,error:j,onDeleteItem:g,onUpdateItem:C})=>{const[f,x]=i.useState([]),[b,L]=i.useState(null),[u,d]=i.useState(""),r=JSON.parse(sessionStorage.getItem("user")),v=["manager","admin"];i.useEffect(()=>{(()=>{if(u==="")x(o);else{const n=o.filter(t=>{var y;const h=((y=A.find(I=>I.value===t.category))==null?void 0:y.label.toLowerCase())||"";return t.name.toLowerCase().includes(u.toLowerCase())||t.from.toLowerCase().includes(u.toLowerCase())||t.itemName.toLowerCase().includes(u.toLowerCase())||t.quantity.toString().includes(u)||t.weight.toString().includes(u)||s(t.dateArrival).includes(u)||h.includes(u.toLowerCase())});x(n),n.length===0?L("No Item found"):L(null)}})()},[u,o]);const s=a=>new Date(a).toLocaleDateString(),A=[{label:"General Merchandise",value:"generalMerchandise"},{label:"Perishables",value:"perishables"},{label:"Hazardous Materials",value:"hazardousMaterials"},{label:"High-Value Goods",value:"highValueGoods"},{label:"Oversized/Heavy Goods",value:"oversizedHeavy"}],m=a=>{switch(a){case"Queued":return"orange";case"dispatched":return"green";case"on_process":return"orange";case"Cancelled":return"red";default:return"black"}},l=a=>{d(a.target.value)};return p?e.jsx(M,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):o.length===0?e.jsx(S,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mt-3",children:e.jsxs(K,{className:"w-50 mb-3",children:[e.jsx(c,{type:"text",placeholder:"Search Items...",value:u,id:"searchInput",onChange:l}),e.jsx(X,{children:e.jsx(W,{icon:B})})]})}),j&&e.jsx(S,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:j}),b&&e.jsx(S,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:b}),e.jsx(Y,{className:"m-2 ",children:f.map(a=>{var n;return e.jsxs(Z,{children:[e.jsxs(ee,{children:[e.jsxs("ul",{className:"list-unstyled p-0 m-0 w-100",children:[e.jsxs("li",{children:["Name / Company: ",e.jsx("strong",{children:a.name})]}),e.jsxs("li",{children:["From: ",e.jsx("strong",{children:a.from})]})]}),e.jsx(W,{icon:J,color:m(a.status),className:"float-end"}),e.jsx("small",{className:" m-2 float-end",children:a.status})]}),e.jsxs(ae,{children:[e.jsxs(N,{children:["Item Name: ",a.itemName]}),e.jsxs(N,{children:["Quantity: ",a.quantity]}),e.jsxs(N,{children:["Weight: ",a.weight]}),e.jsxs(N,{children:["Dimension:"," ",`${a.length} x ${a.width} x ${a.height} cm`]}),e.jsxs(N,{children:["Date Arrival: ",s(a.dateArrival)]}),e.jsxs(N,{children:["Received By: ",a.byReceived]}),e.jsxs(N,{children:["Warehouse: ",a.warehouse?a.warehouse.warehouseName:"Unknown"]}),e.jsxs(N,{children:["Category:"," ",((n=A.find(t=>t.value===a.category))==null?void 0:n.label)||"Unknown"]}),e.jsxs(F,{className:"d-flex justify-content-end mt-3",children:[e.jsx(de,{warehousing:a,onUpdateItem:C}),v.includes(r.data.user.role)&&e.jsx(ie,{warehousing:a,onDeleteItem:g})]})]})]},a._id)})})]})},he="http://localhost:5057",ge=D.create({baseURL:he}),De=()=>{const[o,p]=i.useState([]),[j,g]=i.useState(!1),[C,f]=i.useState(null),x=async()=>{g(!0);try{const d=await ge.get("/api/v1/warehouse/items");d.status===200&&p(d.data.data)}catch(d){f(d.response.data.message)}finally{g(!1)}};i.useEffect(()=>{x()},[]);const b=d=>{p(r=>[...r,d])},L=d=>{p(r=>r.filter(v=>v._id!==d))},u=d=>{p(r=>r.map(v=>v._id===d._id?d:v))};return e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"text-center",children:"WareHousing"}),e.jsx(F,{className:"m-3",children:e.jsx(le,{onAddItem:b})}),e.jsxs(te,{children:[e.jsx(N,{children:"Item List"}),e.jsx(se,{className:"md-3",children:e.jsx(me,{warehousing:o,loading:j,error:C,onDeleteItem:L,onUpdateItem:u})})]})]})};export{De as default};
