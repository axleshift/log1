import{m as P,r as t,j as e,k as F,A as L}from"./index-BQNKW3Oi.js";import{C as h}from"./index.esm-abRcLFOT.js";import{C as q}from"./CContainer-Cx55YM07.js";import{C as A,a as B}from"./CRow-CfHzwP2N.js";import{C as E}from"./CCard-DLIXfnJP.js";import{C as T}from"./CCardBody--fyyd1pn.js";import{C as U}from"./CForm-ChwbRa0e.js";import{C as b}from"./CAlert-m8lQ_dLd.js";import{C as n,a as l}from"./CInputGroupText-CmPr8mzE.js";import{c as D}from"./cil-user-Ddrdy7PS.js";import{C as u}from"./CFormInput-DT3Aafzt.js";import{c as N}from"./cil-lock-locked-DmxpJbVL.js";import{C as G}from"./CFormSelect-B66-L5-O.js";import{a as y}from"./CButton-CDTCjSee.js";const re=()=>{const j=P(),[r,S]=t.useState({username:"",email:"",password:"",repeatPassword:"",role:"",photo:null}),[C,i]=t.useState(null),[f,g]=t.useState(null),[a,p]=t.useState(!1),[M,z]=t.useState(null),o=x=>{const{id:c,value:d}=x.target;S(m=>({...m,[c]:d}))},k=async x=>{var c,d,m,v,w;x.preventDefault(),p(!0),i(null);try{if(r.password!==r.repeatPassword){i("Passwords do not match"),p(!1);return}const s=await L.post("/api/v1/user/register",r);s.data&&s.data.success?(g("Registration successful"),s.data.token&&sessionStorage.setItem("accessToken",s.data.token),setTimeout(()=>{g(null),j("/dashboard")},2e3)):i(((c=s.data)==null?void 0:c.message)||"Registration failed")}catch(s){console.error("Full error details:",{message:s.message,response:(d=s.response)==null?void 0:d.data,status:(m=s.response)==null?void 0:m.status});const I=((w=(v=s.response)==null?void 0:v.data)==null?void 0:w.message)||s.message||"An error occurred during registration";i(I)}finally{p(!1)}},R=()=>{j("/dashboard")};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(q,{children:e.jsx(A,{className:"justify-content-center",children:e.jsx(B,{md:9,lg:7,xl:6,children:e.jsx(E,{className:"mx-4",children:e.jsx(T,{className:"p-4",children:e.jsxs(U,{onSubmit:k,children:[e.jsx("h1",{children:"Register New User"}),C&&e.jsx(b,{color:"danger",className:"text-center w-75 mx-auto",children:C}),f&&e.jsx(b,{color:"success",className:"text-center w-75 mx-auto",children:f}),e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{children:e.jsx(h,{icon:D})}),e.jsx(u,{placeholder:"Username",autoComplete:"off",id:"username",value:r.username,onChange:o,required:!0,disabled:a})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{children:"@"}),e.jsx(u,{placeholder:"Email",autoComplete:"off",id:"email",value:r.email,onChange:o,required:!0,type:"email",disabled:a})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{children:e.jsx(h,{icon:N})}),e.jsx(u,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",value:r.password,onChange:o,required:!0,disabled:a})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(l,{children:e.jsx(h,{icon:N})}),e.jsx(u,{type:"password",placeholder:"Repeat password",autoComplete:"off",id:"repeatPassword",value:r.repeatPassword,onChange:o,required:!0,disabled:a})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{children:"Role"}),e.jsxs(G,{id:"role",value:r.role,onChange:o,disabled:a,children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"inspector",children:"Inspector"}),e.jsx("option",{value:"driver",children:"Driver"})]})]}),e.jsx(y,{color:"success",type:"submit",disabled:a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(F,{size:"sm"})," Loading..."]}):"Create"}),e.jsx(y,{color:"secondary",className:"ms-2",onClick:R,disabled:a,children:"Back"})]})})})})})})})};export{re as default};
