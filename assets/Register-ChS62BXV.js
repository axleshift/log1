import{m as P,r as t,j as e,k as I,n as L}from"./index-fwpOMQ2X.js";import{C as x}from"./index.esm-Bos4FKB3.js";import{C as q}from"./CContainer-ngKw1IHC.js";import{a as B,C as E}from"./CRow-CbvayGWD.js";import{C as M}from"./CCard-CneYbX6n.js";import{C as A}from"./CCardBody-CXuHd7MQ.js";import{C as T}from"./CForm-CZGnxRKF.js";import{C as b}from"./CAlert-Cc5TYcDk.js";import{C as n}from"./CInputGroup-BDqpQ704.js";import{C as l}from"./CInputGroupText-Du0CP68y.js";import{c as U}from"./cil-user-Ddrdy7PS.js";import{C as u}from"./CFormInput-CN5nRk86.js";import{c as N}from"./cil-lock-locked-DmxpJbVL.js";import{C as G}from"./CFormSelect-D7wAQ3TU.js";import{a as S}from"./CButton-lWH0XktP.js";const re=()=>{const j=P(),[a,y]=t.useState({username:"",email:"",password:"",repeatPassword:"",role:"",photo:null}),[C,i]=t.useState(null),[f,g]=t.useState(null),[r,p]=t.useState(!1),[z,D]=t.useState(null),o=h=>{const{id:c,value:d}=h.target;y(m=>({...m,[c]:d}))},k=async h=>{var c,d,m,v,w;h.preventDefault(),p(!0),i(null);try{if(a.password!==a.repeatPassword){i("Passwords do not match"),p(!1);return}const s=await L.post("api/v1/user/register",a);s.data&&s.data.success?(g("Registration successful"),s.data.token&&sessionStorage.setItem("accessToken",s.data.token),setTimeout(()=>{g(null),j("/dashboard")},2e3)):i(((c=s.data)==null?void 0:c.message)||"Registration failed")}catch(s){console.error("Full error details:",{message:s.message,response:(d=s.response)==null?void 0:d.data,status:(m=s.response)==null?void 0:m.status});const F=((w=(v=s.response)==null?void 0:v.data)==null?void 0:w.message)||s.message||"An error occurred during registration";i(F)}finally{p(!1)}},R=()=>{j("/dashboard")};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(q,{children:e.jsx(B,{className:"justify-content-center",children:e.jsx(E,{md:9,lg:7,xl:6,children:e.jsx(M,{className:"mx-4",children:e.jsx(A,{className:"p-4",children:e.jsxs(T,{onSubmit:k,children:[e.jsx("h1",{children:"Register New User"}),C&&e.jsx(b,{color:"danger",className:"text-center w-75 mx-auto",children:C}),f&&e.jsx(b,{color:"success",className:"text-center w-75 mx-auto",children:f}),e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{children:e.jsx(x,{icon:U})}),e.jsx(u,{placeholder:"Username",autoComplete:"off",id:"username",value:a.username,onChange:o,required:!0,disabled:r})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{children:"@"}),e.jsx(u,{placeholder:"Email",autoComplete:"off",id:"email",value:a.email,onChange:o,required:!0,type:"email",disabled:r})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{children:e.jsx(x,{icon:N})}),e.jsx(u,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",value:a.password,onChange:o,required:!0,disabled:r})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(l,{children:e.jsx(x,{icon:N})}),e.jsx(u,{type:"password",placeholder:"Repeat password",autoComplete:"off",id:"repeatPassword",value:a.repeatPassword,onChange:o,required:!0,disabled:r})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(l,{children:"Role"}),e.jsxs(G,{id:"role",value:a.role,onChange:o,disabled:r,children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"chief mechanic",children:"Chief mechanic"}),e.jsx("option",{value:"fleet manager",children:"Fleet Manager"}),e.jsx("option",{value:"scheduler",children:"Scheduler"}),e.jsx("option",{value:"warehouse manager",children:"Warehouse Manager"}),e.jsx("option",{value:"receiving clerk",children:"Receiving Clerk"})]})]}),e.jsx(S,{color:"success",type:"submit",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"sm"})," Loading..."]}):"Create"}),e.jsx(S,{color:"secondary",className:"ms-2",onClick:R,disabled:r,children:"Back"})]})})})})})})})};export{re as default};
