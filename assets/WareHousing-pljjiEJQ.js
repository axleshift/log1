import{r as c,A as ie,j as e,k as V,n as Z,l as oe,E as U,m as pe}from"./index-DP-6o1Ky.js";import{F as G,k as le,H as ve,m as Ne,a as z}from"./index-g5O3o-Ix.js";import{C as M}from"./CAlert-B_Y39mMu.js";import{C as B}from"./CContainer-Bm_J4ctF.js";import{C as ee}from"./CInputGroup-Bbkatvq2.js";import{C as se}from"./CFormInput-D80Xx8QS.js";import{C as re}from"./CInputGroupText-BX58af7r.js";import{C as de,a as he,b as ue,c as xe}from"./CAccordionHeader-z9192-DY.js";import{C as me,a as je,b as Y,c as b,d as ge,e as S}from"./CTable-H3ASDLst.js";import{C as te,a as E}from"./CPaginationItem-9GWkHQgm.js";import{a as we}from"./CButton-fBjdpGOu.js";import{C as Ce,a as ye,b as J,c as X}from"./CTabList-BIiXB2Gg.js";import{a as be,C as ne}from"./DefaultLayout-DG0zCQFF.js";import{C as ce}from"./CCard-Cfs72Y-Z.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";import"./index.esm-vCMPmUNq.js";import"./1-7zT8qG6k.js";import"./cil-user-Ddrdy7PS.js";const Se=({warehousing:p,loading:A,error:D,onDeleteItem:u,onUpdateItem:P})=>{const[m,v]=c.useState([]),[I,g]=c.useState(null),[w,$]=c.useState("");ie();const[f,j]=c.useState(1),[W]=c.useState(10),[N,L]=c.useState([]),l=Math.ceil(m.length/W),o=m.filter(a=>a.received===!0),d=f*W,C=d-W,_=o.slice(C,d);c.useEffect(()=>{try{if(w===""){v(p),g(null);return}const a=w.toLowerCase().trim(),h=p.filter(s=>{var r,i,t,n,x,y,R,F,O;try{return((r=s.poNumber)==null?void 0:r.toLowerCase().includes(a))||((t=(i=s.vendor)==null?void 0:i.businessName)==null?void 0:t.toLowerCase().includes(a))||((x=(n=s.vendor)==null?void 0:n.businessAddress)==null?void 0:x.toLowerCase().includes(a))||((R=(y=s.vendor)==null?void 0:y.contactNumber)==null?void 0:R.includes(a))||s.orderDate&&new Date(s.orderDate).toLocaleDateString().includes(a)||s.dateOfReceived&&new Date(s.receiveDate).toLocaleDateString().includes(a)||((F=k(s.warehouseId))==null?void 0:F.toLowerCase().includes(a))||((O=s.details)==null?void 0:O.some(T=>{var Q,q,H;return((Q=T.description)==null?void 0:Q.toLowerCase().includes(a))||((q=T.quantity)==null?void 0:q.toString().includes(a))||((H=T.unitPrice)==null?void 0:H.toString().includes(a))}))}catch(T){return console.error("Error filtering item:",T),!1}});v(h),j(1),h.length===0?g("No data found"):g(null)}catch(a){console.error("Error in search effect:",a),g("Error occurred while searching")}},[w,p]),c.useEffect(()=>{(async()=>{var h;try{const s=await Z.get("/api/v1/warehouseLoc/locations");s.data.data&&L(s.data.data)}catch(s){g((h=s==null?void 0:s.response)==null?void 0:h.data.message)}})()},[]);const k=a=>{if(!N.length)return"Loading...";const h=N.find(s=>s._id===a);return h?h.warehouseName:"Unknown Warehouse"},K=a=>{$(a.target.value)};return A?e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):p.length===0?e.jsx(M,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):D?e.jsxs(M,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",D.message]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mt-3",children:e.jsxs(ee,{className:"w-50 mb-3",children:[e.jsx(se,{type:"text",placeholder:"Search by PO Number, Vendor, or Products...",value:w,id:"searchItem",onChange:K}),e.jsx(re,{children:e.jsx(G,{icon:le})})]})}),A?e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):p.length===0?e.jsx(M,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[I&&e.jsx(M,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:I}),e.jsx(de,{className:"m-2",children:_.filter(a=>a.received).map(a=>e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[e.jsx("div",{children:e.jsxs("ul",{className:"list-unstyled",children:[e.jsxs("li",{children:["PO Number: ",e.jsx("strong",{children:a.poNumber})]}),e.jsxs("li",{children:["Warehuse Location:"," ",e.jsx("strong",{children:k(a.warehouse_id)})]})]})}),e.jsxs("div",{className:"text-medium-emphasis",children:["Order Date: ",new Date(a.orderDate).toLocaleDateString()]})]})}),e.jsxs(xe,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Vendor Information"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",a.vendor.businessName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",a.vendor.businessAddress]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"})," ",a.vendor.contactNumber]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Shipping Details"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Carrier:"})," ",a.carrier]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Expected Delivery Date:"})," ",new Date(a.receiveDate).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Products"}),e.jsxs(me,{responsive:!0,small:!0,className:"mt-2",children:[e.jsx(je,{children:e.jsxs(Y,{children:[e.jsx(b,{children:"Description"}),e.jsx(b,{children:"Quantity"})]})}),e.jsx(ge,{children:a.details.map((h,s)=>e.jsxs(Y,{children:[e.jsx(S,{children:h.description}),e.jsx(S,{children:h.quantity})]},s))})]})]}),a.additionalNotes&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Additional Notes"}),e.jsx("div",{className:"ms-3",children:a.additionalNotes})]})]})]},a._id))}),_.length>0&&e.jsxs(B,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:["Showing ",o.length>0?C+1:0," to"," ",Math.min(d,o.length)," of ",o.length," received entries"]}),e.jsxs(te,{className:"mt-3",children:[e.jsx(E,{disabled:f===1,onClick:()=>j(a=>Math.max(a-1,1)),children:"Previous"}),Array.from({length:l},(a,h)=>h+1).map(a=>e.jsx(E,{active:a===f,onClick:()=>j(a),children:a},a)),e.jsx(E,{disabled:f===l,onClick:()=>j(a=>Math.min(a+1,l)),children:"Next"})]})]})]})]})},De=({onAddItem:p})=>{const{showError:A,showSuccess:D}=oe(),[u,P]=c.useState([]),[m,v]=c.useState(1),[I,g]=c.useState(null),[w,$]=c.useState(!0),[f,j]=c.useState(""),[W,N]=c.useState([]),[L,l]=c.useState([]),o=10;c.useEffect(()=>{(async()=>{var i;try{const t=await U.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");t.status===200?P(t.data):g(t.data.message||"Error fetching data")}catch(t){console.error("Error fetching data:",t),g(((i=t==null?void 0:t.response)==null?void 0:i.data.message)||"Error fetching data")}})()},[]);const d=async r=>{var i,t;try{if((await U.put(`https://backend-log2.axleshift.com/api/v1/purchaseOrder/${r}`,{received:!0,receiveDate:new Date().toISOString()})).status===200){const x=await U.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");P(x.data),D("Item received successfully")}}catch(n){console.error("Error updating purchase order:",n),A(((t=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:t.message)||"Error updating purchase order")}};c.useEffect(()=>{(async()=>{var i,t;try{const n=await Z.get("/api/v1/warehouseLoc/locations");n.data.data&&(l(n.data.data),D(n.data.message))}catch(n){g((i=n==null?void 0:n.response)==null?void 0:i.data.message),A(((t=n==null?void 0:n.response)==null?void 0:t.data.message)||"Error fetching warehouses")}})()},[]);const C=r=>{if(!L.length)return"Loading...";const i=L.find(t=>t._id===r);return i?i.warehouseName:"Unknown Warehouse"};if(c.useEffect(()=>{$(!1)},[]),c.useEffect(()=>{if(f===""){P(u);return}const r=f.toLowerCase().trim(),i=u.filter(t=>{var n,x,y,R,F,O,T,Q,q;try{return((n=t.poNumber)==null?void 0:n.toLowerCase().includes(r))||((y=(x=t.vendor)==null?void 0:x.businessName)==null?void 0:y.toLowerCase().includes(r))||((F=(R=t.vendor)==null?void 0:R.businessAddress)==null?void 0:F.toLowerCase().includes(r))||((T=(O=t.vendor)==null?void 0:O.contactNumber)==null?void 0:T.toLowerCase().includes(r))||((Q=t.carrier)==null?void 0:Q.toLowerCase().includes(r))||t.orderDate&&new Date(t.orderDate).toLocaleDateString().includes(r)||t.receiveDate&&new Date(t.receiveDate).toLocaleDateString().includes(r)||((q=t.details)==null?void 0:q.some(H=>{var ae;return(ae=H.description)==null?void 0:ae.toLowerCase().includes(r)}))}catch(H){return console.error("Error filtering data:",H),!1}});P(i),v(1),g(i.length===0?"No results found":null)},[f]),w)return e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"});const _=m*o,k=_-o,K=u.slice(k,_),a=Math.ceil(u.length/o),h=r=>{j(r.target.value)};if(u.filter(r=>!r.received).length===0)return e.jsx(M,{color:"danger",className:"text-center mt-3 w-75 mx-auto",children:"No items to receive."});const s=({icon:r})=>{const[i,t]=c.useState(!1);return e.jsx(G,{icon:r,bounce:i,onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mt-3",children:e.jsxs(ee,{className:"w-50 mb-3",children:[e.jsx(se,{type:"text",placeholder:"Search by PO Number, Supplier, or Item Name",value:f,id:"searchInput4",onChange:h}),e.jsx(re,{children:e.jsx(G,{icon:le})})]})}),e.jsxs(me,{hover:!0,responsive:!0,children:[e.jsx(je,{children:e.jsxs(Y,{children:[e.jsx(b,{children:"PO Number"}),e.jsx(b,{children:"Order Date"}),e.jsx(b,{children:"Date to Receive"}),e.jsx(b,{children:"Carrier"}),e.jsx(b,{children:"Warehouse"}),e.jsx(b,{children:"Vendor"}),e.jsx(b,{children:"Products"}),e.jsx(b,{children:"Receive"}),e.jsx(b,{children:"Actions"})]})}),e.jsx(ge,{children:K.filter(r=>!r.received).map((r,i)=>e.jsxs(Y,{children:[e.jsx(S,{children:r.poNumber}),e.jsx(S,{children:new Date(r.orderDate).toLocaleDateString()}),e.jsx(S,{children:new Date(r.receiveDate).toLocaleDateString()}),e.jsx(S,{children:r.carrier}),e.jsx(S,{children:C(r.warehouse_id)}),e.jsxs(S,{children:[e.jsx("div",{children:r.vendor.businessName}),e.jsx("small",{className:"text-medium-emphasis",children:r.vendor.contactNumber})]}),e.jsx(S,{children:r.details.map((t,n)=>e.jsxs("div",{children:[" ",t.description," ( pcs: ",t.quantity," x"," ",t.unitPrice.toFixed(2)," )"]},`${r._id}-${t._id||n}`))}),e.jsx(S,{children:r.received?"Yes":"No"}),e.jsx(S,{children:e.jsxs(we,{color:"primary",className:"mt-2",onClick:()=>d(r._id),children:[e.jsx(s,{icon:ve})," Complete"]})})]},r._id||`item-${i}`))})]}),u.filter(r=>!r.received).length>0&&e.jsxs(B,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(B,{children:["Showing ",k+1," to ",Math.min(_,u.length)," of"," ",u.length," entries"]}),e.jsxs(te,{className:"mt-3",children:[e.jsx(E,{disabled:m===1,onClick:()=>v(r=>Math.max(r-1,1)),children:"Previous"}),[...Array(a).keys()].map(r=>e.jsx(E,{active:r+1===m,onClick:()=>v(r+1),children:r+1},r+1)),e.jsx(E,{disabled:m===a,onClick:()=>v(r=>Math.min(r+1,a)),children:"Next"})]})]}),I&&e.jsx(M,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:I})]})},Ie=`
  .locations-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .location-item {
    display: flex;
    flex-direction: column;
    padding: 8px;
    background-color: #f8f9fa;
    border-radius: 4px;
    width: fit-content;

  }

  .location-details {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
  }

  .warehouse-name {
    font-weight: 500;
    color: #495057;
  }

  .warehouse-address {
    color: #6c757d;
    font-size: 0.9em;
    font-style: italic;
  }

  .quantity-badge {
    background-color: #e9ecef;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.85em;
    color: #495057;
  }

`,fe=document.createElement("style");fe.innerText=Ie;document.head.appendChild(fe);const Le=()=>{const{showError:p,showSuccess:A}=oe(),[D,u]=c.useState([]),[P,m]=c.useState(!0),[v,I]=c.useState(""),[g,w]=c.useState(null),[$,f]=c.useState(null),[j,W]=c.useState([]),[N,L]=c.useState(1),[l]=c.useState(10);pe();const o=async()=>{var s,r,i,t;m(!0);try{const n=await U.get("https://backend-log2.axleshift.com/api/v1/shipment");if(n.status===200){const x=n.data.shipments||[];u(x),w(null)}}catch(n){w(((r=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:r.message)||"Error fetching data"),p(((t=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:t.message)||"Error fetching data")}finally{m(!1)}};c.useEffect(()=>{o()},[]),c.useEffect(()=>{(async()=>{var r,i;try{const t=await Z.get("/api/v1/warehouseLoc/locations");t.data.data&&W(t.data.data)}catch(t){f((r=t==null?void 0:t.response)==null?void 0:r.data.message),p(((i=t==null?void 0:t.response)==null?void 0:i.data.message)||"Error fetching warehouses")}})()},[]);const d=s=>{if(!j.length)return"Loading...";const r=j.find(i=>i._id===s);return r?e.jsx(z,{color:"success",children:r.warehouseName}):e.jsx(z,{color:"danger",children:"Not Yet Assigned"})},C=Array.isArray(D)?D.filter(s=>{var i,t,n,x,y;const r=v.toLowerCase();return((i=s==null?void 0:s.tracking_id)==null?void 0:i.toLowerCase().includes(r))||((n=(t=s==null?void 0:s.shipper)==null?void 0:t.shipper_company_name)==null?void 0:n.toLowerCase().includes(r))||((x=s==null?void 0:s.dispatch)==null?void 0:x.toLowerCase().includes(r))||((y=s==null?void 0:s.warehouse_id)==null?void 0:y.toString().includes(r))}):[],_=N*l,k=_-l,K=C.slice(k,_),a=Math.ceil(C.length/l),h=s=>{switch(s==null?void 0:s.toLowerCase()){case"pending":return"warning";case"completed":return"success";case"cancelled":return"danger";default:return"info"}};return P?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"60vh"},children:e.jsx(V,{color:"primary"})}):e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs(ee,{className:"mb-2 mt-2",children:[e.jsx(se,{type:"text",id:"searchInput",placeholder:"Search by tracking ID, shipper, status, warehouse...",value:v,onChange:s=>I(s.target.value)}),e.jsx(re,{children:e.jsx(G,{icon:Ne})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"text-end",children:e.jsxs("span",{className:"text-muted",children:["Total Records:"," ",C.filter(s=>s.isInWarehouse&&s.dispatch!=="Completed").length]})})})]})}),C.length>0?e.jsxs(e.Fragment,{children:[e.jsx(de,{flush:!0,children:K.filter(s=>s.isInWarehouse&&s.dispatch!=="Completed").map(s=>{var r,i,t,n,x,y,R,F,O;return e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Tracking ID:"})," ",s.tracking_id]}),e.jsxs("div",{className:"d-flex gap-3 me-3",children:[d(s.warehouse_id),e.jsx(z,{color:h(s.dispatch),children:s.dispatch||"N/A"})]})]})}),e.jsxs(xe,{children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"mb-3",children:"Shipper Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Company:"})," ",((r=s.shipper)==null?void 0:r.shipper_company_name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((i=s.shipper)==null?void 0:i.shipper_company_address)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",((t=s.shipper)==null?void 0:t.shipper_contact_name)||"N/A"]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"mb-3",children:"Consignee Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Company:"})," ",((n=s.consignee)==null?void 0:n.consignee_company_name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",((x=s.consignee)==null?void 0:x.consignee_company_address)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",((y=s.consignee)==null?void 0:y.consignee_contact_name)||"N/A"]})]})]}),e.jsx("div",{className:"row mt-3",children:e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"mb-3",children:"Vehicle Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vehicle:"})," ",(R=s.vehicle)!=null&&R.name&&((F=s.vehicle)!=null&&F.plate_no)?`${s.vehicle.name} (${s.vehicle.plate_no})`:"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Driver:"})," ",((O=s.vehicle)==null?void 0:O.driver_name)||"N/A"]})]})})]})]},s.tracking_id||Math.random())})}),a>1&&e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-muted",children:["Showing ",k+1," to"," ",Math.min(_,C.filter(s=>s.isInWarehouse&&s.dispatch!=="Completed").length)," ","of"," ",C.filter(s=>s.isInWarehouse&&s.dispatch!=="Completed").length," ","entries"]})}),e.jsxs(te,{"aria-label":"Page navigation",children:[e.jsx(E,{"aria-label":"Previous",disabled:N===1,onClick:()=>L(N-1),children:e.jsx("span",{"aria-hidden":"true",children:"Previous"})}),[...Array(a)].map((s,r)=>e.jsx(E,{active:N===r+1,onClick:()=>L(r+1),children:r+1},r+1)),e.jsx(E,{"aria-label":"Next",disabled:N===a,onClick:()=>L(N+1),children:e.jsx("span",{"aria-hidden":"true",children:"Next"})})]})]})]}):e.jsx(M,{color:"info",className:"text-center p-4",children:"No shipment records found"})]})},Ve=()=>{const p=ie(),A=["admin","super admin ","warehouse manager","receiving clerk"],[D,u]=c.useState([]),[P,m]=c.useState([]),[v,I]=c.useState(!1),[g,w]=c.useState(null),[$,f]=c.useState(0);c.useEffect(()=>{(async()=>{I(!0);try{const o=await U.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");o.status===200&&u(o.data)}catch(o){w(o.message)}finally{I(!1)}})()},[$]);const j=()=>{f(l=>l+1)},W=l=>{u(o=>[...o,l]),m(o=>[...o,l]),j()},N=l=>{u(o=>o.filter(d=>d._id!==l)),m(o=>o.filter(d=>d._id!==l)),j()},L=l=>{u(o=>o.map(d=>d._id===l._id?l:d)),m(o=>o.map(d=>d._id===l._id?l:d)),j()};return e.jsx(e.Fragment,{children:p&&A.includes(p)?e.jsxs(e.Fragment,{children:[" ",e.jsxs(Ce,{activeItemKey:"Warehouse Items Details",children:[e.jsxs(ye,{variant:"tabs",children:[e.jsx(J,{itemKey:"Warehouse Items Details",children:"Warehouse Items Details"}),e.jsx(J,{itemKey:"For Receiving",children:"For Receiving"}),e.jsx(J,{itemKey:"Shipment",children:"Warehouse Shipment Items"})]}),e.jsxs(be,{children:[e.jsx(X,{className:"p-3",itemKey:"Warehouse Items Details",children:e.jsx(Se,{warehousing:D,loading:v,error:g,onDeleteItem:N,onUpdateItem:L,onRefresh:j})}),e.jsx(X,{className:"p-3",itemKey:"For Receiving",children:e.jsxs(ce,{children:[e.jsx(ne,{children:"Item Reiceving"}),e.jsx(De,{onAddItem:W})]})}),e.jsx(X,{className:"p-3",itemKey:"Shipment",children:e.jsxs(ce,{children:[e.jsx(ne,{children:"Shipment"}),e.jsx(Le,{})]})})]})]})]}):e.jsx(M,{color:"danger",className:"text-center justify-content-center m-5",children:"You do not have permission to access this page."})})};export{Ve as default};
