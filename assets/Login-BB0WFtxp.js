import{r as t,i as k,j as e,w as T}from"./index-nNgQDi3y.js";import{C as f}from"./index.esm-BuKqvEan.js";import{C as R}from"./CContainer-XXKGP3D5.js";import{C,a as g}from"./CRow-JFXe5p0a.js";import{C as E}from"./CCardGroup-3cDpDrSa.js";import{C as U}from"./CCard-C11t10-G.js";import{C as G}from"./CCardBody-D9zCfA2H.js";import{C as q}from"./CForm-C8WwGFvM.js";import{C as j}from"./CAlert-Da4UQtJl.js";import{C as y,a as b}from"./CInputGroupText-I3x9P6oS.js";import{c as A}from"./cil-user-Ddrdy7PS.js";import{C as S}from"./CFormInput-C49UErcb.js";import{c as B}from"./cil-lock-locked-DmxpJbVL.js";import{C as D}from"./CButton-B31Ato4o.js";import"./CCloseButton-U_0zd53e.js";import"./CLink-B-ouRo4I.js";const F="http://localhost:5057",P=T.create({baseURL:F}),re=()=>{const v={username:"",password:""},[a,w]=t.useState(v),[m,L]=t.useState(null),[l,d]=t.useState(!1),[p,n]=t.useState(""),N=k(),u=i=>{const{id:r,value:o}=i.target;w(s=>({...s,[r]:o}))},I=async i=>{var r,o;i.preventDefault(),d(!0),n("");try{const s=await P.post("/api/v1/user/login",a);if(s.data.success){const{accessToken:h,refreshToken:c,user:x}=s.data;if(console.log("Login Response:",{accessToken:!!h,refreshToken:!!c,user:x}),!c)throw new Error("Refresh token not received from server");sessionStorage.setItem("accessToken",h),sessionStorage.setItem("refreshToken",c),sessionStorage.setItem("user",JSON.stringify(x)),L(s.data.message),setTimeout(()=>{N("/dashboard")},2e3)}}catch(s){n(((o=(r=s.response)==null?void 0:r.data)==null?void 0:o.message)||s.message),setTimeout(()=>{n(null)},2e3)}finally{d(!1)}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(R,{children:e.jsx(C,{className:"justify-content-center",children:e.jsx(g,{md:4,sm:2,children:e.jsx(E,{children:e.jsx(U,{className:"p-4",children:e.jsx(G,{children:e.jsxs(q,{onSubmit:I,children:[m&&e.jsx(j,{color:"success",className:"text-success mb-3",children:m}),p&&e.jsx(j,{color:"danger",className:"text-danger mb-3",children:p}),e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(y,{className:"mb-3",children:[e.jsx(b,{children:e.jsx(f,{icon:A})}),e.jsx(S,{type:"text",placeholder:"Username",autoComplete:"off",id:"username",required:!0,value:a.username,onChange:u})]}),e.jsxs(y,{className:"mb-4",children:[e.jsx(b,{children:e.jsx(f,{icon:B})}),e.jsx(S,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",required:!0,value:a.password,onChange:u})]}),e.jsx(C,{children:e.jsx(g,{xs:6,children:e.jsx(D,{color:"primary",className:"px-4",type:"submit",disabled:l,children:l?"Logging in...":"Login"})})})]})})})})})})})})};export{re as default};
