import{A as ne,r as o,j as e,k as J,m as $,B as we,D as ye}from"./index-CBxfVCnW.js";import{F as X,q as Ce,g as Se,e as oe,n as De,a as he}from"./index-DO91gsH_.js";import{C as T}from"./CAlert-DFLa4UkT.js";import{a as V}from"./CButton-CvkYH3u1.js";import{C as xe,a as je,b as fe,c as ge,d as pe}from"./CModalTitle-mLq3Bba8.js";import{C as Ne}from"./CForm-DbmLsh8o.js";import{C as be}from"./CFormSelect-Ma-FgG2p.js";import{C as M}from"./CContainer-8h-cWebf.js";import{C as G}from"./CInputGroup-D3qmWAMp.js";import{C as W}from"./CFormInput-D0vTu7gA.js";import{C as ce}from"./CInputGroupText-BMvM9Gre.js";import{C as Ie,a as Le,b as Pe,c as Ae}from"./CAccordionHeader-qQa3uuPC.js";import{C as Z,a as ee,b as H,c as C,d as se,e as S}from"./CTable-DvOzw_Um.js";import{C as ie,a as Q}from"./CPaginationItem-UhbDrKnl.js";import{C as Ee}from"./CFormTextarea-2TN6ZhKr.js";import{C as te,a as ke}from"./DefaultLayout-ByvImuSO.js";import{C as qe,a as Re,b as re,c as ae}from"./CTabList-BvPd1eam.js";import{C as me}from"./CCard-BmLVAJhI.js";import"./index.esm-Blgw_BRm.js";import"./1-yy9nY0n7.js";import"./cil-user-Ddrdy7PS.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const We=({warehousing:x,onDeleteItem:n})=>{const{showError:E,showSuccess:p}=ne(),[N,l]=o.useState(null),[P,I]=o.useState(!1),D=async()=>{I(!0);const h=await $.delete(`/api/v1/warehouse/delete/${x._id}`);h.data.success?(p(h.data.message),n(x._id),I(!1)):(I(!1),l(h.data.message),E(h.data.message))};return N?e.jsxs(T,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",N.message]}):e.jsx(e.Fragment,{children:e.jsx(V,{color:"danger",variant:"outline",onClick:D,className:"me-2",children:P?e.jsx(J,{size:"sm"}):e.jsx(X,{icon:Ce})})})},Te=({warehousing:x,onUpdateItem:n})=>{const{showSuccess:E,showErrors:p}=ne(),[N,l]=o.useState(null),[P,I]=o.useState(!1),[D,h]=o.useState(null),[L,b]=o.useState(!1),[k,R]=o.useState([]),[d,t]=o.useState({warehouse:x.warehouse||"",warehouseLocDetails:{warehouseName:x.warehouseName||"",address:x.address||""},byReceived:""});o.useEffect(()=>{(async()=>{try{const a=await $.get("/api/v1/warehouseLoc/locations");R(a.data.data)}catch(a){l(a.response.data.message),p(a.response.data.message)}})()},[]);const m=v=>{const a=v.target.value,f=k.find(r=>r._id===a);t(r=>({...r,warehouse:a,warehouseLocDetails:{warehouseName:f?f.warehouseName:"",address:f?f.address:""}}))},F=async v=>{v.preventDefault();const f=JSON.parse(sessionStorage.getItem("user")).email;if(!f){l("User email not found. Please log in again.");return}const r=k.find(i=>i._id===d.warehouse);if(!r){l("Warehouse not found.");return}d.warehouseLocDetails={warehouseName:r.warehouseName,address:r.address},I(!0);try{const i=await $.patch(`/api/v1/warehouse/update/${x._id}`,{...d,byReceived:f});if(i.data.success){const s=i.data.data,w=k.find(j=>j._id===s.warehouse);s.warehouse=w,E(i.data.message),n(i.data.data),setTimeout(()=>{h(null),b(!1)},2e3)}}catch(i){l(i.response.data.message),p(i.response.data.message),setTimeout(()=>{l(null)},2e3)}I(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(V,{color:"primary",variant:"outline",className:"me-2",onClick:()=>b(!0),children:P?e.jsx(J,{size:"sm"}):e.jsx(X,{icon:Se})}),e.jsxs(xe,{visible:L,onClose:()=>b(!1),children:[e.jsx(je,{children:e.jsx(fe,{children:"Recieved Items"})}),N&&e.jsx(T,{color:"danger",children:N}),D&&e.jsx(T,{color:"success",children:D}),e.jsx(ge,{children:e.jsx(Ne,{children:e.jsxs(be,{id:"warehouse",floatingLabel:"Warehouse",className:"mb-3",value:d.warehouse,onChange:m,required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),k.map(v=>e.jsxs("option",{value:v._id,children:[v.warehouseName," - ",v.address]},v._id))]})})}),e.jsxs(pe,{children:[e.jsx(V,{color:"secondary",variant:"outline",onClick:()=>b(!1),children:"Close"}),e.jsx(V,{color:"primary",variant:"outline",onClick:F,children:"Update Item"})]})]})]})},Fe=({warehousing:x,loading:n,error:E,onDeleteItem:p,onUpdateItem:N})=>{const[l,P]=o.useState([]),[I,D]=o.useState(null),[h,L]=o.useState(""),b=we(),k=["manager","admin"],[R,d]=o.useState(1),[t]=o.useState(10),m=R*t,F=m-t,v=l.slice(F,m),a=Math.ceil(l.length/t);o.useEffect(()=>{try{if(h===""){P(x),D(null);return}const r=h.toLowerCase().trim(),i=x.filter(s=>{var w,j,_,B,u,c,g,y,A,O,U,q,K,Y;try{return((w=s.poNumber)==null?void 0:w.toLowerCase().includes(r))||((_=(j=s.warehouseLocDetails)==null?void 0:j.warehouseName)==null?void 0:_.toLowerCase().includes(r))||((u=(B=s.warehouseLocDetails)==null?void 0:B.address)==null?void 0:u.toLowerCase().includes(r))||((g=(c=s.vendor)==null?void 0:c.businessName)==null?void 0:g.toLowerCase().includes(r))||((A=(y=s.vendor)==null?void 0:y.businessAddress)==null?void 0:A.toLowerCase().includes(r))||((U=(O=s.vendor)==null?void 0:O.contactNumber)==null?void 0:U.includes(r))||s.orderDate&&new Date(s.orderDate).toLocaleDateString().includes(r)||s.dateOfReceived&&new Date(s.receiveDate).toLocaleDateString().includes(r)||(((K=(q=s.byReceived)==null?void 0:q.toString().toLowerCase())==null?void 0:K.includes(r))??!1)||((Y=s.details)==null?void 0:Y.some(z=>{var le,de,ue;return((le=z.description)==null?void 0:le.toLowerCase().includes(r))||((de=z.quantity)==null?void 0:de.toString().includes(r))||((ue=z.unitPrice)==null?void 0:ue.toString().includes(r))}))}catch(z){return console.error("Error filtering item:",z),!1}});P(i),d(1),i.length===0?D("No data found"):D(null)}catch(r){console.error("Error in search effect:",r),D("Error occurred while searching")}},[h,x]);const f=r=>{L(r.target.value)};return n?e.jsx(J,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):x.length===0?e.jsx(T,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"mt-3",children:e.jsxs(G,{className:"w-50 mb-3",children:[e.jsx(W,{type:"text",placeholder:"Search by PO Number, Vendor, or Products...",value:h,id:"searchItem",onChange:f}),e.jsx(ce,{children:e.jsx(X,{icon:oe})})]})}),n?e.jsx(J,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):x.length===0?e.jsx(T,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[I&&e.jsx(T,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:I}),e.jsx(Ie,{className:"m-2",children:v.map(r=>e.jsxs(Le,{children:[e.jsx(Pe,{children:e.jsxs("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[e.jsx("div",{children:e.jsxs("ul",{className:"list-unstyled",children:[e.jsxs("li",{children:["PO Number: ",e.jsx("strong",{children:r.poNumber})]}),e.jsxs("li",{children:["Warehuse Location: ",e.jsx("strong",{children:r.warehouse.warehouseName})]})]})}),e.jsxs("div",{className:"text-medium-emphasis",children:["Order Date: ",new Date(r.orderDate).toLocaleDateString()]})]})}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Vendor Information"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",r.vendor.businessName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",r.vendor.businessAddress]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"})," ",r.vendor.contactNumber]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Shipping Details"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Carrier:"})," ",r.carrier]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Receive Date:"})," ",new Date(r.receiveDate).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Products"}),e.jsxs(Z,{responsive:!0,small:!0,className:"mt-2",children:[e.jsx(ee,{children:e.jsxs(H,{children:[e.jsx(C,{children:"Description"}),e.jsx(C,{children:"Quantity"}),e.jsx(C,{children:"Received By"}),e.jsx(C,{children:"Received Date"})]})}),e.jsx(se,{children:r.details.map((i,s)=>e.jsxs(H,{children:[e.jsx(S,{children:i.description}),e.jsx(S,{children:i.quantity}),e.jsx(S,{children:r.byReceived}),e.jsx(S,{children:r.dateOfReceived?new Date(r.dateOfReceived).toLocaleDateString():"N/A"})]},s))})]})]}),r.additionalNotes&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Additional Notes"}),e.jsx("div",{className:"ms-3",children:r.additionalNotes})]}),e.jsxs(M,{className:"d-flex justify-content-end mt-3",children:[e.jsx(Te,{warehousing:r,onUpdateItem:N}),k.includes(b)&&e.jsx(We,{warehousing:r,onDeleteItem:p})]})]})]},r._id))}),l.length>0&&e.jsxs(M,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:["Showing ",F+1," to"," ",Math.min(m,l.length)," of"," ",l.length," entries"]}),e.jsxs(ie,{className:"mt-3",children:[e.jsx(Q,{disabled:R===1,onClick:()=>d(r=>Math.max(r-1,1)),children:"Previous"}),Array.from({length:a},(r,i)=>i+1).map(r=>e.jsx(Q,{active:r===R,onClick:()=>d(r),children:r},r)),e.jsx(Q,{disabled:R===a,onClick:()=>d(r=>Math.min(r+1,a)),children:"Next"})]})]})]})]})},Oe=({onAddItem:x,item:n={}})=>{var s,w,j,_,B;const{showSuccess:E,showError:p}=ne(),[N,l]=o.useState("Add Item"),[P,I]=o.useState(!1),[D,h]=o.useState(!1),[L,b]=o.useState(""),[k,R]=o.useState([]),d=new Date().toISOString().split("T")[0],[t,m]=o.useState({poNumber:n.poNumber||"",orderDate:n.orderDate||d,receiveDate:n.receiveDate||d,carrier:n.carrier||"",vendor:{businessName:((s=n==null?void 0:n.vendor)==null?void 0:s.businessName)||"",businessAddress:((w=n==null?void 0:n.vendor)==null?void 0:w.businessAddress)||"",contactNumber:((j=n==null?void 0:n.vendor)==null?void 0:j.contactNumber)||""},warehouse:n.warehouse||"",warehouseLocDetails:{warehouseName:((_=n==null?void 0:n.warehouseLocDetails)==null?void 0:_.warehouseName)||"",address:((B=n==null?void 0:n.warehouseLocDetails)==null?void 0:B.address)||""},details:n.details||[{productId:"",description:"",quantity:""}],procurementId:n.procurementId||"",rfqId:n.rfqId||null,vendorId:n.vendorId||"",additionalNotes:n.additionalNotes||"",byReceived:"",dateOfReceived:""});o.useEffect(()=>{console.log("Current formData:",t)},[t]);const F=u=>{const c=u.target.value,g=k.find(y=>y._id===c);m(y=>({...y,warehouse:c,warehouseLocDetails:{warehouseName:g?g.warehouseName:"",address:g?g.address:""}}))},v=(u,c,g)=>{m(y=>{const A=[...y.details];return A[u]={...A[u],[c]:g,...c==="quantity"||c==="unitPrice"?{subTotal:Number(c==="quantity"?g:A[u].quantity)*Number(c==="unitPrice"?g:A[u].unitPrice)}:{}},{...y,details:A}})},a=u=>{const{id:c,value:g}=u.target;if(c.includes(".")){const[y,A]=c.split(".");m(O=>({...O,[y]:{...O[y],[A]:g}}))}else m(y=>({...y,[c]:g}))},f=async u=>{try{return(await $.get(`/api/v1/warehouse/checkPoNumber/${u}`)).data.exists}catch(c){return console.error(c),!1}};o.useEffect(()=>{(async()=>{await f(n.poNumber)&&l("Already Added")})()},[n.poNumber]),o.useEffect(()=>{(async()=>{try{const c=await $.get("/api/v1/warehouseLoc/locations");R(c.data.data)}catch(c){b(c.response.data.message),p(c.response.data.message)}})()},[]);const r=()=>t.warehouse?!t.warehouseLocDetails.warehouseName||!t.warehouseLocDetails.address?(b("Warehouse location details are incomplete"),!1):!0:(b("Please select a warehouse"),!1),i=async u=>{var y,A,O,U;if(u.preventDefault(),!r())return;const g=JSON.parse(sessionStorage.getItem("user")).email;if(!g){b("User email not found. Please log in again.");return}if(!t.warehouse){b("Please select a warehouse");return}try{const q=k.find(z=>z._id===t.warehouse);if(!q){b("Selected warehouse not found");return}const K={...t,byReceived:g,dateOfReceived:new Date().toISOString().split("T")[0],warehouse:t.warehouse,warehouseLocDetails:{warehouseName:q.warehouseName,address:q.address}},Y=await $.post("/api/v1/warehouse/addItem",K);Y.data.success&&(x(Y.data.data),h(!1),E("Item added successfully"),l("Already Added"))}catch(q){console.error("Error submitting form:",q),b(((A=(y=q.response)==null?void 0:y.data)==null?void 0:A.message)||"Error adding item"),p(((U=(O=q.response)==null?void 0:O.data)==null?void 0:U.message)||"Error adding item")}};return e.jsxs(e.Fragment,{children:[e.jsx(V,{color:"primary",variant:"outline",onClick:()=>h(!0),disabled:N==="Already Added",children:N==="Already Added"?e.jsx("span",{className:"me-1",children:"Already Added"}):e.jsx(X,{icon:De})}),e.jsxs(xe,{visible:D,onClose:()=>h(!1),size:"lg",children:[e.jsx(je,{children:e.jsx(fe,{children:"Add Receiving Item"})}),L&&e.jsx(T,{color:"danger",children:L}),P&&e.jsx(T,{color:"success",children:P}),e.jsx(ge,{children:e.jsxs(Ne,{children:[e.jsxs(G,{className:"mb-3",children:[e.jsx(W,{type:"text",id:"poNumber",floatingLabel:"PO Number",className:"mb-3",value:t.poNumber,onChange:a,required:!0,disabled:!0}),e.jsx(W,{type:"date",id:"orderDate",floatingLabel:"Order Date",className:"mb-3",value:t.orderDate.split("T")[0],onChange:a,required:!0,disabled:!0}),e.jsx(W,{type:"date",id:"receiveDate",floatingLabel:"Date to Receive",className:"mb-3",value:t.receiveDate.split("T")[0],onChange:a,required:!0,disabled:!0})]}),e.jsx(W,{type:"text",id:"vendor.businessName",floatingLabel:"Vendor Business Name",className:"mb-3",value:t.vendor.businessName,onChange:a,required:!0,disabled:!0}),e.jsx(G,{className:"mb-3",children:e.jsx(W,{type:"text",id:"vendor.businessAddress",floatingLabel:"Vendor Address",className:"mb-3",value:t.vendor.businessAddress,onChange:a,required:!0,disabled:!0})}),e.jsxs(G,{className:"mb-3",children:[e.jsx(W,{type:"text",id:"vendor.contactNumber",floatingLabel:"Vendor Contact Number",className:"mb-3",value:t.vendor.contactNumber,onChange:a,required:!0,disabled:!0}),e.jsx(W,{type:"text",id:"carrier",floatingLabel:"Carrier",className:"mb-3",value:t.carrier,onChange:a,required:!0,disabled:!0})]}),e.jsx(Ee,{id:"additionalNotes",floatingLabel:"Additional Notes",className:"mb-3",value:t.additionalNotes,onChange:a,rows:3,disabled:!0}),e.jsxs("div",{className:"mb-3",children:[e.jsx(te,{children:"Product Details"}),e.jsxs(Z,{responsive:!0,children:[e.jsx(ee,{children:e.jsxs(H,{children:[e.jsx(C,{children:"Description"}),e.jsx(C,{children:"Quantity"}),e.jsx(C,{children:"Unit Price "})]})}),e.jsx(se,{children:t.details.map((u,c)=>e.jsxs(H,{children:[e.jsx(S,{children:e.jsx(W,{type:"text",id:"description",value:u.description,onChange:g=>v(c,"description",g.target.value),placeholder:"Product description",disabled:!0})}),e.jsx(S,{children:e.jsx(W,{type:"number",id:"quantity",value:u.quantity,onChange:g=>v(c,"quantity",g.target.value),placeholder:"Qty",disabled:!0})}),e.jsx(S,{children:e.jsx(V,{color:"danger",size:"sm",onClick:()=>removeProductRow(c),disabled:t.details.length===1,children:"Remove"})})]},c))})]})]}),e.jsxs(be,{id:"warehouse",floatingLabel:"Warehouse",className:"mb-3",value:t.warehouse,onChange:F,required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),k.map(u=>e.jsxs("option",{value:u._id,children:[u.warehouseName," - ",u.address]},u._id))]})]})}),e.jsxs(pe,{children:[e.jsx(V,{color:"secondary",onClick:()=>h(!1),children:"Close"}),e.jsx(V,{color:"primary",onClick:i,children:"Save"})]})]})]})},_e=({onAddItem:x})=>{const[n,E]=o.useState([]),[p,N]=o.useState(1),[l,P]=o.useState(null),[I,D]=o.useState(!0),[h,L]=o.useState(""),[b,k]=o.useState([]),[R,d]=o.useState(!1),t=10,[m,F]=o.useState([]);if(o.useEffect(()=>{(async()=>{try{const w=await ye.get("https://log2_backend.chysev.com/api/v1/purchaseOrder");w.status===200&&F(w.data.data)}catch(w){console.error("Error fetching data:",w)}})()},[]),o.useEffect(()=>{E(m),D(!1)},[]),o.useEffect(()=>{if(h===""){E(m);return}const s=h.toLowerCase().trim(),w=m.filter(j=>{var _,B,u,c,g,y,A,O,U;try{return((_=j.poNumber)==null?void 0:_.toLowerCase().includes(s))||((u=(B=j.vendor)==null?void 0:B.businessName)==null?void 0:u.toLowerCase().includes(s))||((g=(c=j.vendor)==null?void 0:c.businessAddress)==null?void 0:g.toLowerCase().includes(s))||((A=(y=j.vendor)==null?void 0:y.contactNumber)==null?void 0:A.toLowerCase().includes(s))||((O=j.carrier)==null?void 0:O.toLowerCase().includes(s))||j.orderDate&&new Date(j.orderDate).toLocaleDateString().includes(s)||j.receiveDate&&new Date(j.receiveDate).toLocaleDateString().includes(s)||((U=j.details)==null?void 0:U.some(q=>{var K;return(K=q.description)==null?void 0:K.toLowerCase().includes(s)}))}catch(q){return console.error("Error filtering data:",q),!1}});E(w),N(1),P(w.length===0?"No results found":null)},[h]),I)return e.jsx(J,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"});const v=p*t,a=v-t,f=n.slice(a,v),r=Math.ceil(n.length/t),i=s=>{L(s.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"mt-3",children:e.jsxs(G,{className:"w-50 mb-3",children:[e.jsx(W,{type:"text",placeholder:"Search by PO Number, Supplier, or Item Name",value:h,id:"searchInput",onChange:i}),e.jsx(ce,{children:e.jsx(X,{icon:oe})})]})}),e.jsxs(Z,{hover:!0,responsive:!0,children:[e.jsx(ee,{children:e.jsxs(H,{children:[e.jsx(C,{children:"PO Number"}),e.jsx(C,{children:"Order Date"}),e.jsx(C,{children:"Date to Receive"}),e.jsx(C,{children:"Carrier"}),e.jsx(C,{children:"Vendor"}),e.jsx(C,{children:"Products"}),e.jsx(C,{children:"Total Amount"}),e.jsx(C,{children:"Notes"}),e.jsx(C,{children:"Actions"})]})}),e.jsx(se,{children:f.map(s=>{const w=s.details.reduce((j,_)=>j+_.subTotal,0);return e.jsxs(H,{children:[e.jsx(S,{children:s.poNumber}),e.jsx(S,{children:new Date(s.orderDate).toLocaleDateString()}),e.jsx(S,{children:new Date(s.receiveDate).toLocaleDateString()}),e.jsx(S,{children:s.carrier}),e.jsxs(S,{children:[e.jsx("div",{children:s.vendor.businessName}),e.jsx("small",{className:"text-medium-emphasis",children:s.vendor.contactNumber})]}),e.jsx(S,{children:s.details.map(j=>e.jsxs("div",{children:[j.description," ( pcs: ",j.quantity," x ",j.unitPrice.toFixed(2)," ",")"]},j.productId))}),e.jsx(S,{children:w.toFixed(2)}),e.jsx(S,{children:s.additionalNotes}),e.jsx(S,{children:e.jsx(Oe,{item:s,onAddItem:x,mockDataReiceving:m})})]},s._id)})})]}),n.length>0&&e.jsxs(M,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(M,{children:["Showing ",a+1," to ",Math.min(v,n.length)," of"," ",n.length," entries"]}),e.jsxs(ie,{className:"mt-3",children:[e.jsx(Q,{disabled:p===1,onClick:()=>N(s=>Math.max(s-1,1)),children:"Previous"}),[...Array(r).keys()].map(s=>e.jsx(Q,{active:s+1===p,onClick:()=>N(s+1),children:s+1},s+1)),e.jsx(Q,{disabled:p===r,onClick:()=>N(s=>Math.min(s+1,r)),children:"Next"})]})]}),l&&e.jsx(T,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:l})]})},Me=({items:x,loading:n,error:E})=>{const[p,N]=o.useState([]),[l,P]=o.useState(""),[I,D]=o.useState(null),h=10,[L,b]=o.useState(1),k=a=>{switch(a){case"Stocked":return"success";case"Out of Stock":return"danger";default:return"secondary"}};o.useEffect(()=>{N(x)},[x]),o.useEffect(()=>{if(l==="")N(x),D(null);else{const a=x.filter(f=>{const r=f.itemName.toLowerCase().includes(l.toLowerCase()),i=f.locations.some(s=>{const w=s.warehouse;return w.warehouseName.toLowerCase().includes(l.toLowerCase())||w.address.toLowerCase().includes(l.toLowerCase())});return r||i});N(a),b(1),a.length===0?D("No results found"):D(null)}},[l,x]);const R=a=>{P(a.target.value)},d=a=>{if(!a||!Array.isArray(a))return[];const f=new Map;return a.forEach(r=>{if(!(r!=null&&r.warehouse))return;const i=r.warehouse._id||"deleted";if(!f.has(i))f.set(i,{warehouse:{...r.warehouse,deleted:r.warehouse.deleted||!r.warehouse._id},quantity:r.quantity||0});else{const s=f.get(i);s.quantity+=r.quantity||0,f.set(i,s)}}),Array.from(f.values())};if(n)return e.jsx(J,{color:"primary",className:"text-center mt-5 w-75 mx-auto justify-content-center"});if(E)return e.jsxs(T,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:["Error: ",E]});const t=L*h,m=t-h,F=p.slice(m,t),v=Math.ceil(p.length/h);return e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"m-3",children:e.jsxs(G,{className:"w-50 mb-3",children:[e.jsx(W,{type:"text",id:"search",value:l,onChange:R,placeholder:"Search by item name or warehouse..."}),e.jsx(ce,{children:e.jsx(X,{icon:oe})})]})}),e.jsxs("strong",{className:"m-3 align-self-start",children:["Total Items: ",F.length]}),I?e.jsx(T,{color:"warning",children:I}):e.jsxs(Z,{hover:!0,responsive:!0,striped:!0,className:"text-center",children:[e.jsx(ee,{children:e.jsxs(H,{children:[e.jsx(C,{scope:"col",children:"Item Name"}),e.jsx(C,{scope:"col",children:"Total Quantity"}),e.jsx(C,{scope:"col",children:"Warehouse Locations"}),e.jsx(C,{scope:"col",children:"Status"})]})}),e.jsx(se,{children:F.map((a,f)=>e.jsxs(H,{children:[e.jsx(S,{children:a.itemName}),e.jsx(S,{children:e.jsx("strong",{children:a.quantity})}),e.jsx(S,{children:e.jsx(M,{className:"locations-list",children:d(a.locations).map((r,i)=>{const s=r.warehouse;return e.jsx(M,{className:"location-item",children:e.jsxs(M,{className:"location-details",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"warehouse-name",children:(s==null?void 0:s.warehouseName)||"Unknown Warehouse"}),e.jsx(he,{color:s!=null&&s.deleted?"danger":"success",className:"ms-2",children:s!=null&&s.deleted?"Deleted":"Active"})]}),e.jsx("span",{className:"warehouse-address",children:(s==null?void 0:s.address)||"No address available"}),e.jsxs("span",{className:"quantity-badge",children:["Qty: ",r.quantity]})]})},(s==null?void 0:s._id)||`deleted-${i}`)})})}),e.jsx(S,{children:e.jsx(he,{color:k(a.status||(a.quantity>0?"Stocked":"Out of Stock")),children:a.status||(a.quantity>0?"Stocked":"Out of Stock")})})]},a._id||f))})]}),p.length===0&&!I&&e.jsx(T,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No items found."}),e.jsxs(ie,{align:"center",children:[e.jsx(Q,{disabled:L===1,onClick:()=>b(a=>Math.max(a-1,1)),children:"Previous"}),[...Array(v).keys()].map(a=>e.jsx(Q,{active:a+1===L,onClick:()=>b(a+1),children:a+1},a+1)),e.jsx(Q,{disabled:L===v,onClick:()=>b(a=>Math.min(a+1,v)),children:"Next"})]})]})},Qe=`
  .locations-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .location-item {
    display: flex;
    flex-direction: column;
    padding: 8px;
    background-color: #f8f9fa;
    border-radius: 4px;
    width: fit-content;

  }

  .location-details {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
  }

  .warehouse-name {
    font-weight: 500;
    color: #495057;
  }

  .warehouse-address {
    color: #6c757d;
    font-size: 0.9em;
    font-style: italic;
  }

  .quantity-badge {
    background-color: #e9ecef;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.85em;
    color: #495057;
  }

`,ve=document.createElement("style");ve.innerText=Qe;document.head.appendChild(ve);const ds=()=>{const[x,n]=o.useState([]),[E,p]=o.useState([]),[N,l]=o.useState(!1),[P,I]=o.useState(null),[D,h]=o.useState(0);o.useEffect(()=>{(async()=>{l(!0);try{const t=await $.get("/api/v1/warehouse/items");n(t.data.data),p(t.data.data)}catch(t){I(t.message)}finally{l(!1)}})()},[D]);const L=()=>{h(d=>d+1)},b=d=>{n(t=>[...t,d]),p(t=>[...t,d]),L()},k=d=>{n(t=>t.filter(m=>m._id!==d)),p(t=>t.filter(m=>m._id!==d)),L()},R=d=>{n(t=>t.map(m=>m._id===d._id?d:m)),p(t=>t.map(m=>m._id===d._id?d:m)),L()};return e.jsx(e.Fragment,{children:e.jsxs(qe,{activeItemKey:"Warehouse Items Details",children:[e.jsxs(Re,{variant:"tabs",children:[e.jsx(re,{itemKey:"Warehouse Items Details",children:"Warehouse Items Details"}),e.jsx(re,{itemKey:"For Reiceve",children:"For Reiceve"}),e.jsx(re,{itemKey:"Items",children:"Items"})]}),e.jsxs(ke,{children:[e.jsx(ae,{className:"p-3",itemKey:"Warehouse Items Details",children:e.jsx(Fe,{warehousing:x,loading:N,error:P,onDeleteItem:k,onUpdateItem:R})}),e.jsx(ae,{className:"p-3",itemKey:"For Reiceve",children:e.jsxs(me,{children:[e.jsx(te,{children:"Item Reicevig"}),e.jsx(_e,{onAddItem:b})]})}),e.jsx(ae,{className:"p-3",itemKey:"Items",children:e.jsxs(me,{children:[e.jsx(te,{children:"Items"}),e.jsx(Me,{items:E,loading:N,error:P})]})})]})]})})};export{ds as default};
