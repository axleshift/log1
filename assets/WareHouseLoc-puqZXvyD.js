import{r as s,_ as he,u as pe,a as P,R as E,C as xe,c as ge,P as h,d as je,E as Ce,B as G,j as e,k as L,A as J,D as be,l as ye}from"./index-BElC7Iah.js";import{F as O,h as ve,i as Ne,g as we,e as Se}from"./index-C1mT4LDC.js";import{a as W}from"./CButton-DzbbCv2e.js";import{C as te,a as oe,b as re,c as ne,d as le}from"./CModalTitle-42RmhkTZ.js";import{a as A,C as ie}from"./CForm-DG9u0lFa.js";import{C as R}from"./CFormInput-BkwhWuY3.js";import{C as q}from"./CContainer-htpbj9Ya.js";import{C as ke,a as Pe}from"./CInputGroupText-B9OyZYiS.js";import{C as Le}from"./CCard-CdfwD7Ih.js";import{u as Te,C as ce}from"./DefaultLayout-BgzkAF5b.js";import{C as Ee}from"./CCardBody-O4cU2JiN.js";import{C as We,a as Ae,b as se,c as H,d as Fe,e as z}from"./CTable-bOZpDnwa.js";import{g as Ie,e as Re}from"./getRTLPlacement-DIjjwaPU.js";import{C as Be,a as $}from"./CPaginationItem-DRFy3HOm.js";import"./index.esm-BuUAuGL-.js";import"./1-DTyOmbo5.js";import"./cil-user-Ddrdy7PS.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";var I=s.forwardRef(function(a,j){var S=a.children,C=a.animation,g=C===void 0?!0:C,i=a.className,p=a.container,r=a.content,d=a.delay,l=d===void 0?0:d,o=a.fallbackPlacements,c=o===void 0?["top","right","bottom","left"]:o,u=a.offset,y=u===void 0?[0,6]:u,x=a.onHide,v=a.onShow,N=a.placement,T=N===void 0?"top":N,m=a.popperConfig,w=a.trigger,f=w===void 0?["hover","focus"]:w,b=a.visible,t=he(a,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","popperConfig","trigger","visible"]),n=s.useRef(null),k=s.useRef(null),_=pe(j,n),B="tooltip".concat(s.useId()),Q=s.useState(!1),V=Q[0],K=Q[1],X=s.useState(b),F=X[0],Y=X[1],U=Te(),de=U.initPopper,ue=U.destroyPopper,me=U.updatePopper,Z=typeof l=="number"?{show:l,hide:l}:l,ee={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:c}},{name:"offset",options:{offset:y}}],placement:Ie(T,k.current)},fe=P(P({},ee),typeof m=="function"?m(ee):m);s.useEffect(function(){if(b){M();return}D()},[b]),s.useEffect(function(){if(V&&k.current&&n.current){de(k.current,n.current,fe),setTimeout(function(){Y(!0)},Z.show);return}!V&&k.current&&n.current&&ue()},[V]),s.useEffect(function(){!F&&k.current&&n.current&&Re(function(){K(!1)},n.current)},[F]);var M=function(){K(!0),v&&v()},D=function(){setTimeout(function(){Y(!1),x&&x()},Z.hide)};return s.useEffect(function(){me()},[r]),E.createElement(E.Fragment,null,E.cloneElement(S,P(P(P(P(P({},F&&{"aria-describedby":B}),{ref:k}),(f==="click"||f.includes("click"))&&{onClick:function(){return F?D():M()}}),(f==="focus"||f.includes("focus"))&&{onFocus:function(){return M()},onBlur:function(){return D()}}),(f==="hover"||f.includes("hover"))&&{onMouseEnter:function(){return M()},onMouseLeave:function(){return D()}})),E.createElement(xe,{container:p,portal:!0},V&&E.createElement("div",P({className:ge("tooltip","bs-tooltip-auto",{fade:g,show:F},i),id:B,ref:_,role:"tooltip"},t),E.createElement("div",{className:"tooltip-arrow"}),E.createElement("div",{className:"tooltip-inner"},r))))});I.propTypes={animation:h.bool,children:h.node,container:h.any,content:h.oneOfType([h.string,h.node]),delay:h.oneOfType([h.number,h.shape({show:h.number.isRequired,hide:h.number.isRequired})]),fallbackPlacements:Ce,offset:h.any,onHide:h.func,onShow:h.func,placement:h.oneOf(["auto","top","right","bottom","left"]),popperConfig:h.oneOfType([h.func,h.object]),trigger:je,visible:h.bool};I.displayName="CTooltip";const Ve=({onAddWarehouseLoc:a})=>{const{showSuccess:j,showError:S}=G(),[C,g]=s.useState(!1),[i,p]=s.useState(!1),[r,d]=s.useState(!1),[l,o]=s.useState(null),[c,u]=s.useState(null),y={warehouseName:"",address:""},[x,v]=s.useState(y),N=m=>{const{id:w,value:f}=m.target;v(b=>({...b,[w]:f}))},T=async m=>{const f=m.currentTarget.checkValidity();if(f||(m.preventDefault(),m.stopPropagation()),g(f),f){const t=JSON.parse(sessionStorage.getItem("user")).email;if(!t){o("User email not found. Please log in again.");return}d(!0);try{const n=await J.post("/api/v1/warehouseLoc/add",{...x,createdBy:t});n.data.success&&(j(n.data.message),a(n.data.data),setTimeout(()=>{d(!1),p(!1),o(null),v(y),g(!1)},2e3))}catch(n){o(n.response.data.message),S(n.response.data.message),setTimeout(()=>{o(null)},2e3)}d(!1)}};return e.jsx(e.Fragment,{children:r?e.jsx(L,{color:"primary",size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(W,{color:"primary",variant:"outline",disabled:r,onClick:()=>p(!0),children:[r?e.jsx(L,{color:"secondary",size:"sm"}):e.jsx(O,{icon:ve})," ","Add Warehouse Location"]}),e.jsxs(te,{visible:i,onClose:()=>p(!1),children:[e.jsx(oe,{closeButton:!0,children:e.jsx(re,{children:"Add Warehouse Location"})}),l&&e.jsx(A,{color:"danger",className:"m-3",children:l}),c&&e.jsx(A,{color:"success",className:"m-3",children:c}),e.jsx(ne,{children:e.jsxs(ie,{noValidate:!0,validated:C,children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:N,value:x.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name",feedbackValid:"Looks good!"}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:N,value:x.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address",feedbackValid:"Looks good!"})]})}),e.jsxs(le,{children:[e.jsx(W,{color:"secondary",variant:"outline",disabled:r,onClick:()=>{p(!1),v(y),p(!1),o(null),g(!1)},children:r?e.jsx(L,{color:"secondary",size:"sm"}):"Cancel"}),e.jsx(W,{color:"primary",variant:"outline",disabled:r,onClick:T,children:r?e.jsx(L,{color:"primary",size:"sm"}):"Add"})]})]})]})})},Me=({warehouseLoc:a,onDeleteWarehouseLoc:j})=>{const{showSuccess:S,showError:C}=G(),[g,i]=s.useState(!1),[p,r]=s.useState(null),d=async()=>{i(!0);try{const l=await J.patch(`/api/v1/warehouseLoc/delete/${a._id}`);l.data.success&&(S(l.data.message),j(a._id),i(!1),r(null))}catch(l){r(l),C(l.message)}finally{i(!1)}};return p?e.jsxs(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",p.message]}):e.jsx(e.Fragment,{children:e.jsx(W,{color:"danger",disabled:g,variant:"outline",onClick:d,className:"me-2",children:g?e.jsx(L,{size:"sm"}):e.jsx(O,{icon:Ne})})})},De=({warehouseLoc:a,onUpdateWarehouseLoc:j})=>{const{showSuccess:S,showErrors:C}=G(),[g,i]=s.useState(!1),[p,r]=s.useState(!1),[d,l]=s.useState(!1),[o,c]=s.useState(null),[u,y]=s.useState(null),[x,v]=s.useState({warehouseName:a.warehouseName,address:a.address}),N=m=>{const{id:w,value:f}=m.target;v(b=>({...b,[w]:f}))},T=async m=>{const f=m.currentTarget.checkValidity();f||(m.preventDefault(),m.stopPropagation()),r(f);const t=JSON.parse(sessionStorage.getItem("user")).email;if(!t){c("User email not found. Please log in again.");return}l(!0);try{const n=await J.put(`/api/v1/warehouseLoc/update/${a._id}`,{...x,createdBy:t});n.data.success&&(S(n.data.message),j(n.data.data),setTimeout(()=>{y(null),i(!1),c(null),r(!1)},2e3))}catch(n){c(n.response.data.message),C(n.response.data.message),setTimeout(()=>{c(null)},2e3)}l(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(W,{color:"primary",variant:"outline",disabled:d,onClick:()=>i(!0),className:"me-2",children:d?e.jsx(L,{size:"sm"}):e.jsx(O,{icon:we})}),e.jsxs(te,{visible:g,onClose:()=>i(!1),children:[e.jsx(oe,{closeButton:!0,children:e.jsx(re,{children:"Update Warehouse Location"})}),o&&e.jsx(A,{color:"danger",className:"m-3",children:o}),u&&e.jsx(A,{color:"success",className:"m-3",children:u}),e.jsx(ne,{children:e.jsxs(ie,{noValidate:!0,validated:p,children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:N,value:x.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name.",feedbackValid:"Looks good!"}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:N,value:x.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address.",feedbackValid:"Looks good!"})]})}),e.jsxs(le,{children:[e.jsx(W,{color:"secondary",variant:"outline",disabled:d,onClick:()=>{i(!1),c(null),r(!1)},children:d?e.jsx(L,{size:"sm",color:"secondary"}):"Cancel"}),e.jsx(W,{color:"primary",variant:"outline",disabled:d,onClick:T,children:d?e.jsx(L,{size:"sm",color:"success"}):"Update"})]})]})]})},He=({warehouseLoc:a,loading:j,error:S,onDeleteWarehouseLoc:C,onUpdateWarehouseLoc:g})=>{const[i,p]=s.useState(""),[r,d]=s.useState([]),[l,o]=s.useState(1),[c,u]=s.useState(null),y=10,x=be(),v=["manager","admin"],N="admin";if(s.useEffect(()=>{d(a)},[a]),s.useEffect(()=>{if(i==="")d(a);else{const t=a.filter(n=>{const k=n.warehouseName.toLowerCase().includes(i.toLowerCase()),_=n.address.toLowerCase().includes(i.toLowerCase()),B=v.includes(x)&&n.createdBy.toLowerCase().includes(i.toLowerCase());return k||_||B});d(t),o(1),t.length===0?u("No results found"):u(null)}},[i,a]),a.length===0)return e.jsx(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:"No Warehouse Location Found"});const T=t=>{p(t.target.value)},m=l*y,w=m-y,f=r.slice(w,m),b=Math.ceil(r.length/y);return e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"m-3",children:e.jsxs(ke,{className:"w-50 mb-3",children:[e.jsx(R,{type:"text",id:"search",value:i,onChange:T,placeholder:"Search Warehouse Location..."}),e.jsx(Pe,{children:e.jsx(O,{icon:Se})})]})}),e.jsxs(Le,{children:[e.jsx(ce,{children:"Warehouse Location List"}),e.jsxs(Ee,{className:"md-3",children:[e.jsxs(We,{bordered:!0,hover:!0,responsive:!0,className:"mx-auto ",children:[e.jsx(Ae,{className:"text-center  ",children:e.jsxs(se,{children:[e.jsx(H,{className:"fixed-width bg-secondary",children:"Warehouse Name"}),e.jsx(H,{className:"fixed-width bg-secondary",children:"Address"}),N.includes(x)&&e.jsx(H,{className:"fixed-width bg-secondary",children:"Created By"}),e.jsx(H,{className:"fixed-width bg-secondary",children:"Actions"})]})}),e.jsx(Fe,{className:"text-center",children:f.map(t=>e.jsxs(se,{children:[e.jsx(z,{className:"fixed-width",children:e.jsx(I,{content:t.warehouseName,children:e.jsx("span",{children:t.warehouseName})})}),e.jsx(z,{className:"fixed-width",children:e.jsx(I,{content:t.address,children:e.jsx("span",{children:t.address})})}),N.includes(x)&&e.jsx(z,{className:"fixed-width",color:"danger",children:e.jsx(I,{content:t.createdBy,children:e.jsx("span",{children:t.createdBy})})}),e.jsxs(z,{className:"fixed-width",children:[e.jsx(De,{warehouseLoc:t,onUpdateWarehouseLoc:g}),v.includes(x)&&e.jsx(Me,{warehouseLoc:t,onDeleteWarehouseLoc:C})]})]},t._id))})]}),r.length>0&&e.jsxs(q,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(q,{children:["Showing ",w+1," to"," ",Math.min(m,r.length)," of"," ",r.length," entries"]}),e.jsxs(Be,{className:"mt-3",children:[e.jsx($,{disabled:l===1,onClick:()=>o(t=>Math.max(t-1,1)),children:"Previous"}),[...Array(b).keys()].map(t=>e.jsx($,{active:t+1===l,onClick:()=>o(t+1),children:t+1},t+1)),e.jsx($,{disabled:l===b,onClick:()=>o(t=>Math.min(t+1,b)),children:"Next"})]})]}),c&&e.jsx(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:c})]})]})]})},ae=sessionStorage.getItem("accessToken"),ze="http://localhost:5057",Oe=ye.create({baseURL:ze,withCredentials:!0,headers:{"Content-Type":"application/json",...ae&&{Authorization:`Bearer ${ae}`}}}),ls=()=>{const[a,j]=s.useState([]),[S,C]=s.useState(!1),[g,i]=s.useState(null),p=async()=>{var o,c;C(!0);try{const u=await Oe.get("/api/v1/warehouseLoc/locations");u.status===200?j(u.data.data):i(u.data.message)}catch(u){i(((c=(o=u.response)==null?void 0:o.data)==null?void 0:c.message)||u.message)}finally{C(!1)}};s.useEffect(()=>{p()},[]);const r=o=>{j(c=>[...c,o])},d=o=>{j(c=>c.filter(u=>u._id!==o))},l=o=>{j(c=>c.map(u=>u._id===o._id?o:u))};return e.jsxs(e.Fragment,{children:[e.jsx(ce,{children:"Warehouse location"}),e.jsx(Ve,{onAddWarehouseLoc:r}),e.jsx(He,{warehouseLoc:a,loading:S,error:g,onDeleteWarehouseLoc:d,onUpdateWarehouseLoc:l})]})};export{ls as default};
