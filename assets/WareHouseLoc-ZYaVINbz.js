import{r as t,_ as de,a as S,R as L,c as ue,P as c,e as me,w as fe,j as e,C as q}from"./index-ROFYVZSB.js";import{a as _}from"./index-DW_MHI2K.js";import{u as he,e as pe,F as O,f as xe,a as ge,i as je,j as Ce,C as ye}from"./DefaultLayout-CSaaRxM-.js";import{a as P}from"./CButton-B6XfsDmw.js";import{C as ee,a as se,b as te,c as ae,d as oe}from"./CModalTitle-RcsBXXdb.js";import{C as W}from"./CAlert-K7kYRrvA.js";import{C as re}from"./CForm-DG9jDYNX.js";import{C as R}from"./CFormInput-GqhhVFAX.js";import{C as be}from"./index.esm-BM_BWR5J.js";import{C as ve,a as Ne}from"./CInputGroupText-MlH_-xN7.js";import{C as Se}from"./CCard-CY27pPNB.js";import{C as we}from"./CCardBody-D_8Vsxmt.js";import{C as Le,a as Pe,b as Z,c as H,d as We,e as U}from"./CTable-QL4Mn77d.js";import{u as Te}from"./CCloseButton-DZNfoUeS.js";import{g as Ee,e as ke}from"./getRTLPlacement-BxsIe2Ad.js";import{C as Ae,a as V}from"./CPaginationItem-BjNS21Fc.js";import"./cil-user-Ddrdy7PS.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";var A=t.forwardRef(function(s,h){var j=s.children,i=s.animation,C=i===void 0?!0:i,n=s.className,p=s.container,l=s.content,x=s.delay,d=x===void 0?0:x,o=s.fallbackPlacements,u=o===void 0?["top","right","bottom","left"]:o,r=s.offset,y=r===void 0?[0,6]:r,f=s.onHide,m=s.onShow,g=s.placement,E=g===void 0?"top":g,T=s.popperConfig,F=s.trigger,v=F===void 0?["hover","focus"]:F,w=s.visible,a=de(s,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","popperConfig","trigger","visible"]),b=t.useRef(null),N=t.useRef(null),$=Te(h,b),I="tooltip".concat(t.useId()),G=t.useState(!1),B=G[0],Q=G[1],J=t.useState(w),k=J[0],K=J[1],z=he(),ne=z.initPopper,le=z.destroyPopper,ce=z.updatePopper,X=typeof d=="number"?{show:d,hide:d}:d,Y={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:u}},{name:"offset",options:{offset:y}}],placement:Ee(E,N.current)},ie=S(S({},Y),typeof T=="function"?T(Y):T);t.useEffect(function(){if(w){M();return}D()},[w]),t.useEffect(function(){if(B&&N.current&&b.current){ne(N.current,b.current,ie),setTimeout(function(){K(!0)},X.show);return}!B&&N.current&&b.current&&le()},[B]),t.useEffect(function(){!k&&N.current&&b.current&&ke(function(){Q(!1)},b.current)},[k]);var M=function(){Q(!0),m&&m()},D=function(){setTimeout(function(){K(!1),f&&f()},X.hide)};return t.useEffect(function(){ce()},[l]),L.createElement(L.Fragment,null,L.cloneElement(j,S(S(S(S(S({},k&&{"aria-describedby":I}),{ref:N}),(v==="click"||v.includes("click"))&&{onClick:function(){return k?D():M()}}),(v==="focus"||v.includes("focus"))&&{onFocus:function(){return M()},onBlur:function(){return D()}}),(v==="hover"||v.includes("hover"))&&{onMouseEnter:function(){return M()},onMouseLeave:function(){return D()}})),L.createElement(pe,{container:p,portal:!0},B&&L.createElement("div",S({className:ue("tooltip","bs-tooltip-auto",{fade:C,show:k},n),id:I,ref:$,role:"tooltip"},a),L.createElement("div",{className:"tooltip-arrow"}),L.createElement("div",{className:"tooltip-inner"},l))))});A.propTypes={animation:c.bool,children:c.node,container:c.any,content:c.oneOfType([c.string,c.node]),delay:c.oneOfType([c.number,c.shape({show:c.number.isRequired,hide:c.number.isRequired})]),fallbackPlacements:fe,offset:c.any,onHide:c.func,onShow:c.func,placement:c.oneOf(["auto","top","right","bottom","left"]),popperConfig:c.oneOfType([c.func,c.object]),trigger:me,visible:c.bool};A.displayName="CTooltip";const Re="http://localhost:5057",Fe=_.create({baseURL:Re}),Ie=({onAddWarehouseLoc:s})=>{const[h,j]=t.useState(!1),[i,C]=t.useState(!1),[n,p]=t.useState(null),[l,x]=t.useState(null),[d,o]=t.useState({warehouseName:"",address:""}),u=y=>{const{id:f,value:m}=y.target;o(g=>({...g,[f]:m}))},r=async y=>{y.preventDefault();const f=sessionStorage.getItem("email");if(!f){p("User email not found. Please log in again.");return}C(!0);try{const m=await Fe.post("/api/v1/warehouseLoc/add",{...d,createdBy:f});m.status===201&&(x(m.data.message),s(m.data.data),setTimeout(()=>{x(null),j(!1)},2e3),o({warehouseName:"",address:""}))}catch(m){p(m.response.data.message),setTimeout(()=>{p(null)},2e3)}C(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(P,{color:"primary",variant:"outline",onClick:()=>j(!0),children:[i?e.jsx(q,{color:"secondary",size:"sm"}):e.jsx(O,{icon:xe})," Add Warehouse Location"]}),e.jsxs(ee,{visible:h,onClose:()=>j(!1),children:[e.jsx(se,{closeButton:!0,children:e.jsx(te,{children:"Add Warehouse Location"})}),n&&e.jsx(W,{color:"danger",children:n}),l&&e.jsx(W,{color:"success",children:l}),e.jsx(ae,{children:e.jsxs(re,{children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:u,value:d.warehouseName}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:u,value:d.address})]})}),e.jsxs(oe,{children:[e.jsx(P,{color:"secondary",variant:"outline",onClick:()=>j(!h),children:"Cancel"}),e.jsx(P,{color:"primary",variant:"outline",onClick:r,children:"Save"})]})]})]})},Be="http://localhost:5057",Me=_.create({baseURL:Be}),De=({warehouseLoc:s,onDeleteWarehouseLoc:h})=>{const[j,i]=t.useState(!1),[C,n]=t.useState(null),p=async()=>{i(!0);try{const l=await Me.delete(`/api/v1/warehouseLoc/delete/${s._id}`);console.log(l.data),l.status===200&&(alert("Warehouse Location deleted successfully"),h(s._id),i(!1),n(null))}catch(l){n(l)}finally{i(!1)}};return C?e.jsxs(W,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",C.message]}):e.jsx(e.Fragment,{children:e.jsx(P,{color:"danger",variant:"outline",onClick:p,className:"me-2",children:j?e.jsx(q,{size:"sm"}):e.jsx(O,{icon:ge})})})},He="http://localhost:5057",Ue=_.create({baseURL:He}),_e=({warehouseLoc:s,onUpdateWarehouseLoc:h})=>{const[j,i]=t.useState(!1),[C,n]=t.useState(!1),[p,l]=t.useState(null),[x,d]=t.useState(null),[o,u]=t.useState({warehouseName:s.warehouseName,address:s.address}),r=f=>{const{id:m,value:g}=f.target;u(E=>({...E,[m]:g}))},y=async f=>{f.preventDefault();const m=sessionStorage.getItem("email");if(!m){l("User email not found. Please log in again.");return}n(!0);try{const g=await Ue.put(`/api/v1/warehouseLoc/update/${s._id}`,{...o,createdBy:m});g.status===200&&(d("Warehouse Location updated successfully"),h(g.data.data),setTimeout(()=>{d(null),i(!1)},2e3))}catch(g){l(g.response.data.message),setTimeout(()=>{l(null)},2e3)}n(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(P,{color:"primary",variant:"outline",onClick:()=>i(!0),className:"me-2",children:C?e.jsx(q,{size:"sm"}):e.jsx(O,{icon:je})}),e.jsxs(ee,{visible:j,onClose:()=>i(!1),children:[e.jsx(se,{closeButton:!0,children:e.jsx(te,{children:"Update Warehouse Location"})}),p&&e.jsx(W,{color:"danger",children:p}),x&&e.jsx(W,{color:"success",children:x}),e.jsx(ae,{children:e.jsxs(re,{children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:r,value:o.warehouseName}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:r,value:o.address})]})}),e.jsxs(oe,{children:[e.jsx(P,{color:"secondary",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(P,{color:"primary",variant:"outline",onClick:y,children:"Save"})]})]})]})},Oe=({warehouseLoc:s,loading:h,error:j,onDeleteWarehouseLoc:i,onUpdateWarehouseLoc:C})=>{const[n,p]=t.useState(""),[l,x]=t.useState([]),[d,o]=t.useState(1),[u,r]=t.useState(null),y=10,f=JSON.parse(sessionStorage.getItem("user")),m=["manager","admin"],g="admin";if(t.useEffect(()=>{x(s)},[s]),t.useEffect(()=>{if(n==="")x(s);else{const a=s.filter(b=>{const N=b.warehouseName.toLowerCase().includes(n.toLowerCase()),$=b.address.toLowerCase().includes(n.toLowerCase()),I=m.includes(f.data.user.role)&&b.createdBy.toLowerCase().includes(n.toLowerCase());return N||$||I});x(a),o(1),a.length===0?r("No results found"):r(null)}},[n,s]),s.length===0)return e.jsx(W,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:"No Warehouse Location Found"});const E=a=>{p(a.target.value)},T=d*y,F=T-y,v=l.slice(F,T),w=Math.ceil(l.length/y);return e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"m-3",children:e.jsxs(ve,{className:"w-50 mb-3",children:[e.jsx(R,{type:"text",id:"search",value:n,onChange:E,placeholder:"Search Warehouse Location..."}),e.jsx(Ne,{children:e.jsx(O,{icon:Ce})})]})}),e.jsxs(Se,{children:[e.jsx(ye,{children:"Warehouse Location List"}),e.jsxs(we,{className:"md-3",children:[e.jsxs(Le,{bordered:!0,hover:!0,responsive:!0,className:"mx-auto ",children:[e.jsx(Pe,{className:"text-center  ",children:e.jsxs(Z,{children:[e.jsx(H,{className:"fixed-width bg-secondary",children:"Warehouse Name"}),e.jsx(H,{className:"fixed-width bg-secondary",children:"Address"}),g.includes(f.data.user.role)&&e.jsx(H,{className:"fixed-width bg-secondary",children:"Created By"}),e.jsx(H,{className:"fixed-width bg-secondary",children:"Actions"})]})}),e.jsx(We,{className:"text-center",children:v.map(a=>e.jsxs(Z,{children:[e.jsx(U,{className:"fixed-width",children:e.jsx(A,{content:a.warehouseName,children:e.jsx("span",{children:a.warehouseName})})}),e.jsx(U,{className:"fixed-width",children:e.jsx(A,{content:a.address,children:e.jsx("span",{children:a.address})})}),g.includes(f.data.user.role)&&e.jsx(U,{className:"fixed-width",color:"danger",children:e.jsx(A,{content:a.createdBy,children:e.jsx("span",{children:a.createdBy})})}),e.jsxs(U,{className:"fixed-width",children:[e.jsx(_e,{warehouseLoc:a,onUpdateWarehouseLoc:C}),m.includes(f.data.user.role)&&e.jsx(De,{warehouseLoc:a,onDeleteWarehouseLoc:i})]})]},a._id))})]}),u&&e.jsx(W,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:u}),e.jsxs(Ae,{align:"center",children:[e.jsx(V,{disabled:d===1,onClick:()=>o(a=>Math.max(a-1,1)),children:"Previous"}),[...Array(w).keys()].map(a=>e.jsx(V,{active:a+1===d,onClick:()=>o(a+1),children:a+1},a+1)),e.jsx(V,{disabled:d===w,onClick:()=>o(a=>Math.min(a+1,w)),children:"Next"})]})]})]})]})},$e="http://localhost:5057",ze=_.create({baseURL:$e}),is=()=>{const[s,h]=t.useState([]),[j,i]=t.useState(!1),[C,n]=t.useState(null),p=async()=>{var o,u;i(!0);try{const r=await ze.get("/api/v1/warehouseLoc/locations");r.status===200?h(r.data.data):n(r.data.message)}catch(r){n(((u=(o=r.response)==null?void 0:o.data)==null?void 0:u.message)||r.message)}finally{i(!1)}};t.useEffect(()=>{p()},[]);const l=o=>{h(u=>[...u,o])},x=o=>{h(u=>u.filter(r=>r._id!==o))},d=o=>{h(u=>u.map(r=>r._id===o._id?o:r))};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Warehouse location"}),e.jsx(Ie,{onAddWarehouseLoc:l}),e.jsx(Oe,{warehouseLoc:s,loading:j,error:C,onDeleteWarehouseLoc:x,onUpdateWarehouseLoc:d})]})};export{is as default};
