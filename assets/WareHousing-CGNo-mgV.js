import{r as n,A as ue,j as e,k as V,n as de,l as me,F as G}from"./index-B1VXg6al.js";import{F as z,k as X,G as xe,a as oe}from"./index-CfVRHtsN.js";import{C as A}from"./CAlert-2xoRTT4O.js";import{C as O}from"./CContainer-DzS4YxvB.js";import{C as Z}from"./CInputGroup-BSA7BYJv.js";import{C as ee}from"./CFormInput-CJf-vfrQ.js";import{C as se}from"./CInputGroupText-BqWDbdy_.js";import{C as je,a as fe,b as ge,c as pe}from"./CAccordionHeader-CQtNZXby.js";import{C as te,a as re,b as M,c as v,d as ae,e as N}from"./CTable-SFtuaI8P.js";import{C as ne,a as F}from"./CPaginationItem-DevxR1Q8.js";import{a as ve}from"./CButton-PSsn9c4Q.js";import{C as Ne,a as we,b as Y,c as J}from"./CTabList-dMoRf8Bh.js";import{a as Ce,C as ie}from"./DefaultLayout-Dnmxpw9y.js";import{C as le}from"./CCard-Cc_7KkO4.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";import"./index.esm-DP8SdLSE.js";import"./1-CW9aPW_P.js";import"./cil-user-Ddrdy7PS.js";const ye=({warehousing:w,loading:y,error:k,onDeleteItem:m,onUpdateItem:b})=>{const[x,S]=n.useState([]),[L,g]=n.useState(null),[I,C]=n.useState("");ue();const[p,P]=n.useState(1),[R]=n.useState(10),[h,c]=n.useState([]),j=Math.ceil(x.length/R),E=x.filter(s=>s.received===!0),W=p*R,a=W-R,f=E.slice(a,W);n.useEffect(()=>{try{if(I===""){S(w),g(null);return}const s=I.toLowerCase().trim(),u=w.filter(i=>{var t,o,r,l,_,Q,H,U,K;try{return((t=i.poNumber)==null?void 0:t.toLowerCase().includes(s))||((r=(o=i.vendor)==null?void 0:o.businessName)==null?void 0:r.toLowerCase().includes(s))||((_=(l=i.vendor)==null?void 0:l.businessAddress)==null?void 0:_.toLowerCase().includes(s))||((H=(Q=i.vendor)==null?void 0:Q.contactNumber)==null?void 0:H.includes(s))||i.orderDate&&new Date(i.orderDate).toLocaleDateString().includes(s)||i.dateOfReceived&&new Date(i.receiveDate).toLocaleDateString().includes(s)||((U=d(i.warehouseId))==null?void 0:U.toLowerCase().includes(s))||((K=i.details)==null?void 0:K.some(T=>{var $,B,q;return(($=T.description)==null?void 0:$.toLowerCase().includes(s))||((B=T.quantity)==null?void 0:B.toString().includes(s))||((q=T.unitPrice)==null?void 0:q.toString().includes(s))}))}catch(T){return console.error("Error filtering item:",T),!1}});S(u),P(1),u.length===0?g("No data found"):g(null)}catch(s){console.error("Error in search effect:",s),g("Error occurred while searching")}},[I,w]),n.useEffect(()=>{(async()=>{var u;try{const i=await de.get("/api/v1/warehouseLoc/locations");i.data.data&&c(i.data.data)}catch(i){g((u=i==null?void 0:i.response)==null?void 0:u.data.message)}})()},[]);const d=s=>{if(!h.length)return"Loading...";const u=h.find(i=>i._id===s);return u?u.warehouseName:"Unknown Warehouse"},D=s=>{C(s.target.value)};return y?e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):w.length===0?e.jsx(A,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):k?e.jsxs(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",k.message]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mt-3",children:e.jsxs(Z,{className:"w-50 mb-3",children:[e.jsx(ee,{type:"text",placeholder:"Search by PO Number, Vendor, or Products...",value:I,id:"searchItem",onChange:D}),e.jsx(se,{children:e.jsx(z,{icon:X})})]})}),y?e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"}):w.length===0?e.jsx(A,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No data available"}):e.jsxs(e.Fragment,{children:[L&&e.jsx(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:L}),e.jsx(je,{className:"m-2",children:f.filter(s=>s.received).map(s=>e.jsxs(fe,{children:[e.jsx(ge,{children:e.jsxs("div",{className:"d-flex justify-content-between w-100 align-items-center",children:[e.jsx("div",{children:e.jsxs("ul",{className:"list-unstyled",children:[e.jsxs("li",{children:["PO Number: ",e.jsx("strong",{children:s.poNumber})]}),e.jsxs("li",{children:["Warehuse Location:"," ",e.jsx("strong",{children:d(s.warehouse_id)})]})]})}),e.jsxs("div",{className:"text-medium-emphasis",children:["Order Date: ",new Date(s.orderDate).toLocaleDateString()]})]})}),e.jsxs(pe,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Vendor Information"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",s.vendor.businessName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",s.vendor.businessAddress]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"})," ",s.vendor.contactNumber]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Shipping Details"}),e.jsxs("div",{className:"ms-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Carrier:"})," ",s.carrier]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Expected Delivery Date:"})," ",new Date(s.receiveDate).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Products"}),e.jsxs(te,{responsive:!0,small:!0,className:"mt-2",children:[e.jsx(re,{children:e.jsxs(M,{children:[e.jsx(v,{children:"Description"}),e.jsx(v,{children:"Quantity"}),e.jsx(v,{children:"Received Date"})]})}),e.jsx(ae,{children:s.details.map((u,i)=>e.jsxs(M,{children:[e.jsx(N,{children:u.description}),e.jsx(N,{children:u.quantity}),e.jsx(N,{children:s.receiveDate?new Date(s.receiveDate).toLocaleDateString():"N/A"})]},i))})]})]}),s.additionalNotes&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Additional Notes"}),e.jsx("div",{className:"ms-3",children:s.additionalNotes})]})]})]},s._id))}),f.length>0&&e.jsxs(O,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:["Showing ",E.length>0?a+1:0," to"," ",Math.min(W,E.length)," of ",E.length," received entries"]}),e.jsxs(ne,{className:"mt-3",children:[e.jsx(F,{disabled:p===1,onClick:()=>P(s=>Math.max(s-1,1)),children:"Previous"}),Array.from({length:j},(s,u)=>u+1).map(s=>e.jsx(F,{active:s===p,onClick:()=>P(s),children:s},s)),e.jsx(F,{disabled:p===j,onClick:()=>P(s=>Math.min(s+1,j)),children:"Next"})]})]})]})]})},be=({onAddItem:w})=>{const{showError:y,showSuccess:k}=me(),[m,b]=n.useState([]),[x,S]=n.useState(1),[L,g]=n.useState(null),[I,C]=n.useState(!0),[p,P]=n.useState(""),[R,h]=n.useState([]),[c,j]=n.useState([]),E=10;n.useEffect(()=>{(async()=>{var o;try{const r=await G.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");console.log(r.data),r.status===200?b(r.data):g(r.data.message||"Error fetching data")}catch(r){console.error("Error fetching data:",r),g(((o=r==null?void 0:r.response)==null?void 0:o.data.message)||"Error fetching data")}})()},[]);const W=async t=>{var o,r;try{if((await G.put(`https://backend-log2.axleshift.com/api/v1/purchaseOrder/${t}`,{received:!0,receiveDate:new Date().toISOString()})).status===200){const _=await G.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");b(_.data),k("Item received successfully")}}catch(l){console.error("Error updating purchase order:",l),y(((r=(o=l==null?void 0:l.response)==null?void 0:o.data)==null?void 0:r.message)||"Error updating purchase order")}};n.useEffect(()=>{(async()=>{var o,r;try{const l=await de.get("/api/v1/warehouseLoc/locations");l.data.data&&(j(l.data.data),k(l.data.message))}catch(l){g((o=l==null?void 0:l.response)==null?void 0:o.data.message),y(((r=l==null?void 0:l.response)==null?void 0:r.data.message)||"Error fetching warehouses")}})()},[]);const a=t=>{if(!c.length)return"Loading...";const o=c.find(r=>r._id===t);return o?o.warehouseName:"Unknown Warehouse"};if(n.useEffect(()=>{C(!1)},[]),n.useEffect(()=>{if(p===""){b(m);return}const t=p.toLowerCase().trim(),o=m.filter(r=>{var l,_,Q,H,U,K,T,$,B;try{return((l=r.poNumber)==null?void 0:l.toLowerCase().includes(t))||((Q=(_=r.vendor)==null?void 0:_.businessName)==null?void 0:Q.toLowerCase().includes(t))||((U=(H=r.vendor)==null?void 0:H.businessAddress)==null?void 0:U.toLowerCase().includes(t))||((T=(K=r.vendor)==null?void 0:K.contactNumber)==null?void 0:T.toLowerCase().includes(t))||(($=r.carrier)==null?void 0:$.toLowerCase().includes(t))||r.orderDate&&new Date(r.orderDate).toLocaleDateString().includes(t)||r.receiveDate&&new Date(r.receiveDate).toLocaleDateString().includes(t)||((B=r.details)==null?void 0:B.some(q=>{var ce;return(ce=q.description)==null?void 0:ce.toLowerCase().includes(t)}))}catch(q){return console.error("Error filtering data:",q),!1}});b(o),S(1),g(o.length===0?"No results found":null)},[p]),I)return e.jsx(V,{color:"primary",className:"mt-5 w-15 mx-auto justify-content-center"});const f=x*E,d=f-E,D=m.slice(d,f),s=Math.ceil(m.length/E),u=t=>{P(t.target.value)};if(m.filter(t=>!t.received).length===0)return e.jsx(A,{color:"danger",className:"text-center mt-3 w-75 mx-auto",children:"No items to receive."});const i=({icon:t})=>{const[o,r]=n.useState(!1);return e.jsx(z,{icon:t,bounce:o,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mt-3",children:e.jsxs(Z,{className:"w-50 mb-3",children:[e.jsx(ee,{type:"text",placeholder:"Search by PO Number, Supplier, or Item Name",value:p,id:"searchInput",onChange:u}),e.jsx(se,{children:e.jsx(z,{icon:X})})]})}),e.jsxs(te,{hover:!0,responsive:!0,children:[e.jsx(re,{children:e.jsxs(M,{children:[e.jsx(v,{children:"PO Number"}),e.jsx(v,{children:"Order Date"}),e.jsx(v,{children:"Date to Receive"}),e.jsx(v,{children:"Carrier"}),e.jsx(v,{children:"Warehouse"}),e.jsx(v,{children:"Vendor"}),e.jsx(v,{children:"Products"}),e.jsx(v,{children:"Receive"}),e.jsx(v,{children:"Actions"})]})}),e.jsx(ae,{children:D.filter(t=>!t.received).map(t=>e.jsxs(M,{children:[e.jsx(N,{children:t.poNumber}),e.jsx(N,{children:new Date(t.orderDate).toLocaleDateString()}),e.jsx(N,{children:new Date(t.receiveDate).toLocaleDateString()}),e.jsx(N,{children:t.carrier}),e.jsx(N,{children:a(t.warehouse_id)}),e.jsxs(N,{children:[e.jsx("div",{children:t.vendor.businessName}),e.jsx("small",{className:"text-medium-emphasis",children:t.vendor.contactNumber})]}),e.jsx(N,{children:t.details.map(o=>e.jsxs("div",{children:[o.description," ( pcs: ",o.quantity," x"," ",o.unitPrice.toFixed(2)," )"]},o.productId))}),e.jsx(N,{children:t.received?"Yes":"No"}),e.jsx(N,{children:e.jsxs(ve,{color:"primary",className:"mt-2",onClick:()=>W(t._id),children:[e.jsx(i,{icon:xe})," Complete"]})})]},t._id))})]}),m.filter(t=>!t.received).length>0&&e.jsxs(O,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(O,{children:["Showing ",d+1," to ",Math.min(f,m.length)," of"," ",m.length," entries"]}),e.jsxs(ne,{className:"mt-3",children:[e.jsx(F,{disabled:x===1,onClick:()=>S(t=>Math.max(t-1,1)),children:"Previous"}),[...Array(s).keys()].map(t=>e.jsx(F,{active:t+1===x,onClick:()=>S(t+1),children:t+1},t+1)),e.jsx(F,{disabled:x===s,onClick:()=>S(t=>Math.min(t+1,s)),children:"Next"})]})]}),L&&e.jsx(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:L})]})},Se=({items:w,loading:y,error:k})=>{const[m,b]=n.useState([]),[x,S]=n.useState(""),[L,g]=n.useState(null),I=10,[C,p]=n.useState(1),P=a=>{switch(a){case"Stocked":return"success";case"Out of Stock":return"danger";default:return"secondary"}};n.useEffect(()=>{b(w)},[w]),n.useEffect(()=>{if(x==="")b(w),g(null);else{const a=w.filter(f=>{const d=f.itemName.toLowerCase().includes(x.toLowerCase()),D=f.locations.some(s=>{const u=s.warehouse;return u.warehouseName.toLowerCase().includes(x.toLowerCase())||u.address.toLowerCase().includes(x.toLowerCase())});return d||D});b(a),p(1),a.length===0?g("No results found"):g(null)}},[x,w]);const R=a=>{S(a.target.value)},h=a=>{if(!a||!Array.isArray(a))return[];const f=new Map;return a.forEach(d=>{if(!(d!=null&&d.warehouse))return;const D=d.warehouse._id||"deleted";if(!f.has(D))f.set(D,{warehouse:{...d.warehouse,deleted:d.warehouse.deleted||!d.warehouse._id},quantity:d.quantity||0});else{const s=f.get(D);s.quantity+=d.quantity||0,f.set(D,s)}}),Array.from(f.values())};if(y)return e.jsx(V,{color:"primary",className:"text-center mt-5 w-75 mx-auto justify-content-center"});if(k)return e.jsxs(A,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:["Error: ",k]});const c=C*I,j=c-I,E=m.slice(j,c),W=Math.ceil(m.length/I);return e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"m-3",children:e.jsxs(Z,{className:"w-50 mb-3",children:[e.jsx(ee,{type:"text",id:"search",value:x,onChange:R,placeholder:"Search by item name or warehouse..."}),e.jsx(se,{children:e.jsx(z,{icon:X})})]})}),e.jsxs("strong",{className:"m-3 align-self-start",children:["Total Items: ",E.length]}),L?e.jsx(A,{color:"warning",children:L}):e.jsxs(te,{hover:!0,responsive:!0,striped:!0,className:"text-center",children:[e.jsx(re,{children:e.jsxs(M,{children:[e.jsx(v,{scope:"col",children:"Item Name"}),e.jsx(v,{scope:"col",children:"Total Quantity"}),e.jsx(v,{scope:"col",children:"Warehouse Locations"}),e.jsx(v,{scope:"col",children:"Status"})]})}),e.jsx(ae,{children:E.map((a,f)=>e.jsxs(M,{children:[e.jsx(N,{children:a.itemName}),e.jsx(N,{children:e.jsx("strong",{children:a.quantity})}),e.jsx(N,{children:e.jsx(O,{className:"locations-list",children:h(a.locations).map((d,D)=>{const s=d.warehouse;return e.jsx(O,{className:"location-item",children:e.jsxs(O,{className:"location-details",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"warehouse-name",children:(s==null?void 0:s.warehouseName)||"Unknown Warehouse"}),e.jsx(oe,{color:s!=null&&s.deleted?"danger":"success",className:"ms-2",children:s!=null&&s.deleted?"Deleted":"Active"})]}),e.jsx("span",{className:"warehouse-address",children:(s==null?void 0:s.address)||"No address available"}),e.jsxs("span",{className:"quantity-badge",children:["Qty: ",d.quantity]})]})},(s==null?void 0:s._id)||`deleted-${D}`)})})}),e.jsx(N,{children:e.jsx(oe,{color:P(a.status||(a.quantity>0?"Stocked":"Out of Stock")),children:a.status||(a.quantity>0?"Stocked":"Out of Stock")})})]},a._id||f))})]}),m.length===0&&!L&&e.jsx(A,{color:"warning",className:"text-center mt-5 w-75 mx-auto",children:"No items found."}),e.jsxs(ne,{align:"center",children:[e.jsx(F,{disabled:C===1,onClick:()=>p(a=>Math.max(a-1,1)),children:"Previous"}),[...Array(W).keys()].map(a=>e.jsx(F,{active:a+1===C,onClick:()=>p(a+1),children:a+1},a+1)),e.jsx(F,{disabled:C===W,onClick:()=>p(a=>Math.min(a+1,W)),children:"Next"})]})]})},Ie=`
  .locations-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .location-item {
    display: flex;
    flex-direction: column;
    padding: 8px;
    background-color: #f8f9fa;
    border-radius: 4px;
    width: fit-content;

  }

  .location-details {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
  }

  .warehouse-name {
    font-weight: 500;
    color: #495057;
  }

  .warehouse-address {
    color: #6c757d;
    font-size: 0.9em;
    font-style: italic;
  }

  .quantity-badge {
    background-color: #e9ecef;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.85em;
    color: #495057;
  }

`,he=document.createElement("style");he.innerText=Ie;document.head.appendChild(he);const $e=()=>{const[w,y]=n.useState([]),[k,m]=n.useState([]),[b,x]=n.useState(!1),[S,L]=n.useState(null),[g,I]=n.useState(0);n.useEffect(()=>{(async()=>{x(!0);try{const c=await G.get("https://backend-log2.axleshift.com/api/v1/purchaseOrder");c.status===200&&y(c.data)}catch(c){L(c.message)}finally{x(!1)}})()},[g]);const C=()=>{I(h=>h+1)},p=h=>{y(c=>[...c,h]),m(c=>[...c,h]),C()},P=h=>{y(c=>c.filter(j=>j._id!==h)),m(c=>c.filter(j=>j._id!==h)),C()},R=h=>{y(c=>c.map(j=>j._id===h._id?h:j)),m(c=>c.map(j=>j._id===h._id?h:j)),C()};return e.jsx(e.Fragment,{children:e.jsxs(Ne,{activeItemKey:"Warehouse Items Details",children:[e.jsxs(we,{variant:"tabs",children:[e.jsx(Y,{itemKey:"Warehouse Items Details",children:"Warehouse Items Details"}),e.jsx(Y,{itemKey:"For Receiving",children:"For Receiving"}),e.jsx(Y,{itemKey:"Items",children:"Items"})]}),e.jsxs(Ce,{children:[e.jsx(J,{className:"p-3",itemKey:"Warehouse Items Details",children:e.jsx(ye,{warehousing:w,loading:b,error:S,onDeleteItem:P,onUpdateItem:R,onRefresh:C})}),e.jsx(J,{className:"p-3",itemKey:"For Receiving",children:e.jsxs(le,{children:[e.jsx(ie,{children:"Item Reiceving"}),e.jsx(be,{onAddItem:p})]})}),e.jsx(J,{className:"p-3",itemKey:"Items",children:e.jsxs(le,{children:[e.jsx(ie,{children:"Items"}),e.jsx(Se,{items:k,loading:b,error:S})]})})]})]})})};export{$e as default};
