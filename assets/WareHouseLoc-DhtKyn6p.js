import{r as s,_ as pe,a as L,R as W,c as xe,P as c,e as ge,y as Ce,j as e,C as T,w as D}from"./index-nNgQDi3y.js";import{F as H,d as je,e as ye,k as be,c as ve}from"./index-DA9UjPMh.js";import{C as A}from"./CButton-B31Ato4o.js";import{C as oe,a as re,b as ne,c as ie,d as le}from"./CModalTitle-DC27g7Q8.js";import{C as E}from"./CAlert-Da4UQtJl.js";import{C as ce}from"./CForm-C8WwGFvM.js";import{C as R}from"./CFormInput-C49UErcb.js";import{C as Ne}from"./CContainer-XXKGP3D5.js";import{C as Se,a as ke}from"./CInputGroupText-I3x9P6oS.js";import{C as we}from"./CCard-C11t10-G.js";import{u as Pe,a as Le,C as de}from"./DefaultLayout-C_MU3311.js";import{C as Te}from"./CCardBody-D9zCfA2H.js";import{C as We,a as Ae,b as Z,c as M,d as Ee,e as U}from"./CTable-DW5YpC_1.js";import{u as Ie}from"./CCloseButton-U_0zd53e.js";import{g as Fe,e as Re}from"./getRTLPlacement-B1O02hgC.js";import{C as Be,a as q}from"./CPaginationItem-NLfdk3wV.js";import"./CLink-B-ouRo4I.js";import"./index.esm-BuKqvEan.js";import"./cil-user-Ddrdy7PS.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";var F=s.forwardRef(function(a,j){var b=a.children,d=a.animation,g=d===void 0?!0:d,t=a.className,u=a.container,m=a.content,h=a.delay,i=h===void 0?0:h,n=a.fallbackPlacements,l=n===void 0?["top","right","bottom","left"]:n,o=a.offset,v=o===void 0?[0,6]:o,y=a.onHide,k=a.onShow,p=a.placement,w=p===void 0?"top":p,x=a.popperConfig,N=a.trigger,C=N===void 0?["hover","focus"]:N,f=a.visible,r=pe(a,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","popperConfig","trigger","visible"]),S=s.useRef(null),P=s.useRef(null),O=Ie(j,S),B="tooltip".concat(s.useId()),J=s.useState(!1),V=J[0],G=J[1],Q=s.useState(f),I=Q[0],K=Q[1],_=Pe(),ue=_.initPopper,me=_.destroyPopper,fe=_.updatePopper,X=typeof i=="number"?{show:i,hide:i}:i,Y={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:l}},{name:"offset",options:{offset:v}}],placement:Fe(w,P.current)},he=L(L({},Y),typeof x=="function"?x(Y):x);s.useEffect(function(){if(f){$();return}z()},[f]),s.useEffect(function(){if(V&&P.current&&S.current){ue(P.current,S.current,he),setTimeout(function(){K(!0)},X.show);return}!V&&P.current&&S.current&&me()},[V]),s.useEffect(function(){!I&&P.current&&S.current&&Re(function(){G(!1)},S.current)},[I]);var $=function(){G(!0),k&&k()},z=function(){setTimeout(function(){K(!1),y&&y()},X.hide)};return s.useEffect(function(){fe()},[m]),W.createElement(W.Fragment,null,W.cloneElement(b,L(L(L(L(L({},I&&{"aria-describedby":B}),{ref:P}),(C==="click"||C.includes("click"))&&{onClick:function(){return I?z():$()}}),(C==="focus"||C.includes("focus"))&&{onFocus:function(){return $()},onBlur:function(){return z()}}),(C==="hover"||C.includes("hover"))&&{onMouseEnter:function(){return $()},onMouseLeave:function(){return z()}})),W.createElement(Le,{container:u,portal:!0},V&&W.createElement("div",L({className:xe("tooltip","bs-tooltip-auto",{fade:g,show:I},t),id:B,ref:O,role:"tooltip"},r),W.createElement("div",{className:"tooltip-arrow"}),W.createElement("div",{className:"tooltip-inner"},m))))});F.propTypes={animation:c.bool,children:c.node,container:c.any,content:c.oneOfType([c.string,c.node]),delay:c.oneOfType([c.number,c.shape({show:c.number.isRequired,hide:c.number.isRequired})]),fallbackPlacements:Ce,offset:c.any,onHide:c.func,onShow:c.func,placement:c.oneOf(["auto","top","right","bottom","left"]),popperConfig:c.oneOfType([c.func,c.object]),trigger:ge,visible:c.bool};F.displayName="CTooltip";const ee=sessionStorage.getItem("accessToken"),Ve="http://localhost:5057",$e=D.create({baseURL:Ve,withCredentials:!0,headers:{"Content-Type":"application/json",...ee&&{Authorization:`Bearer ${ee}`}}}),ze=({onAddWarehouseLoc:a})=>{const[j,b]=s.useState(!1),[d,g]=s.useState(!1),[t,u]=s.useState(!1),[m,h]=s.useState(null),[i,n]=s.useState(null),l={warehouseName:"",address:""},[o,v]=s.useState(l),y=p=>{const{id:w,value:x}=p.target;v(N=>({...N,[w]:x}))},k=async p=>{const x=p.currentTarget.checkValidity();if(x||(p.preventDefault(),p.stopPropagation()),b(x),x){const C=JSON.parse(sessionStorage.getItem("user")).email;if(!C){h("User email not found. Please log in again.");return}u(!0);try{const f=await $e.post("/api/v1/warehouseLoc/add",{...o,createdBy:C});f.status===201&&(n(f.data.message),a(f.data.data),setTimeout(()=>{n(null),v(l),g(!1),u(!1),h(null)},2e3),v({warehouseName:"",address:""}))}catch(f){h(f.response.data.message),setTimeout(()=>{h(null)},2e3)}u(!1)}};return e.jsx(e.Fragment,{children:t?e.jsx(T,{color:"primary",size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{color:"primary",variant:"outline",disabled:t,onClick:()=>g(!0),children:[t?e.jsx(T,{color:"secondary",size:"sm"}):e.jsx(H,{icon:je})," ","Add Warehouse Location"]}),e.jsxs(oe,{visible:d,onClose:()=>g(!1),children:[e.jsx(re,{closeButton:!0,children:e.jsx(ne,{children:"Add Warehouse Location"})}),m&&e.jsx(E,{color:"danger",className:"m-3",children:m}),i&&e.jsx(E,{color:"success",className:"m-3",children:i}),e.jsx(ie,{children:e.jsxs(ce,{noValidate:!0,validated:j,children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:y,value:o.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name",feedbackValid:"Looks good!"}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:y,value:o.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address",feedbackValid:"Looks good!"})]})}),e.jsxs(le,{children:[e.jsx(A,{color:"secondary",variant:"outline",disabled:t,onClick:()=>{g(!1),v(l),g(!1),h(null),b(!1)},children:t?e.jsx(T,{color:"secondary",size:"sm"}):"Cancel"}),e.jsx(A,{color:"primary",variant:"outline",disabled:t,onClick:k,children:t?e.jsx(T,{color:"primary",size:"sm"}):"Add"})]})]})]})})},se=sessionStorage.getItem("accessToken"),Me="http://localhost:5057",Ue=D.create({baseURL:Me,withCredentials:!0,headers:{"Content-Type":"application/json",...se&&{Authorization:`Bearer ${se}`}}}),De=({warehouseLoc:a,onDeleteWarehouseLoc:j})=>{const[b,d]=s.useState(!1),[g,t]=s.useState(null),u=async()=>{d(!0);try{const m=await Ue.delete(`/api/v1/warehouseLoc/delete/${a._id}`);console.log(m.data),m.status===200&&(alert("Warehouse Location deleted successfully"),j(a._id),d(!1),t(null))}catch(m){t(m)}finally{d(!1)}};return g?e.jsxs(E,{color:"danger",className:"text-center mt-5 w-75 mx-auto",children:["Error: ",g.message]}):e.jsx(e.Fragment,{children:e.jsx(A,{color:"danger",disabled:b,variant:"outline",onClick:u,className:"me-2",children:b?e.jsx(T,{size:"sm"}):e.jsx(H,{icon:ye})})})},ae=sessionStorage.getItem("accessToken"),He="http://localhost:5057",Oe=D.create({baseURL:He,withCredentials:!0,headers:{"Content-Type":"application/json",...ae&&{Authorization:`Bearer ${ae}`}}}),_e=({warehouseLoc:a,onUpdateWarehouseLoc:j})=>{const[b,d]=s.useState(!1),[g,t]=s.useState(!1),[u,m]=s.useState(!1),[h,i]=s.useState(null),[n,l]=s.useState(null),[o,v]=s.useState({warehouseName:a.warehouseName,address:a.address}),y=p=>{const{id:w,value:x}=p.target;v(N=>({...N,[w]:x}))},k=async p=>{const x=p.currentTarget.checkValidity();x||(p.preventDefault(),p.stopPropagation()),t(x);const C=JSON.parse(sessionStorage.getItem("user")).email;if(!C){i("User email not found. Please log in again.");return}m(!0);try{const f=await Oe.put(`/api/v1/warehouseLoc/update/${a._id}`,{...o,createdBy:C});f.status===200&&(l("Warehouse Location updated successfully"),j(f.data.data),setTimeout(()=>{l(null),d(!1),i(null),t(!1)},2e3))}catch(f){i(f.response.data.message),setTimeout(()=>{i(null)},2e3)}m(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(A,{color:"primary",variant:"outline",disabled:u,onClick:()=>d(!0),className:"me-2",children:u?e.jsx(T,{size:"sm"}):e.jsx(H,{icon:be})}),e.jsxs(oe,{visible:b,onClose:()=>d(!1),children:[e.jsx(re,{closeButton:!0,children:e.jsx(ne,{children:"Update Warehouse Location"})}),h&&e.jsx(E,{color:"danger",className:"m-3",children:h}),n&&e.jsx(E,{color:"success",className:"m-3",children:n}),e.jsx(ie,{children:e.jsxs(ce,{noValidate:!0,validated:g,children:[e.jsx(R,{type:"text",id:"warehouseName",className:"mb-3",placeholder:"Warehouse Name",floatingLabel:"Warehouse Name",onChange:y,value:o.warehouseName,autoComplete:"off",required:!0,feedbackInvalid:"Please enter a warehouse name.",feedbackValid:"Looks good!"}),e.jsx(R,{type:"text",id:"address",className:"mb-3",placeholder:"Address",floatingLabel:"Address",onChange:y,value:o.address,autoComplete:"off",required:!0,feedbackInvalid:"Please enter an address.",feedbackValid:"Looks good!"})]})}),e.jsxs(le,{children:[e.jsx(A,{color:"secondary",variant:"outline",disabled:u,onClick:()=>{d(!1),i(null),t(!1)},children:u?e.jsx(T,{size:"sm",color:"secondary"}):"Cancel"}),e.jsx(A,{color:"primary",variant:"outline",disabled:u,onClick:k,children:u?e.jsx(T,{size:"sm",color:"success"}):"Update"})]})]})]})},qe=({warehouseLoc:a,loading:j,error:b,onDeleteWarehouseLoc:d,onUpdateWarehouseLoc:g})=>{const[t,u]=s.useState(""),[m,h]=s.useState([]),[i,n]=s.useState(1),[l,o]=s.useState(null),v=10,y=JSON.parse(sessionStorage.getItem("user")),k=["manager","admin"],p="admin";if(s.useEffect(()=>{h(a)},[a]),s.useEffect(()=>{if(t==="")h(a);else{const r=a.filter(S=>{const P=S.warehouseName.toLowerCase().includes(t.toLowerCase()),O=S.address.toLowerCase().includes(t.toLowerCase()),B=k.includes(y.role)&&S.createdBy.toLowerCase().includes(t.toLowerCase());return P||O||B});h(r),n(1),r.length===0?o("No results found"):o(null)}},[t,a]),a.length===0)return e.jsx(E,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:"No Warehouse Location Found"});const w=r=>{u(r.target.value)},x=i*v,N=x-v,C=m.slice(N,x),f=Math.ceil(m.length/v);return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"m-3",children:e.jsxs(Se,{className:"w-50 mb-3",children:[e.jsx(R,{type:"text",id:"search",value:t,onChange:w,placeholder:"Search Warehouse Location..."}),e.jsx(ke,{children:e.jsx(H,{icon:ve})})]})}),e.jsxs(we,{children:[e.jsx(de,{children:"Warehouse Location List"}),e.jsxs(Te,{className:"md-3",children:[e.jsxs(We,{bordered:!0,hover:!0,responsive:!0,className:"mx-auto ",children:[e.jsx(Ae,{className:"text-center  ",children:e.jsxs(Z,{children:[e.jsx(M,{className:"fixed-width bg-secondary",children:"Warehouse Name"}),e.jsx(M,{className:"fixed-width bg-secondary",children:"Address"}),p.includes(y.role)&&e.jsx(M,{className:"fixed-width bg-secondary",children:"Created By"}),e.jsx(M,{className:"fixed-width bg-secondary",children:"Actions"})]})}),e.jsx(Ee,{className:"text-center",children:C.map(r=>e.jsxs(Z,{children:[e.jsx(U,{className:"fixed-width",children:e.jsx(F,{content:r.warehouseName,children:e.jsx("span",{children:r.warehouseName})})}),e.jsx(U,{className:"fixed-width",children:e.jsx(F,{content:r.address,children:e.jsx("span",{children:r.address})})}),p.includes(y.role)&&e.jsx(U,{className:"fixed-width",color:"danger",children:e.jsx(F,{content:r.createdBy,children:e.jsx("span",{children:r.createdBy})})}),e.jsxs(U,{className:"fixed-width",children:[e.jsx(_e,{warehouseLoc:r,onUpdateWarehouseLoc:g}),k.includes(y.role)&&e.jsx(De,{warehouseLoc:r,onDeleteWarehouseLoc:d})]})]},r._id))})]}),l&&e.jsx(E,{color:"danger",className:"text-center mt-5 w-75 mx-auto justify-content-center",children:l}),e.jsxs(Be,{align:"center",children:[e.jsx(q,{disabled:i===1,onClick:()=>n(r=>Math.max(r-1,1)),children:"Previous"}),[...Array(f).keys()].map(r=>e.jsx(q,{active:r+1===i,onClick:()=>n(r+1),children:r+1},r+1)),e.jsx(q,{disabled:i===f,onClick:()=>n(r=>Math.min(r+1,f)),children:"Next"})]})]})]})]})},te=sessionStorage.getItem("accessToken"),Je="http://localhost:5057",Ge=D.create({baseURL:Je,withCredentials:!0,headers:{"Content-Type":"application/json",...te&&{Authorization:`Bearer ${te}`}}}),ps=()=>{const[a,j]=s.useState([]),[b,d]=s.useState(!1),[g,t]=s.useState(null),u=async()=>{var n,l;d(!0);try{const o=await Ge.get("/api/v1/warehouseLoc/locations");o.status===200?j(o.data.data):t(o.data.message)}catch(o){t(((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||o.message)}finally{d(!1)}};s.useEffect(()=>{u()},[]);const m=n=>{j(l=>[...l,n])},h=n=>{j(l=>l.filter(o=>o._id!==n))},i=n=>{j(l=>l.map(o=>o._id===n._id?n:o))};return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:"Warehouse location"}),e.jsx(ze,{onAddWarehouseLoc:m}),e.jsx(qe,{warehouseLoc:a,loading:b,error:g,onDeleteWarehouseLoc:h,onUpdateWarehouseLoc:i})]})};export{ps as default};
