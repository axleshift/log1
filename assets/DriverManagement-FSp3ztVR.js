import{r as n,j as e}from"./index-BbgKQuKZ.js";import{a as H}from"./axios-CCb-kr4I.js";import{C as w,b as E,c as A,d as I,e as S,F as C,g as V,h as Q,i as $,j as N,k as c,l as o,m as J,f as O,a as z}from"./index-c6XHozSD.js";import{C as K}from"./index.esm-DWz8-w3P.js";import{a as m}from"./CButton-G5hwgdzM.js";import{C as B}from"./CAlert-Bia4igJC.js";import{C as M}from"./CForm-BvnJlYTb.js";import{b as l,C as W,a as X}from"./CInputGroupText-C3O-XfYr.js";import"./CCloseButton-D5oIMQLk.js";import"./DefaultLayout-KSssRpzt.js";import"./cil-user-Ddrdy7PS.js";const me=()=>{const p=H.create({baseURL:"http://localhost:5057"}),T=JSON.parse(sessionStorage.getItem("user")),k=["manager","admin"],[y,x]=n.useState(!1),[P,g]=n.useState(!1),[r,t]=n.useState(null),[b,f]=n.useState([]),[j,q]=n.useState(""),D=Math.floor(Math.random()*1e10).toString(),[v,L]=n.useState(),[s,d]=n.useState({idNum:D,driverName:"",email:"",phone:"",address:"",licenseNumber:""});n.useEffect(()=>{h()},[]);const h=async()=>{const a=await p.get("/api/v1/driver");f(a.data.data)},R=async()=>{try{const a={idNum:D,driverName:s.driverName,email:s.email,phone:s.phone,address:s.address,licenseNumber:s.licenseNumber};d({...s,driverName:"",email:"",phone:"",address:"",licenseNumber:""}),await p.post("/api/v1/driver",a),h(),x(!1)}catch(a){console.error("Error adding driver:",a),L(a.response.data.message)}},F=async a=>{await p.delete(`/api/v1/driver/${a}`),h()},U=a=>{t(a),g(!0)},_=async()=>{if(!r)return;const a={idNum:r.idNum,driverName:r.driverName,email:r.email,phone:r.phone,address:r.address,licenseNumber:r.licenseNumber};try{await p.put(`/api/v1/driver/${r._id}`,a),h(),g(!1),t(null)}catch(i){console.error("Error updating driver:",i),L(i.response.data.message)}},G=()=>{if(j.trim()==="")h();else{const a=b.filter(i=>j.toLowerCase().split(" ").every(u=>i.driverName.toLowerCase().includes(u)||i.licenseNumber.toLowerCase().includes(u)||i.email.toLowerCase().includes(u)||i.phone.toLowerCase().includes(u)||i.address.toLowerCase().includes(u)||i.idNum.toLowerCase().includes(u)));f(a)}};return e.jsxs(K,{fluid:!0,className:"p-3",style:{height:"100vh",textAlign:"center"},children:[e.jsx("h1",{style:{textAlign:"center",margin:"10px"},children:"Driver Management"}),e.jsx(m,{color:"primary",style:{margin:"10px",display:"block",float:"left",width:"100px"},onClick:()=>x(!y),children:"Add"}),e.jsxs(w,{visible:y,onClose:()=>x(!1),"aria-labelledby":"LiveDemoExample",children:[e.jsx(E,{id:"LiveDemoExampleLabel",children:e.jsx(A,{children:"Add Driver"})}),v&&e.jsx(B,{color:"danger",children:v}),e.jsx(I,{children:e.jsxs(M,{children:[e.jsx(l,{floatingLabel:"Driver ID",type:"text",label:"Driver ID",placeholder:"Driver ID",name:"Driver ID",required:!0,style:{width:"100%",marginBottom:"10px"},disabled:!0,value:s.idNum,onChange:a=>d({...s,idNum:a.target.value})}),e.jsx(l,{floatingLabel:"Name",type:"text",label:"Name",placeholder:"Name",name:"name",required:!0,style:{width:"100%",marginBottom:"10px"},value:s.driverName,onChange:a=>d({...s,driverName:a.target.value})}),e.jsx(l,{floatingLabel:"Email",type:"email",label:"Email",placeholder:"Email",name:"email",required:!0,style:{width:"100%",marginBottom:"10px"},value:s.email,onChange:a=>d({...s,email:a.target.value})}),e.jsx(l,{floatingLabel:"Phone",type:"number",label:"Phone",placeholder:"Phone",name:"phone",required:!0,style:{width:"100%",marginBottom:"10px"},value:s.phone,onChange:a=>d({...s,phone:a.target.value})}),e.jsx(l,{floatingLabel:"Address",type:"text",label:"Address",placeholder:"Address",name:"address",required:!0,style:{width:"100%",marginBottom:"10px"},value:s.address,onChange:a=>d({...s,address:a.target.value})}),e.jsx(l,{floatingLabel:"License Number",type:"text",label:"License Number",placeholder:"License Number",name:"licenseNumber",required:!0,style:{width:"100%",marginBottom:"10px"},value:s.licenseNumber,onChange:a=>d({...s,licenseNumber:a.target.value})})]})}),e.jsxs(S,{children:[e.jsx(m,{color:"secondary",onClick:()=>x(!1),children:"Close"}),e.jsx(m,{color:"primary",onClick:R,children:"Save changes"})]})]}),e.jsxs(W,{className:"mb-3",style:{width:"50%",margin:"10px",float:"right"},children:[e.jsx(X,{children:e.jsx(C,{icon:V})}),e.jsx(l,{type:"search",value:j,onChange:a=>{q(a.target.value),a.target.value.trim()===""?h():G()},placeholder:"Search drivers..."})]}),e.jsxs(Q,{children:[e.jsx($,{children:e.jsxs(N,{children:[e.jsx(c,{children:"ID"}),e.jsx(c,{children:"Driver's name"}),e.jsx(c,{children:"Email"}),e.jsx(c,{children:"Phone"}),e.jsx(c,{children:"Address"}),e.jsx(c,{children:"License Number"}),e.jsx(c,{children:"Actions"})]})}),b.length===0?e.jsx(N,{children:e.jsx(o,{colSpan:"7",style:{textAlign:"center"},children:"No drivers found"})}):e.jsx(J,{children:b.map((a,i)=>e.jsxs(N,{children:[e.jsx(o,{children:a.idNum}),e.jsx(o,{children:a.driverName}),e.jsx(o,{children:a.email}),e.jsx(o,{children:a.phone}),e.jsx(o,{children:a.address}),e.jsx(o,{children:a.licenseNumber}),e.jsxs(o,{children:[e.jsx(m,{color:"info",style:{marginRight:"10px"},onClick:()=>U(a),children:e.jsx(C,{icon:O})}),k.includes(T.data.user.role)&&e.jsx(m,{color:"danger",onClick:()=>F(a._id),children:e.jsx(C,{icon:z})})]})]},i))})]}),e.jsxs(w,{visible:P,onClose:()=>g(!1),"aria-labelledby":"EditDriverModal",children:[e.jsx(E,{id:"EditDriverModalLabel",children:e.jsx(A,{children:"Edit Driver"})}),v&&e.jsx(B,{color:"danger",children:v}),e.jsx(I,{children:r&&e.jsxs(M,{children:[e.jsx(l,{floatingLabel:"Driver ID",type:"text",label:"Driver ID",placeholder:"Driver ID",name:"Driver ID",style:{width:"100%",marginBottom:"10px"},value:r.idNum,onChange:a=>t({...r,idNum:a.target.value})}),e.jsx(l,{floatingLabel:"Name",type:"text",label:"Name",placeholder:"Name",name:"name",style:{width:"100%",marginBottom:"10px"},value:r.driverName,onChange:a=>t({...r,driverName:a.target.value})}),e.jsx(l,{floatingLabel:"Email",type:"email",label:"Email",placeholder:"Email",name:"email",style:{width:"100%",marginBottom:"10px"},value:r.email,onChange:a=>t({...r,email:a.target.value})}),e.jsx(l,{floatingLabel:"Phone",type:"number",label:"Phone",placeholder:"Phone",name:"phone",style:{width:"100%",marginBottom:"10px"},value:r.phone,onChange:a=>t({...r,phone:a.target.value})}),e.jsx(l,{floatingLabel:"Address",type:"text",label:"Address",placeholder:"Address",name:"address",style:{width:"100%",marginBottom:"10px"},value:r.address,onChange:a=>t({...r,address:a.target.value})}),e.jsx(l,{floatingLabel:"License Number",type:"text",label:"License Number",placeholder:"License Number",name:"licenseNumber",style:{width:"100%",marginBottom:"10px"},value:r.licenseNumber,onChange:a=>t({...r,licenseNumber:a.target.value})})]})}),e.jsxs(S,{children:[e.jsx(m,{color:"secondary",onClick:()=>g(!1),children:"Close"}),e.jsx(m,{color:"primary",onClick:()=>_(),children:"Save changes"})]})]})]})};export{me as default};
