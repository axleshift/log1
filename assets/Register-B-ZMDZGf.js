import{m as P,r as t,j as e,k as I,n as L}from"./index-BiQ1qsdL.js";import{C as x}from"./index.esm-DbwI1Yd7.js";import{C as M}from"./CContainer-B94a0FPH.js";import{a as q,C as A}from"./CRow-CG4Zw61g.js";import{C as B}from"./CCard-T2eKHprU.js";import{C as E}from"./CCardBody-CQ-KVIL-.js";import{C as T}from"./CForm-O2wUx2bI.js";import{C as b}from"./CAlert-CmQM0F7S.js";import{C as n}from"./CInputGroup-CztM9D2T.js";import{C as i}from"./CInputGroupText-DCFIsjMx.js";import{c as U}from"./cil-user-Ddrdy7PS.js";import{C as u}from"./CFormInput-DqrdkPvR.js";import{c as N}from"./cil-lock-locked-DmxpJbVL.js";import{C as D}from"./CFormSelect-i2scNyUR.js";import{a as S}from"./CButton-_fpnnYam.js";const re=()=>{const j=P(),[a,y]=t.useState({username:"",email:"",password:"",repeatPassword:"",role:"",photo:null}),[C,l]=t.useState(null),[f,g]=t.useState(null),[r,p]=t.useState(!1),[G,z]=t.useState(null),o=h=>{const{id:c,value:d}=h.target;y(m=>({...m,[c]:d}))},k=async h=>{var c,d,m,v,w;h.preventDefault(),p(!0),l(null);try{if(a.password!==a.repeatPassword){l("Passwords do not match"),p(!1);return}const s=await L.post("api/v1/user/register",a);s.data&&s.data.success?(g("Registration successful"),s.data.token&&sessionStorage.setItem("accessToken",s.data.token),setTimeout(()=>{g(null),j("/dashboard")},2e3)):l(((c=s.data)==null?void 0:c.message)||"Registration failed")}catch(s){console.error("Full error details:",{message:s.message,response:(d=s.response)==null?void 0:d.data,status:(m=s.response)==null?void 0:m.status});const F=((w=(v=s.response)==null?void 0:v.data)==null?void 0:w.message)||s.message||"An error occurred during registration";l(F)}finally{p(!1)}},R=()=>{j("/dashboard")};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(M,{children:e.jsx(q,{className:"justify-content-center",children:e.jsx(A,{md:9,lg:7,xl:6,children:e.jsx(B,{className:"mx-4",children:e.jsx(E,{className:"p-4",children:e.jsxs(T,{onSubmit:k,children:[e.jsx("h1",{children:"Register New User"}),C&&e.jsx(b,{color:"danger",className:"text-center w-75 mx-auto",children:C}),f&&e.jsx(b,{color:"success",className:"text-center w-75 mx-auto",children:f}),e.jsxs(n,{className:"mb-3",children:[e.jsx(i,{children:e.jsx(x,{icon:U})}),e.jsx(u,{placeholder:"Username",autoComplete:"off",id:"username",value:a.username,onChange:o,required:!0,disabled:r})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(i,{children:"@"}),e.jsx(u,{placeholder:"Email",autoComplete:"off",id:"email",value:a.email,onChange:o,required:!0,type:"email",disabled:r})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(i,{children:e.jsx(x,{icon:N})}),e.jsx(u,{type:"password",placeholder:"Password",autoComplete:"off",id:"password",value:a.password,onChange:o,required:!0,disabled:r})]}),e.jsxs(n,{className:"mb-4",children:[e.jsx(i,{children:e.jsx(x,{icon:N})}),e.jsx(u,{type:"password",placeholder:"Repeat password",autoComplete:"off",id:"repeatPassword",value:a.repeatPassword,onChange:o,required:!0,disabled:r})]}),e.jsxs(n,{className:"mb-3",children:[e.jsx(i,{children:"Role"}),e.jsxs(D,{id:"role",value:a.role,onChange:o,disabled:r,children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"super admin",children:"Super Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"fuel manager",children:"Fuel Manager"}),e.jsx("option",{value:"fleet coordinator",children:"Fleet Coordinator"}),e.jsx("option",{value:"chief mechanic",children:"Chief Mechanic"}),e.jsx("option",{value:"maintenance supervisor",children:"Maintenance Supervisor"}),e.jsx("option",{value:"dispatcher",children:"Dispatcher"}),e.jsx("option",{value:"receiving clerk",children:"Receiving Clerk"})]})]}),e.jsx(S,{color:"success",type:"submit",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"sm"})," Loading..."]}):"Create"}),e.jsx(S,{color:"secondary",className:"ms-2",onClick:R,disabled:r,children:"Back"})]})})})})})})})};export{re as default};
